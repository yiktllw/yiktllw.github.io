var Ai=Object.defineProperty;var Ii=(S,e,t)=>e in S?Ai(S,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):S[e]=t;var d=(S,e,t)=>Ii(S,typeof e!="symbol"?e+"":e,t);import{d as ki,r as Ei,n as Ti,c as Mi,o as Ri,_ as Fi}from"./index-BrOtrpkU.js";import"https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs";class Ls{constructor(){d(this,"entries",{});d(this,"size",0)}add(e){let t=this.entries[e];return this.entries[e]=!0,t?!1:(this.size++,!0)}addAll(e){let t=this.size;for(var s=0,i=e.length;s<i;s++)this.add(e[s]);return t!=this.size}contains(e){return this.entries[e]}clear(){this.entries={},this.size=0}}const Fe=class Fe{constructor(e=0,t=0,s=0,i=0){d(this,"r");d(this,"g");d(this,"b");d(this,"a");this.r=e,this.g=t,this.b=s,this.a=i}set(e,t,s,i){return this.r=e,this.g=t,this.b=s,this.a=i,this.clamp()}setFromColor(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}setFromString(e){return e=e.charAt(0)=="#"?e.substr(1):e,this.r=parseInt(e.substr(0,2),16)/255,this.g=parseInt(e.substr(2,2),16)/255,this.b=parseInt(e.substr(4,2),16)/255,this.a=e.length!=8?1:parseInt(e.substr(6,2),16)/255,this}add(e,t,s,i){return this.r+=e,this.g+=t,this.b+=s,this.a+=i,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(e,t){e.r=((t&4278190080)>>>24)/255,e.g=((t&16711680)>>>16)/255,e.b=((t&65280)>>>8)/255,e.a=(t&255)/255}static rgb888ToColor(e,t){e.r=((t&16711680)>>>16)/255,e.g=((t&65280)>>>8)/255,e.b=(t&255)/255}static fromString(e){return new Fe().setFromString(e)}};d(Fe,"WHITE",new Fe(1,1,1,1)),d(Fe,"RED",new Fe(1,0,0,1)),d(Fe,"GREEN",new Fe(0,1,0,1)),d(Fe,"BLUE",new Fe(0,0,1,1)),d(Fe,"MAGENTA",new Fe(1,0,1,1));let N=Fe;const be=class be{static clamp(e,t,s){return e<t?t:e>s?s:e}static cosDeg(e){return Math.cos(e*be.degRad)}static sinDeg(e){return Math.sin(e*be.degRad)}static atan2Deg(e,t){return Math.atan2(e,t)*be.degRad}static signum(e){return e>0?1:e<0?-1:0}static toInt(e){return e>0?Math.floor(e):Math.ceil(e)}static cbrt(e){let t=Math.pow(Math.abs(e),.3333333333333333);return e<0?-t:t}static randomTriangular(e,t){return be.randomTriangularWith(e,t,(e+t)*.5)}static randomTriangularWith(e,t,s){let i=Math.random(),n=t-e;return i<=(s-e)/n?e+Math.sqrt(i*n*(s-e)):t-Math.sqrt((1-i)*n*(t-s))}static isPowerOfTwo(e){return e&&(e&e-1)===0}};d(be,"PI",3.1415927),d(be,"PI2",be.PI*2),d(be,"invPI2",1/be.PI2),d(be,"radiansToDegrees",180/be.PI),d(be,"radDeg",be.radiansToDegrees),d(be,"degreesToRadians",be.PI/180),d(be,"degRad",be.degreesToRadians);let V=be;const _e=class _e{static arrayCopy(e,t,s,i,n){for(let o=t,r=i;o<t+n;o++,r++)s[r]=e[o]}static arrayFill(e,t,s,i){for(let n=t;n<s;n++)e[n]=i}static setArraySize(e,t,s=0){let i=e.length;if(i==t)return e;if(e.length=t,i<t)for(let n=i;n<t;n++)e[n]=s;return e}static ensureArrayCapacity(e,t,s=0){return e.length>=t?e:_e.setArraySize(e,t,s)}static newArray(e,t){let s=new Array(e);for(let i=0;i<e;i++)s[i]=t;return s}static newFloatArray(e){if(_e.SUPPORTS_TYPED_ARRAYS)return new Float32Array(e);{let t=new Array(e);for(let s=0;s<t.length;s++)t[s]=0;return t}}static newShortArray(e){if(_e.SUPPORTS_TYPED_ARRAYS)return new Int16Array(e);{let t=new Array(e);for(let s=0;s<t.length;s++)t[s]=0;return t}}static toFloatArray(e){return _e.SUPPORTS_TYPED_ARRAYS?new Float32Array(e):e}static toSinglePrecision(e){return _e.SUPPORTS_TYPED_ARRAYS?Math.fround(e):e}static webkit602BugfixHelper(e,t){}static contains(e,t,s=!0){for(var i=0;i<e.length;i++)if(e[i]==t)return!0;return!1}static enumValue(e,t){return e[t[0].toUpperCase()+t.slice(1)]}};d(_e,"SUPPORTS_TYPED_ARRAYS",typeof Float32Array<"u");let O=_e;class Lt{constructor(e){d(this,"items",new Array);d(this,"instantiator");this.instantiator=e}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(e){e.reset&&e.reset(),this.items.push(e)}freeAll(e){for(let t=0;t<e.length;t++)this.free(e[t])}clear(){this.items.length=0}}class qe{constructor(e=0,t=0){d(this,"x");d(this,"y");this.x=e,this.y=t}set(e,t){return this.x=e,this.y=t,this}length(){let e=this.x,t=this.y;return Math.sqrt(e*e+t*t)}normalize(){let e=this.length();return e!=0&&(this.x/=e,this.y/=e),this}}class Xs{constructor(){d(this,"maxDelta",.064);d(this,"framesPerSecond",0);d(this,"delta",0);d(this,"totalTime",0);d(this,"lastTime",Date.now()/1e3);d(this,"frameCount",0);d(this,"frameTime",0)}update(){let e=Date.now()/1e3;this.delta=e-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=e,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)}}class Bs{constructor(e){d(this,"name");if(!e)throw new Error("name cannot be null.");this.name=e}}const Dt=class Dt extends Bs{constructor(t){super(t);d(this,"id",Dt.nextID++);d(this,"bones",null);d(this,"vertices",[]);d(this,"worldVerticesLength",0);d(this,"timelineAttachment",this)}computeWorldVertices(t,s,i,n,o,r){i=o+(i>>1)*r;let c=t.bone.skeleton,a=t.deform,l=this.vertices,h=this.bones;if(!h){a.length>0&&(l=a);let g=t.bone,p=g.worldX,x=g.worldY,y=g.a,b=g.b,w=g.c,C=g.d;for(let v=s,A=o;A<i;v+=2,A+=r){let I=l[v],E=l[v+1];n[A]=I*y+E*b+p,n[A+1]=I*w+E*C+x}return}let u=0,f=0;for(let g=0;g<s;g+=2){let p=h[u];u+=p+1,f+=p}let m=c.bones;if(a.length==0)for(let g=o,p=f*3;g<i;g+=r){let x=0,y=0,b=h[u++];for(b+=u;u<b;u++,p+=3){let w=m[h[u]],C=l[p],v=l[p+1],A=l[p+2];x+=(C*w.a+v*w.b+w.worldX)*A,y+=(C*w.c+v*w.d+w.worldY)*A}n[g]=x,n[g+1]=y}else{let g=a;for(let p=o,x=f*3,y=f<<1;p<i;p+=r){let b=0,w=0,C=h[u++];for(C+=u;u<C;u++,x+=3,y+=2){let v=m[h[u]],A=l[x]+g[y],I=l[x+1]+g[y+1],E=l[x+2];b+=(A*v.a+I*v.b+v.worldX)*E,w+=(A*v.c+I*v.d+v.worldY)*E}n[p]=b,n[p+1]=w}}}copyTo(t){this.bones?(t.bones=new Array(this.bones.length),O.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,this.vertices&&(t.vertices=O.newFloatArray(this.vertices.length),O.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)),t.worldVerticesLength=this.worldVerticesLength,t.timelineAttachment=this.timelineAttachment}};d(Dt,"nextID",0);let De=Dt;const ut=class ut{constructor(e){d(this,"id",ut.nextID());d(this,"regions");d(this,"start",0);d(this,"digits",0);d(this,"setupIndex",0);this.regions=new Array(e)}copy(){let e=new ut(this.regions.length);return O.arrayCopy(this.regions,0,e.regions,0,this.regions.length),e.start=this.start,e.digits=this.digits,e.setupIndex=this.setupIndex,e}apply(e,t){let s=e.sequenceIndex;s==-1&&(s=this.setupIndex),s>=this.regions.length&&(s=this.regions.length-1);let i=this.regions[s];t.region!=i&&(t.region=i,t.updateRegion())}getPath(e,t){let s=e,i=(this.start+t).toString();for(let n=this.digits-i.length;n>0;n--)s+="0";return s+=i,s}static nextID(){return ut._nextID++}};d(ut,"_nextID",0);let Xt=ut;var Ce;(function(S){S[S.hold=0]="hold",S[S.once=1]="once",S[S.loop=2]="loop",S[S.pingpong=3]="pingpong",S[S.onceReverse=4]="onceReverse",S[S.loopReverse=5]="loopReverse",S[S.pingpongReverse=6]="pingpongReverse"})(Ce||(Ce={}));const Ps=[Ce.hold,Ce.once,Ce.loop,Ce.pingpong,Ce.onceReverse,Ce.loopReverse,Ce.pingpongReverse];class cs{constructor(e,t,s){d(this,"name");d(this,"timelines",[]);d(this,"timelineIds",new Ls);d(this,"duration");if(!e)throw new Error("name cannot be null.");this.name=e,this.setTimelines(t),this.duration=s}setTimelines(e){if(!e)throw new Error("timelines cannot be null.");this.timelines=e,this.timelineIds.clear();for(var t=0;t<e.length;t++)this.timelineIds.addAll(e[t].getPropertyIds())}hasTimeline(e){for(let t=0;t<e.length;t++)if(this.timelineIds.contains(e[t]))return!0;return!1}apply(e,t,s,i,n,o,r,c){if(!e)throw new Error("skeleton cannot be null.");i&&this.duration!=0&&(s%=this.duration,t>0&&(t%=this.duration));let a=this.timelines;for(let l=0,h=a.length;l<h;l++)a[l].apply(e,t,s,n,o,r,c)}}var X;(function(S){S[S.setup=0]="setup",S[S.first=1]="first",S[S.replace=2]="replace",S[S.add=3]="add"})(X||(X={}));var Ee;(function(S){S[S.mixIn=0]="mixIn",S[S.mixOut=1]="mixOut"})(Ee||(Ee={}));const ae={rotate:0,x:1,y:2,scaleX:3,scaleY:4,shearX:5,shearY:6,inherit:7,rgb:8,alpha:9,rgb2:10,attachment:11,deform:12,event:13,drawOrder:14,ikConstraint:15,transformConstraint:16,pathConstraintPosition:17,pathConstraintSpacing:18,pathConstraintMix:19,physicsConstraintInertia:20,physicsConstraintStrength:21,physicsConstraintDamping:22,physicsConstraintMass:23,physicsConstraintWind:24,physicsConstraintGravity:25,physicsConstraintMix:26,physicsConstraintReset:27,sequence:28};class pe{constructor(e,t){d(this,"propertyIds");d(this,"frames");this.propertyIds=t,this.frames=O.newFloatArray(e*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(e,t){let s=e.length;for(let i=1;i<s;i++)if(e[i]>t)return i-1;return s-1}static search(e,t,s){let i=e.length;for(let n=s;n<i;n+=s)if(e[n]>t)return n-s;return i-s}}class He extends pe{constructor(t,s,i){super(t,i);d(this,"curves");this.curves=O.newFloatArray(t+s*18),this.curves[t-1]=1}setLinear(t){this.curves[t]=0}setStepped(t){this.curves[t]=1}shrink(t){let s=this.getFrameCount()+t*18;if(this.curves.length>s){let i=O.newFloatArray(s);O.arrayCopy(this.curves,0,i,0,s),this.curves=i}}setBezier(t,s,i,n,o,r,c,a,l,h,u){let f=this.curves,m=this.getFrameCount()+t*18;i==0&&(f[s]=2+m);let g=(n-r*2+a)*.03,p=(o-c*2+l)*.03,x=((r-a)*3-n+h)*.006,y=((c-l)*3-o+u)*.006,b=g*2+x,w=p*2+y,C=(r-n)*.3+g+x*.16666667,v=(c-o)*.3+p+y*.16666667,A=n+C,I=o+v;for(let E=m+18;m<E;m+=2)f[m]=A,f[m+1]=I,C+=b,v+=w,b+=x,w+=y,A+=C,I+=v}getBezierValue(t,s,i,n){let o=this.curves;if(o[n]>t){let l=this.frames[s],h=this.frames[s+i];return h+(t-l)/(o[n]-l)*(o[n+1]-h)}let r=n+18;for(n+=2;n<r;n+=2)if(o[n]>=t){let l=o[n-2],h=o[n-1];return h+(t-l)/(o[n]-l)*(o[n+1]-h)}s+=this.getFrameEntries();let c=o[r-2],a=o[r-1];return a+(t-c)/(this.frames[s]-c)*(this.frames[s+i]-a)}}class Ue extends He{constructor(e,t,s){super(e,t,[s])}getFrameEntries(){return 2}setFrame(e,t,s){e<<=1,this.frames[e]=t,this.frames[e+1]=s}getCurveValue(e){let t=this.frames,s=t.length-2;for(let n=2;n<=s;n+=2)if(t[n]>e){s=n-2;break}let i=this.curves[s>>1];switch(i){case 0:let n=t[s],o=t[s+1];return o+(e-n)/(t[s+2]-n)*(t[s+2+1]-o);case 1:return t[s+1]}return this.getBezierValue(e,s,1,i-2)}getRelativeValue(e,t,s,i,n){if(e<this.frames[0]){switch(s){case X.setup:return n;case X.first:return i+(n-i)*t}return i}let o=this.getCurveValue(e);switch(s){case X.setup:return n+o*t;case X.first:case X.replace:o+=n-i}return i+o*t}getAbsoluteValue(e,t,s,i,n){if(e<this.frames[0]){switch(s){case X.setup:return n;case X.first:return i+(n-i)*t}return i}let o=this.getCurveValue(e);return s==X.setup?n+(o-n)*t:i+(o-i)*t}getAbsoluteValue2(e,t,s,i,n,o){if(e<this.frames[0]){switch(s){case X.setup:return n;case X.first:return i+(n-i)*t}return i}return s==X.setup?n+(o-n)*t:i+(o-i)*t}getScaleValue(e,t,s,i,n,o){const r=this.frames;if(e<r[0]){switch(s){case X.setup:return o;case X.first:return n+(o-n)*t}return n}let c=this.getCurveValue(e)*o;if(t==1)return s==X.add?n+c-o:c;if(i==Ee.mixOut)switch(s){case X.setup:return o+(Math.abs(c)*V.signum(o)-o)*t;case X.first:case X.replace:return n+(Math.abs(c)*V.signum(n)-n)*t}else{let a=0;switch(s){case X.setup:return a=Math.abs(o)*V.signum(c),a+(c-a)*t;case X.first:case X.replace:return a=Math.abs(n)*V.signum(c),a+(c-a)*t}}return n+(c-o)*t}}class ds extends He{constructor(e,t,s,i){super(e,t,[s,i])}getFrameEntries(){return 3}setFrame(e,t,s,i){e*=3,this.frames[e]=t,this.frames[e+1]=s,this.frames[e+2]=i}}class Bt extends Ue{constructor(t,s,i){super(t,s,ae.rotate+"|"+i);d(this,"boneIndex",0);this.boneIndex=i}apply(t,s,i,n,o,r,c){let a=t.bones[this.boneIndex];a.active&&(a.rotation=this.getRelativeValue(i,o,r,a.rotation,a.data.rotation))}}class Vs extends ds{constructor(t,s,i){super(t,s,ae.x+"|"+i,ae.y+"|"+i);d(this,"boneIndex",0);this.boneIndex=i}apply(t,s,i,n,o,r,c){let a=t.bones[this.boneIndex];if(!a.active)return;let l=this.frames;if(i<l[0]){switch(r){case X.setup:a.x=a.data.x,a.y=a.data.y;return;case X.first:a.x+=(a.data.x-a.x)*o,a.y+=(a.data.y-a.y)*o}return}let h=0,u=0,f=pe.search(l,i,3),m=this.curves[f/3];switch(m){case 0:let g=l[f];h=l[f+1],u=l[f+2];let p=(i-g)/(l[f+3]-g);h+=(l[f+3+1]-h)*p,u+=(l[f+3+2]-u)*p;break;case 1:h=l[f+1],u=l[f+2];break;default:h=this.getBezierValue(i,f,1,m-2),u=this.getBezierValue(i,f,2,m+18-2)}switch(r){case X.setup:a.x=a.data.x+h*o,a.y=a.data.y+u*o;break;case X.first:case X.replace:a.x+=(a.data.x+h-a.x)*o,a.y+=(a.data.y+u-a.y)*o;break;case X.add:a.x+=h*o,a.y+=u*o}}}class Os extends Ue{constructor(t,s,i){super(t,s,ae.x+"|"+i);d(this,"boneIndex",0);this.boneIndex=i}apply(t,s,i,n,o,r,c){let a=t.bones[this.boneIndex];a.active&&(a.x=this.getRelativeValue(i,o,r,a.x,a.data.x))}}class Ns extends Ue{constructor(t,s,i){super(t,s,ae.y+"|"+i);d(this,"boneIndex",0);this.boneIndex=i}apply(t,s,i,n,o,r,c){let a=t.bones[this.boneIndex];a.active&&(a.y=this.getRelativeValue(i,o,r,a.y,a.data.y))}}class Ds extends ds{constructor(t,s,i){super(t,s,ae.scaleX+"|"+i,ae.scaleY+"|"+i);d(this,"boneIndex",0);this.boneIndex=i}apply(t,s,i,n,o,r,c){let a=t.bones[this.boneIndex];if(!a.active)return;let l=this.frames;if(i<l[0]){switch(r){case X.setup:a.scaleX=a.data.scaleX,a.scaleY=a.data.scaleY;return;case X.first:a.scaleX+=(a.data.scaleX-a.scaleX)*o,a.scaleY+=(a.data.scaleY-a.scaleY)*o}return}let h,u,f=pe.search(l,i,3),m=this.curves[f/3];switch(m){case 0:let g=l[f];h=l[f+1],u=l[f+2];let p=(i-g)/(l[f+3]-g);h+=(l[f+3+1]-h)*p,u+=(l[f+3+2]-u)*p;break;case 1:h=l[f+1],u=l[f+2];break;default:h=this.getBezierValue(i,f,1,m-2),u=this.getBezierValue(i,f,2,m+18-2)}if(h*=a.data.scaleX,u*=a.data.scaleY,o==1)r==X.add?(a.scaleX+=h-a.data.scaleX,a.scaleY+=u-a.data.scaleY):(a.scaleX=h,a.scaleY=u);else{let g=0,p=0;if(c==Ee.mixOut)switch(r){case X.setup:g=a.data.scaleX,p=a.data.scaleY,a.scaleX=g+(Math.abs(h)*V.signum(g)-g)*o,a.scaleY=p+(Math.abs(u)*V.signum(p)-p)*o;break;case X.first:case X.replace:g=a.scaleX,p=a.scaleY,a.scaleX=g+(Math.abs(h)*V.signum(g)-g)*o,a.scaleY=p+(Math.abs(u)*V.signum(p)-p)*o;break;case X.add:a.scaleX+=(h-a.data.scaleX)*o,a.scaleY+=(u-a.data.scaleY)*o}else switch(r){case X.setup:g=Math.abs(a.data.scaleX)*V.signum(h),p=Math.abs(a.data.scaleY)*V.signum(u),a.scaleX=g+(h-g)*o,a.scaleY=p+(u-p)*o;break;case X.first:case X.replace:g=Math.abs(a.scaleX)*V.signum(h),p=Math.abs(a.scaleY)*V.signum(u),a.scaleX=g+(h-g)*o,a.scaleY=p+(u-p)*o;break;case X.add:a.scaleX+=(h-a.data.scaleX)*o,a.scaleY+=(u-a.data.scaleY)*o}}}}class Us extends Ue{constructor(t,s,i){super(t,s,ae.scaleX+"|"+i);d(this,"boneIndex",0);this.boneIndex=i}apply(t,s,i,n,o,r,c){let a=t.bones[this.boneIndex];a.active&&(a.scaleX=this.getScaleValue(i,o,r,c,a.scaleX,a.data.scaleX))}}class zs extends Ue{constructor(t,s,i){super(t,s,ae.scaleY+"|"+i);d(this,"boneIndex",0);this.boneIndex=i}apply(t,s,i,n,o,r,c){let a=t.bones[this.boneIndex];a.active&&(a.scaleY=this.getScaleValue(i,o,r,c,a.scaleY,a.data.scaleY))}}class Ws extends ds{constructor(t,s,i){super(t,s,ae.shearX+"|"+i,ae.shearY+"|"+i);d(this,"boneIndex",0);this.boneIndex=i}apply(t,s,i,n,o,r,c){let a=t.bones[this.boneIndex];if(!a.active)return;let l=this.frames;if(i<l[0]){switch(r){case X.setup:a.shearX=a.data.shearX,a.shearY=a.data.shearY;return;case X.first:a.shearX+=(a.data.shearX-a.shearX)*o,a.shearY+=(a.data.shearY-a.shearY)*o}return}let h=0,u=0,f=pe.search(l,i,3),m=this.curves[f/3];switch(m){case 0:let g=l[f];h=l[f+1],u=l[f+2];let p=(i-g)/(l[f+3]-g);h+=(l[f+3+1]-h)*p,u+=(l[f+3+2]-u)*p;break;case 1:h=l[f+1],u=l[f+2];break;default:h=this.getBezierValue(i,f,1,m-2),u=this.getBezierValue(i,f,2,m+18-2)}switch(r){case X.setup:a.shearX=a.data.shearX+h*o,a.shearY=a.data.shearY+u*o;break;case X.first:case X.replace:a.shearX+=(a.data.shearX+h-a.shearX)*o,a.shearY+=(a.data.shearY+u-a.shearY)*o;break;case X.add:a.shearX+=h*o,a.shearY+=u*o}}}class qs extends Ue{constructor(t,s,i){super(t,s,ae.shearX+"|"+i);d(this,"boneIndex",0);this.boneIndex=i}apply(t,s,i,n,o,r,c){let a=t.bones[this.boneIndex];a.active&&(a.shearX=this.getRelativeValue(i,o,r,a.shearX,a.data.shearX))}}class Gs extends Ue{constructor(t,s,i){super(t,s,ae.shearY+"|"+i);d(this,"boneIndex",0);this.boneIndex=i}apply(t,s,i,n,o,r,c){let a=t.bones[this.boneIndex];a.active&&(a.shearY=this.getRelativeValue(i,o,r,a.shearY,a.data.shearY))}}class Hs extends pe{constructor(t,s){super(t,[ae.inherit+"|"+s]);d(this,"boneIndex",0);this.boneIndex=s}getFrameEntries(){return 2}setFrame(t,s,i){t*=2,this.frames[t]=s,this.frames[t+1]=i}apply(t,s,i,n,o,r,c){let a=t.bones[this.boneIndex];if(!a.active)return;let l=this.frames;if(i<l[0]){(r==X.setup||r==X.first)&&(a.inherit=a.data.inherit);return}a.inherit=this.frames[pe.search(l,i,2)+1]}}class js extends He{constructor(t,s,i){super(t,s,[ae.rgb+"|"+i,ae.alpha+"|"+i]);d(this,"slotIndex",0);this.slotIndex=i}getFrameEntries(){return 5}setFrame(t,s,i,n,o,r){t*=5,this.frames[t]=s,this.frames[t+1]=i,this.frames[t+2]=n,this.frames[t+3]=o,this.frames[t+4]=r}apply(t,s,i,n,o,r,c){let a=t.slots[this.slotIndex];if(!a.bone.active)return;let l=this.frames,h=a.color;if(i<l[0]){let y=a.data.color;switch(r){case X.setup:h.setFromColor(y);return;case X.first:h.add((y.r-h.r)*o,(y.g-h.g)*o,(y.b-h.b)*o,(y.a-h.a)*o)}return}let u=0,f=0,m=0,g=0,p=pe.search(l,i,5),x=this.curves[p/5];switch(x){case 0:let y=l[p];u=l[p+1],f=l[p+2],m=l[p+3],g=l[p+4];let b=(i-y)/(l[p+5]-y);u+=(l[p+5+1]-u)*b,f+=(l[p+5+2]-f)*b,m+=(l[p+5+3]-m)*b,g+=(l[p+5+4]-g)*b;break;case 1:u=l[p+1],f=l[p+2],m=l[p+3],g=l[p+4];break;default:u=this.getBezierValue(i,p,1,x-2),f=this.getBezierValue(i,p,2,x+18-2),m=this.getBezierValue(i,p,3,x+18*2-2),g=this.getBezierValue(i,p,4,x+18*3-2)}o==1?h.set(u,f,m,g):(r==X.setup&&h.setFromColor(a.data.color),h.add((u-h.r)*o,(f-h.g)*o,(m-h.b)*o,(g-h.a)*o))}}class Zs extends He{constructor(t,s,i){super(t,s,[ae.rgb+"|"+i]);d(this,"slotIndex",0);this.slotIndex=i}getFrameEntries(){return 4}setFrame(t,s,i,n,o){t<<=2,this.frames[t]=s,this.frames[t+1]=i,this.frames[t+2]=n,this.frames[t+3]=o}apply(t,s,i,n,o,r,c){let a=t.slots[this.slotIndex];if(!a.bone.active)return;let l=this.frames,h=a.color;if(i<l[0]){let x=a.data.color;switch(r){case X.setup:h.r=x.r,h.g=x.g,h.b=x.b;return;case X.first:h.r+=(x.r-h.r)*o,h.g+=(x.g-h.g)*o,h.b+=(x.b-h.b)*o}return}let u=0,f=0,m=0,g=pe.search(l,i,4),p=this.curves[g>>2];switch(p){case 0:let x=l[g];u=l[g+1],f=l[g+2],m=l[g+3];let y=(i-x)/(l[g+4]-x);u+=(l[g+4+1]-u)*y,f+=(l[g+4+2]-f)*y,m+=(l[g+4+3]-m)*y;break;case 1:u=l[g+1],f=l[g+2],m=l[g+3];break;default:u=this.getBezierValue(i,g,1,p-2),f=this.getBezierValue(i,g,2,p+18-2),m=this.getBezierValue(i,g,3,p+18*2-2)}if(o==1)h.r=u,h.g=f,h.b=m;else{if(r==X.setup){let x=a.data.color;h.r=x.r,h.g=x.g,h.b=x.b}h.r+=(u-h.r)*o,h.g+=(f-h.g)*o,h.b+=(m-h.b)*o}}}class Js extends Ue{constructor(t,s,i){super(t,s,ae.alpha+"|"+i);d(this,"slotIndex",0);this.slotIndex=i}apply(t,s,i,n,o,r,c){let a=t.slots[this.slotIndex];if(!a.bone.active)return;let l=a.color;if(i<this.frames[0]){let u=a.data.color;switch(r){case X.setup:l.a=u.a;return;case X.first:l.a+=(u.a-l.a)*o}return}let h=this.getCurveValue(i);o==1?l.a=h:(r==X.setup&&(l.a=a.data.color.a),l.a+=(h-l.a)*o)}}class Ks extends He{constructor(t,s,i){super(t,s,[ae.rgb+"|"+i,ae.alpha+"|"+i,ae.rgb2+"|"+i]);d(this,"slotIndex",0);this.slotIndex=i}getFrameEntries(){return 8}setFrame(t,s,i,n,o,r,c,a,l){t<<=3,this.frames[t]=s,this.frames[t+1]=i,this.frames[t+2]=n,this.frames[t+3]=o,this.frames[t+4]=r,this.frames[t+5]=c,this.frames[t+6]=a,this.frames[t+7]=l}apply(t,s,i,n,o,r,c){let a=t.slots[this.slotIndex];if(!a.bone.active)return;let l=this.frames,h=a.color,u=a.darkColor;if(i<l[0]){let v=a.data.color,A=a.data.darkColor;switch(r){case X.setup:h.setFromColor(v),u.r=A.r,u.g=A.g,u.b=A.b;return;case X.first:h.add((v.r-h.r)*o,(v.g-h.g)*o,(v.b-h.b)*o,(v.a-h.a)*o),u.r+=(A.r-u.r)*o,u.g+=(A.g-u.g)*o,u.b+=(A.b-u.b)*o}return}let f=0,m=0,g=0,p=0,x=0,y=0,b=0,w=pe.search(l,i,8),C=this.curves[w>>3];switch(C){case 0:let v=l[w];f=l[w+1],m=l[w+2],g=l[w+3],p=l[w+4],x=l[w+5],y=l[w+6],b=l[w+7];let A=(i-v)/(l[w+8]-v);f+=(l[w+8+1]-f)*A,m+=(l[w+8+2]-m)*A,g+=(l[w+8+3]-g)*A,p+=(l[w+8+4]-p)*A,x+=(l[w+8+5]-x)*A,y+=(l[w+8+6]-y)*A,b+=(l[w+8+7]-b)*A;break;case 1:f=l[w+1],m=l[w+2],g=l[w+3],p=l[w+4],x=l[w+5],y=l[w+6],b=l[w+7];break;default:f=this.getBezierValue(i,w,1,C-2),m=this.getBezierValue(i,w,2,C+18-2),g=this.getBezierValue(i,w,3,C+18*2-2),p=this.getBezierValue(i,w,4,C+18*3-2),x=this.getBezierValue(i,w,5,C+18*4-2),y=this.getBezierValue(i,w,6,C+18*5-2),b=this.getBezierValue(i,w,7,C+18*6-2)}if(o==1)h.set(f,m,g,p),u.r=x,u.g=y,u.b=b;else{if(r==X.setup){h.setFromColor(a.data.color);let v=a.data.darkColor;u.r=v.r,u.g=v.g,u.b=v.b}h.add((f-h.r)*o,(m-h.g)*o,(g-h.b)*o,(p-h.a)*o),u.r+=(x-u.r)*o,u.g+=(y-u.g)*o,u.b+=(b-u.b)*o}}}class Qs extends He{constructor(t,s,i){super(t,s,[ae.rgb+"|"+i,ae.rgb2+"|"+i]);d(this,"slotIndex",0);this.slotIndex=i}getFrameEntries(){return 7}setFrame(t,s,i,n,o,r,c,a){t*=7,this.frames[t]=s,this.frames[t+1]=i,this.frames[t+2]=n,this.frames[t+3]=o,this.frames[t+4]=r,this.frames[t+5]=c,this.frames[t+6]=a}apply(t,s,i,n,o,r,c){let a=t.slots[this.slotIndex];if(!a.bone.active)return;let l=this.frames,h=a.color,u=a.darkColor;if(i<l[0]){let C=a.data.color,v=a.data.darkColor;switch(r){case X.setup:h.r=C.r,h.g=C.g,h.b=C.b,u.r=v.r,u.g=v.g,u.b=v.b;return;case X.first:h.r+=(C.r-h.r)*o,h.g+=(C.g-h.g)*o,h.b+=(C.b-h.b)*o,u.r+=(v.r-u.r)*o,u.g+=(v.g-u.g)*o,u.b+=(v.b-u.b)*o}return}let f=0,m=0,g=0,p=0,x=0,y=0,b=pe.search(l,i,7),w=this.curves[b/7];switch(w){case 0:let C=l[b];f=l[b+1],m=l[b+2],g=l[b+3],p=l[b+4],x=l[b+5],y=l[b+6];let v=(i-C)/(l[b+7]-C);f+=(l[b+7+1]-f)*v,m+=(l[b+7+2]-m)*v,g+=(l[b+7+3]-g)*v,p+=(l[b+7+4]-p)*v,x+=(l[b+7+5]-x)*v,y+=(l[b+7+6]-y)*v;break;case 1:f=l[b+1],m=l[b+2],g=l[b+3],p=l[b+4],x=l[b+5],y=l[b+6];break;default:f=this.getBezierValue(i,b,1,w-2),m=this.getBezierValue(i,b,2,w+18-2),g=this.getBezierValue(i,b,3,w+18*2-2),p=this.getBezierValue(i,b,4,w+18*3-2),x=this.getBezierValue(i,b,5,w+18*4-2),y=this.getBezierValue(i,b,6,w+18*5-2)}if(o==1)h.r=f,h.g=m,h.b=g,u.r=p,u.g=x,u.b=y;else{if(r==X.setup){let C=a.data.color,v=a.data.darkColor;h.r=C.r,h.g=C.g,h.b=C.b,u.r=v.r,u.g=v.g,u.b=v.b}h.r+=(f-h.r)*o,h.g+=(m-h.g)*o,h.b+=(g-h.b)*o,u.r+=(p-u.r)*o,u.g+=(x-u.g)*o,u.b+=(y-u.b)*o}}}class dt extends pe{constructor(t,s){super(t,[ae.attachment+"|"+s]);d(this,"slotIndex",0);d(this,"attachmentNames");this.slotIndex=s,this.attachmentNames=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,s,i){this.frames[t]=s,this.attachmentNames[t]=i}apply(t,s,i,n,o,r,c){let a=t.slots[this.slotIndex];if(a.bone.active){if(c==Ee.mixOut){r==X.setup&&this.setAttachment(t,a,a.data.attachmentName);return}if(i<this.frames[0]){(r==X.setup||r==X.first)&&this.setAttachment(t,a,a.data.attachmentName);return}this.setAttachment(t,a,this.attachmentNames[pe.search1(this.frames,i)])}}setAttachment(t,s,i){s.setAttachment(i?t.getAttachment(this.slotIndex,i):null)}}class _s extends He{constructor(t,s,i,n){super(t,s,[ae.deform+"|"+i+"|"+n.id]);d(this,"slotIndex",0);d(this,"attachment");d(this,"vertices");this.slotIndex=i,this.attachment=n,this.vertices=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,s,i){this.frames[t]=s,this.vertices[t]=i}setBezier(t,s,i,n,o,r,c,a,l,h,u){let f=this.curves,m=this.getFrameCount()+t*18;i==0&&(f[s]=2+m);let g=(n-r*2+a)*.03,p=l*.03-c*.06,x=((r-a)*3-n+h)*.006,y=(c-l+.33333333)*.018,b=g*2+x,w=p*2+y,C=(r-n)*.3+g+x*.16666667,v=c*.3+p+y*.16666667,A=n+C,I=v;for(let E=m+18;m<E;m+=2)f[m]=A,f[m+1]=I,C+=b,v+=w,b+=x,w+=y,A+=C,I+=v}getCurvePercent(t,s){let i=this.curves,n=i[s];switch(n){case 0:let a=this.frames[s];return(t-a)/(this.frames[s+this.getFrameEntries()]-a);case 1:return 0}if(n-=2,i[n]>t){let a=this.frames[s];return i[n+1]*(t-a)/(i[n]-a)}let o=n+18;for(n+=2;n<o;n+=2)if(i[n]>=t){let a=i[n-2],l=i[n-1];return l+(t-a)/(i[n]-a)*(i[n+1]-l)}let r=i[o-2],c=i[o-1];return c+(1-c)*(t-r)/(this.frames[s+this.getFrameEntries()]-r)}apply(t,s,i,n,o,r,c){let a=t.slots[this.slotIndex];if(!a.bone.active)return;let l=a.getAttachment();if(!l||!(l instanceof De)||l.timelineAttachment!=this.attachment)return;let h=a.deform;h.length==0&&(r=X.setup);let u=this.vertices,f=u[0].length,m=this.frames;if(i<m[0]){switch(r){case X.setup:h.length=0;return;case X.first:if(o==1){h.length=0;return}h.length=f;let w=l;if(w.bones){o=1-o;for(var g=0;g<f;g++)h[g]*=o}else{let C=w.vertices;for(var g=0;g<f;g++)h[g]+=(C[g]-h[g])*o}}return}if(h.length=f,i>=m[m.length-1]){let w=u[m.length-1];if(o==1)if(r==X.add){let C=l;if(C.bones)for(let v=0;v<f;v++)h[v]+=w[v];else{let v=C.vertices;for(let A=0;A<f;A++)h[A]+=w[A]-v[A]}}else O.arrayCopy(w,0,h,0,f);else switch(r){case X.setup:{let v=l;if(v.bones)for(let A=0;A<f;A++)h[A]=w[A]*o;else{let A=v.vertices;for(let I=0;I<f;I++){let E=A[I];h[I]=E+(w[I]-E)*o}}break}case X.first:case X.replace:for(let v=0;v<f;v++)h[v]+=(w[v]-h[v])*o;break;case X.add:let C=l;if(C.bones)for(let v=0;v<f;v++)h[v]+=w[v]*o;else{let v=C.vertices;for(let A=0;A<f;A++)h[A]+=(w[A]-v[A])*o}}return}let p=pe.search1(m,i),x=this.getCurvePercent(i,p),y=u[p],b=u[p+1];if(o==1)if(r==X.add){let w=l;if(w.bones)for(let C=0;C<f;C++){let v=y[C];h[C]+=v+(b[C]-v)*x}else{let C=w.vertices;for(let v=0;v<f;v++){let A=y[v];h[v]+=A+(b[v]-A)*x-C[v]}}}else for(let w=0;w<f;w++){let C=y[w];h[w]=C+(b[w]-C)*x}else switch(r){case X.setup:{let C=l;if(C.bones)for(let v=0;v<f;v++){let A=y[v];h[v]=(A+(b[v]-A)*x)*o}else{let v=C.vertices;for(let A=0;A<f;A++){let I=y[A],E=v[A];h[A]=E+(I+(b[A]-I)*x-E)*o}}break}case X.first:case X.replace:for(let C=0;C<f;C++){let v=y[C];h[C]+=(v+(b[C]-v)*x-h[C])*o}break;case X.add:let w=l;if(w.bones)for(let C=0;C<f;C++){let v=y[C];h[C]+=(v+(b[C]-v)*x)*o}else{let C=w.vertices;for(let v=0;v<f;v++){let A=y[v];h[v]+=(A+(b[v]-A)*x-C[v])*o}}}}}const Ut=class Ut extends pe{constructor(t){super(t,Ut.propertyIds);d(this,"events");this.events=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,s){this.frames[t]=s.time,this.events[t]=s}apply(t,s,i,n,o,r,c){if(!n)return;let a=this.frames,l=this.frames.length;if(s>i)this.apply(t,s,Number.MAX_VALUE,n,o,r,c),s=-1;else if(s>=a[l-1])return;if(i<a[0])return;let h=0;if(s<a[0])h=0;else{h=pe.search1(a,s)+1;let u=a[h];for(;h>0&&a[h-1]==u;)h--}for(;h<l&&i>=a[h];h++)n.push(this.events[h])}};d(Ut,"propertyIds",[""+ae.event]);let It=Ut;const zt=class zt extends pe{constructor(t){super(t,zt.propertyIds);d(this,"drawOrders");this.drawOrders=new Array(t)}getFrameCount(){return this.frames.length}setFrame(t,s,i){this.frames[t]=s,this.drawOrders[t]=i}apply(t,s,i,n,o,r,c){if(c==Ee.mixOut){r==X.setup&&O.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}if(i<this.frames[0]){(r==X.setup||r==X.first)&&O.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);return}let a=pe.search1(this.frames,i),l=this.drawOrders[a];if(!l)O.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);else{let h=t.drawOrder,u=t.slots;for(let f=0,m=l.length;f<m;f++)h[f]=u[l[f]]}}};d(zt,"propertyIds",[""+ae.drawOrder]);let it=zt;class $s extends He{constructor(t,s,i){super(t,s,[ae.ikConstraint+"|"+i]);d(this,"constraintIndex",0);this.constraintIndex=i}getFrameEntries(){return 6}setFrame(t,s,i,n,o,r,c){t*=6,this.frames[t]=s,this.frames[t+1]=i,this.frames[t+2]=n,this.frames[t+3]=o,this.frames[t+4]=r?1:0,this.frames[t+5]=c?1:0}apply(t,s,i,n,o,r,c){let a=t.ikConstraints[this.constraintIndex];if(!a.active)return;let l=this.frames;if(i<l[0]){switch(r){case X.setup:a.mix=a.data.mix,a.softness=a.data.softness,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch;return;case X.first:a.mix+=(a.data.mix-a.mix)*o,a.softness+=(a.data.softness-a.softness)*o,a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch}return}let h=0,u=0,f=pe.search(l,i,6),m=this.curves[f/6];switch(m){case 0:let g=l[f];h=l[f+1],u=l[f+2];let p=(i-g)/(l[f+6]-g);h+=(l[f+6+1]-h)*p,u+=(l[f+6+2]-u)*p;break;case 1:h=l[f+1],u=l[f+2];break;default:h=this.getBezierValue(i,f,1,m-2),u=this.getBezierValue(i,f,2,m+18-2)}r==X.setup?(a.mix=a.data.mix+(h-a.data.mix)*o,a.softness=a.data.softness+(u-a.data.softness)*o,c==Ee.mixOut?(a.bendDirection=a.data.bendDirection,a.compress=a.data.compress,a.stretch=a.data.stretch):(a.bendDirection=l[f+3],a.compress=l[f+4]!=0,a.stretch=l[f+5]!=0)):(a.mix+=(h-a.mix)*o,a.softness+=(u-a.softness)*o,c==Ee.mixIn&&(a.bendDirection=l[f+3],a.compress=l[f+4]!=0,a.stretch=l[f+5]!=0))}}class ei extends He{constructor(t,s,i){super(t,s,[ae.transformConstraint+"|"+i]);d(this,"constraintIndex",0);this.constraintIndex=i}getFrameEntries(){return 7}setFrame(t,s,i,n,o,r,c,a){let l=this.frames;t*=7,l[t]=s,l[t+1]=i,l[t+2]=n,l[t+3]=o,l[t+4]=r,l[t+5]=c,l[t+6]=a}apply(t,s,i,n,o,r,c){let a=t.transformConstraints[this.constraintIndex];if(!a.active)return;let l=this.frames;if(i<l[0]){let b=a.data;switch(r){case X.setup:a.mixRotate=b.mixRotate,a.mixX=b.mixX,a.mixY=b.mixY,a.mixScaleX=b.mixScaleX,a.mixScaleY=b.mixScaleY,a.mixShearY=b.mixShearY;return;case X.first:a.mixRotate+=(b.mixRotate-a.mixRotate)*o,a.mixX+=(b.mixX-a.mixX)*o,a.mixY+=(b.mixY-a.mixY)*o,a.mixScaleX+=(b.mixScaleX-a.mixScaleX)*o,a.mixScaleY+=(b.mixScaleY-a.mixScaleY)*o,a.mixShearY+=(b.mixShearY-a.mixShearY)*o}return}let h,u,f,m,g,p,x=pe.search(l,i,7),y=this.curves[x/7];switch(y){case 0:let b=l[x];h=l[x+1],u=l[x+2],f=l[x+3],m=l[x+4],g=l[x+5],p=l[x+6];let w=(i-b)/(l[x+7]-b);h+=(l[x+7+1]-h)*w,u+=(l[x+7+2]-u)*w,f+=(l[x+7+3]-f)*w,m+=(l[x+7+4]-m)*w,g+=(l[x+7+5]-g)*w,p+=(l[x+7+6]-p)*w;break;case 1:h=l[x+1],u=l[x+2],f=l[x+3],m=l[x+4],g=l[x+5],p=l[x+6];break;default:h=this.getBezierValue(i,x,1,y-2),u=this.getBezierValue(i,x,2,y+18-2),f=this.getBezierValue(i,x,3,y+18*2-2),m=this.getBezierValue(i,x,4,y+18*3-2),g=this.getBezierValue(i,x,5,y+18*4-2),p=this.getBezierValue(i,x,6,y+18*5-2)}if(r==X.setup){let b=a.data;a.mixRotate=b.mixRotate+(h-b.mixRotate)*o,a.mixX=b.mixX+(u-b.mixX)*o,a.mixY=b.mixY+(f-b.mixY)*o,a.mixScaleX=b.mixScaleX+(m-b.mixScaleX)*o,a.mixScaleY=b.mixScaleY+(g-b.mixScaleY)*o,a.mixShearY=b.mixShearY+(p-b.mixShearY)*o}else a.mixRotate+=(h-a.mixRotate)*o,a.mixX+=(u-a.mixX)*o,a.mixY+=(f-a.mixY)*o,a.mixScaleX+=(m-a.mixScaleX)*o,a.mixScaleY+=(g-a.mixScaleY)*o,a.mixShearY+=(p-a.mixShearY)*o}}class ti extends Ue{constructor(t,s,i){super(t,s,ae.pathConstraintPosition+"|"+i);d(this,"constraintIndex",0);this.constraintIndex=i}apply(t,s,i,n,o,r,c){let a=t.pathConstraints[this.constraintIndex];a.active&&(a.position=this.getAbsoluteValue(i,o,r,a.position,a.data.position))}}class si extends Ue{constructor(t,s,i){super(t,s,ae.pathConstraintSpacing+"|"+i);d(this,"constraintIndex",0);this.constraintIndex=i}apply(t,s,i,n,o,r,c){let a=t.pathConstraints[this.constraintIndex];a.active&&(a.spacing=this.getAbsoluteValue(i,o,r,a.spacing,a.data.spacing))}}class ii extends He{constructor(t,s,i){super(t,s,[ae.pathConstraintMix+"|"+i]);d(this,"constraintIndex",0);this.constraintIndex=i}getFrameEntries(){return 4}setFrame(t,s,i,n,o){let r=this.frames;t<<=2,r[t]=s,r[t+1]=i,r[t+2]=n,r[t+3]=o}apply(t,s,i,n,o,r,c){let a=t.pathConstraints[this.constraintIndex];if(!a.active)return;let l=this.frames;if(i<l[0]){switch(r){case X.setup:a.mixRotate=a.data.mixRotate,a.mixX=a.data.mixX,a.mixY=a.data.mixY;return;case X.first:a.mixRotate+=(a.data.mixRotate-a.mixRotate)*o,a.mixX+=(a.data.mixX-a.mixX)*o,a.mixY+=(a.data.mixY-a.mixY)*o}return}let h,u,f,m=pe.search(l,i,4),g=this.curves[m>>2];switch(g){case 0:let p=l[m];h=l[m+1],u=l[m+2],f=l[m+3];let x=(i-p)/(l[m+4]-p);h+=(l[m+4+1]-h)*x,u+=(l[m+4+2]-u)*x,f+=(l[m+4+3]-f)*x;break;case 1:h=l[m+1],u=l[m+2],f=l[m+3];break;default:h=this.getBezierValue(i,m,1,g-2),u=this.getBezierValue(i,m,2,g+18-2),f=this.getBezierValue(i,m,3,g+18*2-2)}if(r==X.setup){let p=a.data;a.mixRotate=p.mixRotate+(h-p.mixRotate)*o,a.mixX=p.mixX+(u-p.mixX)*o,a.mixY=p.mixY+(f-p.mixY)*o}else a.mixRotate+=(h-a.mixRotate)*o,a.mixX+=(u-a.mixX)*o,a.mixY+=(f-a.mixY)*o}}class at extends Ue{constructor(t,s,i,n){super(t,s,n+"|"+i);d(this,"constraintIndex",0);this.constraintIndex=i}apply(t,s,i,n,o,r,c){let a;if(this.constraintIndex==-1){const l=i>=this.frames[0]?this.getCurveValue(i):0;for(const h of t.physicsConstraints)h.active&&this.global(h.data)&&this.set(h,this.getAbsoluteValue2(i,o,r,this.get(h),this.setup(h),l))}else a=t.physicsConstraints[this.constraintIndex],a.active&&this.set(a,this.getAbsoluteValue(i,o,r,this.get(a),this.setup(a)))}}class ri extends at{constructor(e,t,s){super(e,t,s,ae.physicsConstraintInertia)}setup(e){return e.data.inertia}get(e){return e.inertia}set(e,t){e.inertia=t}global(e){return e.inertiaGlobal}}class ni extends at{constructor(e,t,s){super(e,t,s,ae.physicsConstraintStrength)}setup(e){return e.data.strength}get(e){return e.strength}set(e,t){e.strength=t}global(e){return e.strengthGlobal}}class ai extends at{constructor(e,t,s){super(e,t,s,ae.physicsConstraintDamping)}setup(e){return e.data.damping}get(e){return e.damping}set(e,t){e.damping=t}global(e){return e.dampingGlobal}}class li extends at{constructor(e,t,s){super(e,t,s,ae.physicsConstraintMass)}setup(e){return 1/e.data.massInverse}get(e){return 1/e.massInverse}set(e,t){e.massInverse=1/t}global(e){return e.massGlobal}}class oi extends at{constructor(e,t,s){super(e,t,s,ae.physicsConstraintWind)}setup(e){return e.data.wind}get(e){return e.wind}set(e,t){e.wind=t}global(e){return e.windGlobal}}class hi extends at{constructor(e,t,s){super(e,t,s,ae.physicsConstraintGravity)}setup(e){return e.data.gravity}get(e){return e.gravity}set(e,t){e.gravity=t}global(e){return e.gravityGlobal}}class ci extends at{constructor(e,t,s){super(e,t,s,ae.physicsConstraintMix)}setup(e){return e.data.mix}get(e){return e.mix}set(e,t){e.mix=t}global(e){return e.mixGlobal}}const Wt=class Wt extends pe{constructor(t,s){super(t,Wt.propertyIds);d(this,"constraintIndex");this.constraintIndex=s}getFrameCount(){return this.frames.length}setFrame(t,s){this.frames[t]=s}apply(t,s,i,n,o,r,c){let a;if(this.constraintIndex!=-1&&(a=t.physicsConstraints[this.constraintIndex],!a.active))return;const l=this.frames;if(s>i)this.apply(t,s,Number.MAX_VALUE,[],o,r,c),s=-1;else if(s>=l[l.length-1])return;if(!(i<l[0])&&(s<l[0]||i>=l[pe.search1(l,s)+1]))if(a!=null)a.reset();else for(const h of t.physicsConstraints)h.active&&h.reset()}};d(Wt,"propertyIds",[ae.physicsConstraintReset.toString()]);let Pt=Wt;const Be=class Be extends pe{constructor(t,s,i){super(t,[ae.sequence+"|"+s+"|"+i.sequence.id]);d(this,"slotIndex");d(this,"attachment");this.slotIndex=s,this.attachment=i}getFrameEntries(){return Be.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(t,s,i,n,o){let r=this.frames;t*=Be.ENTRIES,r[t]=s,r[t+Be.MODE]=i|n<<4,r[t+Be.DELAY]=o}apply(t,s,i,n,o,r,c){let a=t.slots[this.slotIndex];if(!a.bone.active)return;let l=a.attachment,h=this.attachment;if(l!=h&&(!(l instanceof De)||l.timelineAttachment!=h))return;let u=this.frames;if(i<u[0]){(r==X.setup||r==X.first)&&(a.sequenceIndex=-1);return}let f=pe.search(u,i,Be.ENTRIES),m=u[f],g=u[f+Be.MODE],p=u[f+Be.DELAY];if(!this.attachment.sequence)return;let x=g>>4,y=this.attachment.sequence.regions.length,b=Ps[g&15];if(b!=Ce.hold)switch(x+=(i-m)/p+1e-5|0,b){case Ce.once:x=Math.min(y-1,x);break;case Ce.loop:x%=y;break;case Ce.pingpong:{let w=(y<<1)-2;x=w==0?0:x%w,x>=y&&(x=w-x);break}case Ce.onceReverse:x=Math.max(y-1-x,0);break;case Ce.loopReverse:x=y-1-x%y;break;case Ce.pingpongReverse:{let w=(y<<1)-2;x=w==0?0:(x+y-1)%w,x>=y&&(x=w-x)}}a.sequenceIndex=x}};d(Be,"ENTRIES",3),d(Be,"MODE",1),d(Be,"DELAY",2);let Vt=Be;const mt=class mt{constructor(e){d(this,"data");d(this,"tracks",new Array);d(this,"timeScale",1);d(this,"unkeyedState",0);d(this,"events",new Array);d(this,"listeners",new Array);d(this,"queue",new Li(this));d(this,"propertyIDs",new Ls);d(this,"animationsChanged",!1);d(this,"trackEntryPool",new Lt(()=>new Yi));this.data=e}static emptyAnimation(){return mt._emptyAnimation}update(e){e*=this.timeScale;let t=this.tracks;for(let s=0,i=t.length;s<i;s++){let n=t[s];if(!n)continue;n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast;let o=e*n.timeScale;if(n.delay>0){if(n.delay-=o,n.delay>0)continue;o=-n.delay,n.delay=0}let r=n.next;if(r){let c=n.trackLast-r.delay;if(c>=0){for(r.delay=0,r.trackTime+=n.timeScale==0?0:(c/n.timeScale+e)*r.timeScale,n.trackTime+=o,this.setCurrent(s,r,!0);r.mixingFrom;)r.mixTime+=e,r=r.mixingFrom;continue}}else if(n.trackLast>=n.trackEnd&&!n.mixingFrom){t[s]=null,this.queue.end(n),this.clearNext(n);continue}if(n.mixingFrom&&this.updateMixingFrom(n,e)){let c=n.mixingFrom;for(n.mixingFrom=null,c&&(c.mixingTo=null);c;)this.queue.end(c),c=c.mixingFrom}n.trackTime+=o}this.queue.drain()}updateMixingFrom(e,t){let s=e.mixingFrom;if(!s)return!0;let i=this.updateMixingFrom(s,t);return s.animationLast=s.nextAnimationLast,s.trackLast=s.nextTrackLast,e.mixTime>0&&e.mixTime>=e.mixDuration?((s.totalAlpha==0||e.mixDuration==0)&&(e.mixingFrom=s.mixingFrom,s.mixingFrom&&(s.mixingFrom.mixingTo=e),e.interruptAlpha=s.interruptAlpha,this.queue.end(s)),i):(s.trackTime+=t*s.timeScale,e.mixTime+=t,!1)}apply(e){if(!e)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let t=this.events,s=this.tracks,i=!1;for(let u=0,f=s.length;u<f;u++){let m=s[u];if(!m||m.delay>0)continue;i=!0;let g=u==0?X.first:m.mixBlend,p=m.alpha;m.mixingFrom?p*=this.applyMixingFrom(m,e,g):m.trackTime>=m.trackEnd&&!m.next&&(p=0);let x=p>=m.alphaAttachmentThreshold,y=m.animationLast,b=m.getAnimationTime(),w=b,C=t;m.reverse&&(w=m.animation.duration-w,C=null);let v=m.animation.timelines,A=v.length;if(u==0&&p==1||g==X.add){u==0&&(x=!0);for(let I=0;I<A;I++){var n=v[I];n instanceof dt?this.applyAttachmentTimeline(n,e,w,g,x):n.apply(e,y,w,C,p,g,Ee.mixIn)}}else{let I=m.timelineMode,E=m.shortestRotation,F=!E&&m.timelinesRotation.length!=A<<1;F&&(m.timelinesRotation.length=A<<1);for(let Y=0;Y<A;Y++){let L=v[Y],B=I[Y]==Kt?g:X.setup;!E&&L instanceof Bt?this.applyRotateTimeline(L,e,w,p,B,m.timelinesRotation,Y<<1,F):L instanceof dt?this.applyAttachmentTimeline(L,e,w,g,x):L.apply(e,y,w,C,p,B,Ee.mixIn)}}this.queueEvents(m,b),t.length=0,m.nextAnimationLast=b,m.nextTrackLast=m.trackTime}for(var o=this.unkeyedState+ys,r=e.slots,c=0,a=e.slots.length;c<a;c++){var l=r[c];if(l.attachmentState==o){var h=l.data.attachmentName;l.setAttachment(h?e.getAttachment(l.data.index,h):null)}}return this.unkeyedState+=2,this.queue.drain(),i}applyMixingFrom(e,t,s){let i=e.mixingFrom;i.mixingFrom&&this.applyMixingFrom(i,t,s);let n=0;e.mixDuration==0?(n=1,s==X.first&&(s=X.setup)):(n=e.mixTime/e.mixDuration,n>1&&(n=1),s!=X.first&&(s=i.mixBlend));let o=n<i.mixAttachmentThreshold,r=n<i.mixDrawOrderThreshold,c=i.animation.timelines,a=c.length,l=i.alpha*e.interruptAlpha,h=l*(1-n),u=i.animationLast,f=i.getAnimationTime(),m=f,g=null;if(i.reverse?m=i.animation.duration-m:n<i.eventThreshold&&(g=this.events),s==X.add)for(let p=0;p<a;p++)c[p].apply(t,u,m,g,h,s,Ee.mixOut);else{let p=i.timelineMode,x=i.timelineHoldMix,y=i.shortestRotation,b=!y&&i.timelinesRotation.length!=a<<1;b&&(i.timelinesRotation.length=a<<1),i.totalAlpha=0;for(let w=0;w<a;w++){let C=c[w],v=Ee.mixOut,A,I=0;switch(p[w]){case Kt:if(!r&&C instanceof it)continue;A=s,I=h;break;case ws:A=X.setup,I=h;break;case bs:A=s,I=l;break;case Qt:A=X.setup,I=l;break;default:A=X.setup;let E=x[w];I=l*Math.max(0,1-E.mixTime/E.mixDuration);break}i.totalAlpha+=I,!y&&C instanceof Bt?this.applyRotateTimeline(C,t,m,I,A,i.timelinesRotation,w<<1,b):C instanceof dt?this.applyAttachmentTimeline(C,t,m,A,o&&I>=i.alphaAttachmentThreshold):(r&&C instanceof it&&A==X.setup&&(v=Ee.mixIn),C.apply(t,u,m,g,I,A,v))}}return e.mixDuration>0&&this.queueEvents(i,f),this.events.length=0,i.nextAnimationLast=f,i.nextTrackLast=i.trackTime,n}applyAttachmentTimeline(e,t,s,i,n){var o=t.slots[e.slotIndex];o.bone.active&&(s<e.frames[0]?(i==X.setup||i==X.first)&&this.setAttachment(t,o,o.data.attachmentName,n):this.setAttachment(t,o,e.attachmentNames[pe.search1(e.frames,s)],n),o.attachmentState<=this.unkeyedState&&(o.attachmentState=this.unkeyedState+ys))}setAttachment(e,t,s,i){t.setAttachment(s?e.getAttachment(t.data.index,s):null),i&&(t.attachmentState=this.unkeyedState+Bi)}applyRotateTimeline(e,t,s,i,n,o,r,c){if(c&&(o[r]=0),i==1){e.apply(t,0,s,null,1,n,Ee.mixIn);return}let a=t.bones[e.boneIndex];if(!a.active)return;let l=e.frames,h=0,u=0;if(s<l[0])switch(n){case X.setup:a.rotation=a.data.rotation;default:return;case X.first:h=a.rotation,u=a.data.rotation}else h=n==X.setup?a.data.rotation:a.rotation,u=a.data.rotation+e.getCurveValue(s);let f=0,m=u-h;if(m-=Math.ceil(m/360-.5)*360,m==0)f=o[r];else{let g=0,p=0;c?(g=0,p=m):(g=o[r],p=o[r+1]);let x=g-g%360;f=m+x;let y=m>=0,b=g>=0;Math.abs(p)<=90&&V.signum(p)!=V.signum(m)&&(Math.abs(g-x)>180?(f+=360*V.signum(g),b=y):x!=0?f-=360*V.signum(g):b=y),b!=y&&(f+=360*V.signum(g)),o[r]=f}o[r+1]=m,a.rotation=h+f*i}queueEvents(e,t){let s=e.animationStart,i=e.animationEnd,n=i-s,o=e.trackLast%n,r=this.events,c=0,a=r.length;for(;c<a;c++){let h=r[c];if(h.time<o)break;h.time>i||this.queue.event(e,h)}let l=!1;if(e.loop)if(n==0)l=!0;else{const h=Math.floor(e.trackTime/n);l=h>0&&h>Math.floor(e.trackLast/n)}else l=t>=i&&e.animationLast<i;for(l&&this.queue.complete(e);c<a;c++){let h=r[c];h.time<s||this.queue.event(e,h)}}clearTracks(){let e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let t=0,s=this.tracks.length;t<s;t++)this.clearTrack(t);this.tracks.length=0,this.queue.drainDisabled=e,this.queue.drain()}clearTrack(e){if(e>=this.tracks.length)return;let t=this.tracks[e];if(!t)return;this.queue.end(t),this.clearNext(t);let s=t;for(;;){let i=s.mixingFrom;if(!i)break;this.queue.end(i),s.mixingFrom=null,s.mixingTo=null,s=i}this.tracks[t.trackIndex]=null,this.queue.drain()}setCurrent(e,t,s){let i=this.expandToIndex(e);this.tracks[e]=t,t.previous=null,i&&(s&&this.queue.interrupt(i),t.mixingFrom=i,i.mixingTo=t,t.mixTime=0,i.mixingFrom&&i.mixDuration>0&&(t.interruptAlpha*=Math.min(1,i.mixTime/i.mixDuration)),i.timelinesRotation.length=0),this.queue.start(t)}setAnimation(e,t,s=!1){let i=this.data.skeletonData.findAnimation(t);if(!i)throw new Error("Animation not found: "+t);return this.setAnimationWith(e,i,s)}setAnimationWith(e,t,s=!1){if(!t)throw new Error("animation cannot be null.");let i=!0,n=this.expandToIndex(e);n&&(n.nextTrackLast==-1?(this.tracks[e]=n.mixingFrom,this.queue.interrupt(n),this.queue.end(n),this.clearNext(n),n=n.mixingFrom,i=!1):this.clearNext(n));let o=this.trackEntry(e,t,s,n);return this.setCurrent(e,o,i),this.queue.drain(),o}addAnimation(e,t,s=!1,i=0){let n=this.data.skeletonData.findAnimation(t);if(!n)throw new Error("Animation not found: "+t);return this.addAnimationWith(e,n,s,i)}addAnimationWith(e,t,s=!1,i=0){if(!t)throw new Error("animation cannot be null.");let n=this.expandToIndex(e);if(n)for(;n.next;)n=n.next;let o=this.trackEntry(e,t,s,n);return n?(n.next=o,o.previous=n,i<=0&&(i+=n.getTrackComplete()-o.mixDuration)):(this.setCurrent(e,o,!0),this.queue.drain()),o.delay=i,o}setEmptyAnimation(e,t=0){let s=this.setAnimationWith(e,mt.emptyAnimation(),!1);return s.mixDuration=t,s.trackEnd=t,s}addEmptyAnimation(e,t=0,s=0){let i=this.addAnimationWith(e,mt.emptyAnimation(),!1,s);return s<=0&&(i.delay+=i.mixDuration-t),i.mixDuration=t,i.trackEnd=t,i}setEmptyAnimations(e=0){let t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let s=0,i=this.tracks.length;s<i;s++){let n=this.tracks[s];n&&this.setEmptyAnimation(n.trackIndex,e)}this.queue.drainDisabled=t,this.queue.drain()}expandToIndex(e){return e<this.tracks.length?this.tracks[e]:(O.ensureArrayCapacity(this.tracks,e+1,null),this.tracks.length=e+1,null)}trackEntry(e,t,s,i){let n=this.trackEntryPool.obtain();return n.reset(),n.trackIndex=e,n.animation=t,n.loop=s,n.holdPrevious=!1,n.reverse=!1,n.shortestRotation=!1,n.eventThreshold=0,n.alphaAttachmentThreshold=0,n.mixAttachmentThreshold=0,n.mixDrawOrderThreshold=0,n.animationStart=0,n.animationEnd=t.duration,n.animationLast=-1,n.nextAnimationLast=-1,n.delay=0,n.trackTime=0,n.trackLast=-1,n.nextTrackLast=-1,n.trackEnd=Number.MAX_VALUE,n.timeScale=1,n.alpha=1,n.mixTime=0,n.mixDuration=i?this.data.getMix(i.animation,t):0,n.interruptAlpha=1,n.totalAlpha=0,n.mixBlend=X.replace,n}clearNext(e){let t=e.next;for(;t;)this.queue.dispose(t),t=t.next;e.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();let e=this.tracks;for(let t=0,s=e.length;t<s;t++){let i=e[t];if(i){for(;i.mixingFrom;)i=i.mixingFrom;do(!i.mixingTo||i.mixBlend!=X.add)&&this.computeHold(i),i=i.mixingTo;while(i)}}}computeHold(e){let t=e.mixingTo,s=e.animation.timelines,i=e.animation.timelines.length,n=e.timelineMode;n.length=i;let o=e.timelineHoldMix;o.length=0;let r=this.propertyIDs;if(t&&t.holdPrevious){for(let c=0;c<i;c++)n[c]=r.addAll(s[c].getPropertyIds())?Qt:bs;return}e:for(let c=0;c<i;c++){let a=s[c],l=a.getPropertyIds();if(!r.addAll(l))n[c]=Kt;else if(!t||a instanceof dt||a instanceof it||a instanceof It||!t.animation.hasTimeline(l))n[c]=ws;else{for(let h=t.mixingTo;h;h=h.mixingTo)if(!h.animation.hasTimeline(l)){if(e.mixDuration>0){n[c]=Xi,o[c]=h;continue e}break}n[c]=Qt}}}getCurrent(e){return e>=this.tracks.length?null:this.tracks[e]}addListener(e){if(!e)throw new Error("listener cannot be null.");this.listeners.push(e)}removeListener(e){let t=this.listeners.indexOf(e);t>=0&&this.listeners.splice(t,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}};d(mt,"_emptyAnimation",new cs("<empty>",[],0));let ss=mt;class Yi{constructor(){d(this,"animation",null);d(this,"previous",null);d(this,"next",null);d(this,"mixingFrom",null);d(this,"mixingTo",null);d(this,"listener",null);d(this,"trackIndex",0);d(this,"loop",!1);d(this,"holdPrevious",!1);d(this,"reverse",!1);d(this,"shortestRotation",!1);d(this,"eventThreshold",0);d(this,"mixAttachmentThreshold",0);d(this,"alphaAttachmentThreshold",0);d(this,"mixDrawOrderThreshold",0);d(this,"animationStart",0);d(this,"animationEnd",0);d(this,"animationLast",0);d(this,"nextAnimationLast",0);d(this,"delay",0);d(this,"trackTime",0);d(this,"trackLast",0);d(this,"nextTrackLast",0);d(this,"trackEnd",0);d(this,"timeScale",0);d(this,"alpha",0);d(this,"mixTime",0);d(this,"_mixDuration",0);d(this,"interruptAlpha",0);d(this,"totalAlpha",0);d(this,"mixBlend",X.replace);d(this,"timelineMode",new Array);d(this,"timelineHoldMix",new Array);d(this,"timelinesRotation",new Array)}get mixDuration(){return this._mixDuration}set mixDuration(e){this._mixDuration=e}setMixDurationWithDelta(e,t){this._mixDuration=e,this.previous!=null&&this.delay<=0&&(this.delay+=this.previous.getTrackComplete()-t),this.delay=this.delay}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let e=this.animationEnd-this.animationStart;return e==0?this.animationStart:this.trackTime%e+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(e){this.animationLast=e,this.nextAnimationLast=e}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){let e=this.animationEnd-this.animationStart;if(e!=0){if(this.loop)return e*(1+(this.trackTime/e|0));if(this.trackTime<e)return e}return this.trackTime}wasApplied(){return this.nextTrackLast!=-1}}class Li{constructor(e){d(this,"objects",[]);d(this,"drainDisabled",!1);d(this,"animState");this.animState=e}start(e){this.objects.push(Me.start),this.objects.push(e),this.animState.animationsChanged=!0}interrupt(e){this.objects.push(Me.interrupt),this.objects.push(e)}end(e){this.objects.push(Me.end),this.objects.push(e),this.animState.animationsChanged=!0}dispose(e){this.objects.push(Me.dispose),this.objects.push(e)}complete(e){this.objects.push(Me.complete),this.objects.push(e)}event(e,t){this.objects.push(Me.event),this.objects.push(e),this.objects.push(t)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let e=this.objects,t=this.animState.listeners;for(let s=0;s<e.length;s+=2){let i=e[s],n=e[s+1];switch(i){case Me.start:n.listener&&n.listener.start&&n.listener.start(n);for(let r=0;r<t.length;r++){let c=t[r];c.start&&c.start(n)}break;case Me.interrupt:n.listener&&n.listener.interrupt&&n.listener.interrupt(n);for(let r=0;r<t.length;r++){let c=t[r];c.interrupt&&c.interrupt(n)}break;case Me.end:n.listener&&n.listener.end&&n.listener.end(n);for(let r=0;r<t.length;r++){let c=t[r];c.end&&c.end(n)}case Me.dispose:n.listener&&n.listener.dispose&&n.listener.dispose(n);for(let r=0;r<t.length;r++){let c=t[r];c.dispose&&c.dispose(n)}this.animState.trackEntryPool.free(n);break;case Me.complete:n.listener&&n.listener.complete&&n.listener.complete(n);for(let r=0;r<t.length;r++){let c=t[r];c.complete&&c.complete(n)}break;case Me.event:let o=e[s+++2];n.listener&&n.listener.event&&n.listener.event(n,o);for(let r=0;r<t.length;r++){let c=t[r];c.event&&c.event(n,o)}break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}var Me;(function(S){S[S.start=0]="start",S[S.interrupt=1]="interrupt",S[S.end=2]="end",S[S.dispose=3]="dispose",S[S.complete=4]="complete",S[S.event=5]="event"})(Me||(Me={}));const Kt=0,ws=1,bs=2,Qt=3,Xi=4,ys=1,Bi=2;class Pi{constructor(e){d(this,"skeletonData");d(this,"animationToMixTime",{});d(this,"defaultMix",0);if(!e)throw new Error("skeletonData cannot be null.");this.skeletonData=e}setMix(e,t,s){let i=this.skeletonData.findAnimation(e);if(!i)throw new Error("Animation not found: "+e);let n=this.skeletonData.findAnimation(t);if(!n)throw new Error("Animation not found: "+t);this.setMixWith(i,n,s)}setMixWith(e,t,s){if(!e)throw new Error("from cannot be null.");if(!t)throw new Error("to cannot be null.");let i=e.name+"."+t.name;this.animationToMixTime[i]=s}getMix(e,t){let s=e.name+"."+t.name,i=this.animationToMixTime[s];return i===void 0?this.defaultMix:i}}class Gt extends De{constructor(t){super(t);d(this,"color",new N(1,1,1,1))}copy(){let t=new Gt(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}}class yt extends De{constructor(t){super(t);d(this,"endSlot",null);d(this,"color",new N(.2275,.2275,.8078,1))}copy(){let t=new yt(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}}class Vi{constructor(e){d(this,"_image");this._image=e}getImage(){return this._image}}var we;(function(S){S[S.Nearest=9728]="Nearest",S[S.Linear=9729]="Linear",S[S.MipMap=9987]="MipMap",S[S.MipMapNearestNearest=9984]="MipMapNearestNearest",S[S.MipMapLinearNearest=9985]="MipMapLinearNearest",S[S.MipMapNearestLinear=9986]="MipMapNearestLinear",S[S.MipMapLinearLinear=9987]="MipMapLinearLinear"})(we||(we={}));var pt;(function(S){S[S.MirroredRepeat=33648]="MirroredRepeat",S[S.ClampToEdge=33071]="ClampToEdge",S[S.Repeat=10497]="Repeat"})(pt||(pt={}));class Oi{constructor(){d(this,"texture");d(this,"u",0);d(this,"v",0);d(this,"u2",0);d(this,"v2",0);d(this,"width",0);d(this,"height",0);d(this,"degrees",0);d(this,"offsetX",0);d(this,"offsetY",0);d(this,"originalWidth",0);d(this,"originalHeight",0)}}class Ni{constructor(e){d(this,"pages",new Array);d(this,"regions",new Array);let t=new Di(e),s=new Array(4),i={};i.size=l=>{l.width=parseInt(s[1]),l.height=parseInt(s[2])},i.format=()=>{},i.filter=l=>{l.minFilter=O.enumValue(we,s[1]),l.magFilter=O.enumValue(we,s[2])},i.repeat=l=>{s[1].indexOf("x")!=-1&&(l.uWrap=pt.Repeat),s[1].indexOf("y")!=-1&&(l.vWrap=pt.Repeat)},i.pma=l=>{l.pma=s[1]=="true"};var n={};n.xy=l=>{l.x=parseInt(s[1]),l.y=parseInt(s[2])},n.size=l=>{l.width=parseInt(s[1]),l.height=parseInt(s[2])},n.bounds=l=>{l.x=parseInt(s[1]),l.y=parseInt(s[2]),l.width=parseInt(s[3]),l.height=parseInt(s[4])},n.offset=l=>{l.offsetX=parseInt(s[1]),l.offsetY=parseInt(s[2])},n.orig=l=>{l.originalWidth=parseInt(s[1]),l.originalHeight=parseInt(s[2])},n.offsets=l=>{l.offsetX=parseInt(s[1]),l.offsetY=parseInt(s[2]),l.originalWidth=parseInt(s[3]),l.originalHeight=parseInt(s[4])},n.rotate=l=>{let h=s[1];h=="true"?l.degrees=90:h!="false"&&(l.degrees=parseInt(h))},n.index=l=>{l.index=parseInt(s[1])};let o=t.readLine();for(;o&&o.trim().length==0;)o=t.readLine();for(;!(!o||o.trim().length==0||t.readEntry(s,o)==0);)o=t.readLine();let r=null,c=null,a=null;for(;o!==null;)if(o.trim().length==0)r=null,o=t.readLine();else if(r){let l=new di(r,o);for(;;){let h=t.readEntry(s,o=t.readLine());if(h==0)break;let u=n[s[0]];if(u)u(l);else{c||(c=[]),a||(a=[]),c.push(s[0]);let f=[];for(let m=0;m<h;m++)f.push(parseInt(s[m+1]));a.push(f)}}l.originalWidth==0&&l.originalHeight==0&&(l.originalWidth=l.width,l.originalHeight=l.height),c&&c.length>0&&a&&a.length>0&&(l.names=c,l.values=a,c=null,a=null),l.u=l.x/r.width,l.v=l.y/r.height,l.degrees==90?(l.u2=(l.x+l.height)/r.width,l.v2=(l.y+l.width)/r.height):(l.u2=(l.x+l.width)/r.width,l.v2=(l.y+l.height)/r.height),this.regions.push(l)}else{for(r=new Ui(o.trim());t.readEntry(s,o=t.readLine())!=0;){let l=i[s[0]];l&&l(r)}this.pages.push(r)}}findRegion(e){for(let t=0;t<this.regions.length;t++)if(this.regions[t].name==e)return this.regions[t];return null}setTextures(e,t=""){for(let s of this.pages)s.setTexture(e.get(t+s.name))}dispose(){var e;for(let t=0;t<this.pages.length;t++)(e=this.pages[t].texture)==null||e.dispose()}}class Di{constructor(e){d(this,"lines");d(this,"index",0);this.lines=e.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(e,t){if(!t||(t=t.trim(),t.length==0))return 0;let s=t.indexOf(":");if(s==-1)return 0;e[0]=t.substr(0,s).trim();for(let i=1,n=s+1;;i++){let o=t.indexOf(",",n);if(o==-1)return e[i]=t.substr(n).trim(),i;if(e[i]=t.substr(n,o-n).trim(),n=o+1,i==4)return 4}}}class Ui{constructor(e){d(this,"name");d(this,"minFilter",we.Nearest);d(this,"magFilter",we.Nearest);d(this,"uWrap",pt.ClampToEdge);d(this,"vWrap",pt.ClampToEdge);d(this,"texture",null);d(this,"width",0);d(this,"height",0);d(this,"pma",!1);d(this,"regions",new Array);this.name=e}setTexture(e){this.texture=e,e.setFilters(this.minFilter,this.magFilter),e.setWraps(this.uWrap,this.vWrap);for(let t of this.regions)t.texture=e}}class di extends Oi{constructor(t,s){super();d(this,"page");d(this,"name");d(this,"x",0);d(this,"y",0);d(this,"offsetX",0);d(this,"offsetY",0);d(this,"originalWidth",0);d(this,"originalHeight",0);d(this,"index",0);d(this,"degrees",0);d(this,"names",null);d(this,"values",null);this.page=t,this.name=s,t.regions.push(this)}}class tt extends De{constructor(t,s){super(t);d(this,"region",null);d(this,"path");d(this,"regionUVs",[]);d(this,"uvs",[]);d(this,"triangles",[]);d(this,"color",new N(1,1,1,1));d(this,"width",0);d(this,"height",0);d(this,"hullLength",0);d(this,"edges",[]);d(this,"parentMesh",null);d(this,"sequence",null);d(this,"tempColor",new N(0,0,0,0));this.path=s}updateRegion(){if(!this.region)throw new Error("Region not set.");let t=this.regionUVs;(!this.uvs||this.uvs.length!=t.length)&&(this.uvs=O.newFloatArray(t.length));let s=this.uvs,i=this.uvs.length,n=this.region.u,o=this.region.v,r=0,c=0;if(this.region instanceof di){let a=this.region,l=a.page,h=l.width,u=l.height;switch(a.degrees){case 90:n-=(a.originalHeight-a.offsetY-a.height)/h,o-=(a.originalWidth-a.offsetX-a.width)/u,r=a.originalHeight/h,c=a.originalWidth/u;for(let f=0;f<i;f+=2)s[f]=n+t[f+1]*r,s[f+1]=o+(1-t[f])*c;return;case 180:n-=(a.originalWidth-a.offsetX-a.width)/h,o-=a.offsetY/u,r=a.originalWidth/h,c=a.originalHeight/u;for(let f=0;f<i;f+=2)s[f]=n+(1-t[f])*r,s[f+1]=o+(1-t[f+1])*c;return;case 270:n-=a.offsetY/h,o-=a.offsetX/u,r=a.originalHeight/h,c=a.originalWidth/u;for(let f=0;f<i;f+=2)s[f]=n+(1-t[f+1])*r,s[f+1]=o+t[f]*c;return}n-=a.offsetX/h,o-=(a.originalHeight-a.offsetY-a.height)/u,r=a.originalWidth/h,c=a.originalHeight/u}else this.region?(r=this.region.u2-n,c=this.region.v2-o):(n=o=0,r=c=1);for(let a=0;a<i;a+=2)s[a]=n+t[a]*r,s[a+1]=o+t[a+1]*c}getParentMesh(){return this.parentMesh}setParentMesh(t){this.parentMesh=t,t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();let t=new tt(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Array(this.regionUVs.length),O.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.uvs=new Array(this.uvs.length),O.arrayCopy(this.uvs,0,t.uvs,0,this.uvs.length),t.triangles=new Array(this.triangles.length),O.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,t.sequence=this.sequence!=null?this.sequence.copy():null,this.edges&&(t.edges=new Array(this.edges.length),O.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}computeWorldVertices(t,s,i,n,o,r){this.sequence!=null&&this.sequence.apply(t,this),super.computeWorldVertices(t,s,i,n,o,r)}newLinkedMesh(){let t=new tt(this.name,this.path);return t.region=this.region,t.color.setFromColor(this.color),t.timelineAttachment=this.timelineAttachment,t.setParentMesh(this.parentMesh?this.parentMesh:this),t.region!=null&&t.updateRegion(),t}}class nt extends De{constructor(t){super(t);d(this,"lengths",[]);d(this,"closed",!1);d(this,"constantSpeed",!1);d(this,"color",new N(1,1,1,1))}copy(){let t=new nt(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),O.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}}class fs extends De{constructor(t){super(t);d(this,"x",0);d(this,"y",0);d(this,"rotation",0);d(this,"color",new N(.38,.94,0,1))}computeWorldPosition(t,s){return s.x=this.x*t.a+this.y*t.b+t.worldX,s.y=this.x*t.c+this.y*t.d+t.worldY,s}computeWorldRotation(t){const s=this.rotation*V.degRad,i=Math.cos(s),n=Math.sin(s),o=i*t.a+n*t.b,r=i*t.c+n*t.d;return V.atan2Deg(r,o)}copy(){let t=new fs(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}}const he=class he extends Bs{constructor(t,s){super(t);d(this,"x",0);d(this,"y",0);d(this,"scaleX",1);d(this,"scaleY",1);d(this,"rotation",0);d(this,"width",0);d(this,"height",0);d(this,"color",new N(1,1,1,1));d(this,"path");d(this,"region",null);d(this,"sequence",null);d(this,"offset",O.newFloatArray(8));d(this,"uvs",O.newFloatArray(8));d(this,"tempColor",new N(1,1,1,1));this.path=s}updateRegion(){if(!this.region)throw new Error("Region not set.");let t=this.region,s=this.uvs;if(t==null){s[0]=0,s[1]=0,s[2]=0,s[3]=1,s[4]=1,s[5]=1,s[6]=1,s[7]=0;return}let i=this.width/this.region.originalWidth*this.scaleX,n=this.height/this.region.originalHeight*this.scaleY,o=-this.width/2*this.scaleX+this.region.offsetX*i,r=-this.height/2*this.scaleY+this.region.offsetY*n,c=o+this.region.width*i,a=r+this.region.height*n,l=this.rotation*V.degRad,h=Math.cos(l),u=Math.sin(l),f=this.x,m=this.y,g=o*h+f,p=o*u,x=r*h+m,y=r*u,b=c*h+f,w=c*u,C=a*h+m,v=a*u,A=this.offset;A[0]=g-y,A[1]=x+p,A[2]=g-v,A[3]=C+p,A[4]=b-v,A[5]=C+w,A[6]=b-y,A[7]=x+w,t.degrees==90?(s[0]=t.u2,s[1]=t.v2,s[2]=t.u,s[3]=t.v2,s[4]=t.u,s[5]=t.v,s[6]=t.u2,s[7]=t.v):(s[0]=t.u,s[1]=t.v2,s[2]=t.u,s[3]=t.v,s[4]=t.u2,s[5]=t.v,s[6]=t.u2,s[7]=t.v2)}computeWorldVertices(t,s,i,n){this.sequence!=null&&this.sequence.apply(t,this);let o=t.bone,r=this.offset,c=o.worldX,a=o.worldY,l=o.a,h=o.b,u=o.c,f=o.d,m=0,g=0;m=r[0],g=r[1],s[i]=m*l+g*h+c,s[i+1]=m*u+g*f+a,i+=n,m=r[2],g=r[3],s[i]=m*l+g*h+c,s[i+1]=m*u+g*f+a,i+=n,m=r[4],g=r[5],s[i]=m*l+g*h+c,s[i+1]=m*u+g*f+a,i+=n,m=r[6],g=r[7],s[i]=m*l+g*h+c,s[i+1]=m*u+g*f+a}copy(){let t=new he(this.name,this.path);return t.region=this.region,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,O.arrayCopy(this.uvs,0,t.uvs,0,8),O.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t.sequence=this.sequence!=null?this.sequence.copy():null,t}};d(he,"X1",0),d(he,"Y1",1),d(he,"C1R",2),d(he,"C1G",3),d(he,"C1B",4),d(he,"C1A",5),d(he,"U1",6),d(he,"V1",7),d(he,"X2",8),d(he,"Y2",9),d(he,"C2R",10),d(he,"C2G",11),d(he,"C2B",12),d(he,"C2A",13),d(he,"U2",14),d(he,"V2",15),d(he,"X3",16),d(he,"Y3",17),d(he,"C3R",18),d(he,"C3G",19),d(he,"C3B",20),d(he,"C3A",21),d(he,"U3",22),d(he,"V3",23),d(he,"X4",24),d(he,"Y4",25),d(he,"C4R",26),d(he,"C4G",27),d(he,"C4B",28),d(he,"C4A",29),d(he,"U4",30),d(he,"V4",31);let xt=he;class zi{constructor(e){d(this,"atlas");this.atlas=e}loadSequence(e,t,s){let i=s.regions;for(let n=0,o=i.length;n<o;n++){let r=s.getPath(t,n),c=this.atlas.findRegion(r);if(c==null)throw new Error("Region not found in atlas: "+r+" (sequence: "+e+")");i[n]=c}}newRegionAttachment(e,t,s,i){let n=new xt(t,s);if(i!=null)this.loadSequence(t,s,i);else{let o=this.atlas.findRegion(s);if(!o)throw new Error("Region not found in atlas: "+s+" (region attachment: "+t+")");n.region=o}return n}newMeshAttachment(e,t,s,i){let n=new tt(t,s);if(i!=null)this.loadSequence(t,s,i);else{let o=this.atlas.findRegion(s);if(!o)throw new Error("Region not found in atlas: "+s+" (mesh attachment: "+t+")");n.region=o}return n}newBoundingBoxAttachment(e,t){return new Gt(t)}newPathAttachment(e,t){return new nt(t)}newPointAttachment(e,t){return new fs(t)}newClippingAttachment(e,t){return new yt(t)}}class fi{constructor(e,t,s){d(this,"index",0);d(this,"name");d(this,"parent",null);d(this,"length",0);d(this,"x",0);d(this,"y",0);d(this,"rotation",0);d(this,"scaleX",1);d(this,"scaleY",1);d(this,"shearX",0);d(this,"shearY",0);d(this,"inherit",xe.Normal);d(this,"skinRequired",!1);d(this,"color",new N);d(this,"icon");d(this,"visible",!1);if(e<0)throw new Error("index must be >= 0.");if(!t)throw new Error("name cannot be null.");this.index=e,this.name=t,this.parent=s}}var xe;(function(S){S[S.Normal=0]="Normal",S[S.OnlyTranslation=1]="OnlyTranslation",S[S.NoRotationOrReflection=2]="NoRotationOrReflection",S[S.NoScale=3]="NoScale",S[S.NoScaleOrReflection=4]="NoScaleOrReflection"})(xe||(xe={}));class vs{constructor(e,t,s){d(this,"data");d(this,"skeleton");d(this,"parent",null);d(this,"children",new Array);d(this,"x",0);d(this,"y",0);d(this,"rotation",0);d(this,"scaleX",0);d(this,"scaleY",0);d(this,"shearX",0);d(this,"shearY",0);d(this,"ax",0);d(this,"ay",0);d(this,"arotation",0);d(this,"ascaleX",0);d(this,"ascaleY",0);d(this,"ashearX",0);d(this,"ashearY",0);d(this,"a",0);d(this,"b",0);d(this,"c",0);d(this,"d",0);d(this,"worldY",0);d(this,"worldX",0);d(this,"inherit",xe.Normal);d(this,"sorted",!1);d(this,"active",!1);if(!e)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=e,this.skeleton=t,this.parent=s,this.setToSetupPose()}isActive(){return this.active}update(e){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(e,t,s,i,n,o,r){this.ax=e,this.ay=t,this.arotation=s,this.ascaleX=i,this.ascaleY=n,this.ashearX=o,this.ashearY=r;let c=this.parent;if(!c){let f=this.skeleton;const m=f.scaleX,g=f.scaleY,p=(s+o)*V.degRad,x=(s+90+r)*V.degRad;this.a=Math.cos(p)*i*m,this.b=Math.cos(x)*n*m,this.c=Math.sin(p)*i*g,this.d=Math.sin(x)*n*g,this.worldX=e*m+f.x,this.worldY=t*g+f.y;return}let a=c.a,l=c.b,h=c.c,u=c.d;switch(this.worldX=a*e+l*t+c.worldX,this.worldY=h*e+u*t+c.worldY,this.inherit){case xe.Normal:{const f=(s+o)*V.degRad,m=(s+90+r)*V.degRad,g=Math.cos(f)*i,p=Math.cos(m)*n,x=Math.sin(f)*i,y=Math.sin(m)*n;this.a=a*g+l*x,this.b=a*p+l*y,this.c=h*g+u*x,this.d=h*p+u*y;return}case xe.OnlyTranslation:{const f=(s+o)*V.degRad,m=(s+90+r)*V.degRad;this.a=Math.cos(f)*i,this.b=Math.cos(m)*n,this.c=Math.sin(f)*i,this.d=Math.sin(m)*n;break}case xe.NoRotationOrReflection:{let f=a*a+h*h,m=0;f>1e-4?(f=Math.abs(a*u-l*h)/f,a/=this.skeleton.scaleX,h/=this.skeleton.scaleY,l=h*f,u=a*f,m=Math.atan2(h,a)*V.radDeg):(a=0,h=0,m=90-Math.atan2(u,l)*V.radDeg);const g=(s+o-m)*V.degRad,p=(s+r-m+90)*V.degRad,x=Math.cos(g)*i,y=Math.cos(p)*n,b=Math.sin(g)*i,w=Math.sin(p)*n;this.a=a*x-l*b,this.b=a*y-l*w,this.c=h*x+u*b,this.d=h*y+u*w;break}case xe.NoScale:case xe.NoScaleOrReflection:{s*=V.degRad;const f=Math.cos(s),m=Math.sin(s);let g=(a*f+l*m)/this.skeleton.scaleX,p=(h*f+u*m)/this.skeleton.scaleY,x=Math.sqrt(g*g+p*p);x>1e-5&&(x=1/x),g*=x,p*=x,x=Math.sqrt(g*g+p*p),this.inherit==xe.NoScale&&a*u-l*h<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(x=-x),s=Math.PI/2+Math.atan2(p,g);const y=Math.cos(s)*x,b=Math.sin(s)*x;o*=V.degRad,r=(90+r)*V.degRad;const w=Math.cos(o)*i,C=Math.cos(r)*n,v=Math.sin(o)*i,A=Math.sin(r)*n;this.a=g*w+y*v,this.b=g*C+y*A,this.c=p*w+b*v,this.d=p*C+b*A;break}}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY}setToSetupPose(){let e=this.data;this.x=e.x,this.y=e.y,this.rotation=e.rotation,this.scaleX=e.scaleX,this.scaleY=e.scaleY,this.shearX=e.shearX,this.shearY=e.shearY,this.inherit=e.inherit}updateAppliedTransform(){let e=this.parent;if(!e){this.ax=this.worldX-this.skeleton.x,this.ay=this.worldY-this.skeleton.y,this.arotation=Math.atan2(this.c,this.a)*V.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*V.radDeg;return}let t=e.a,s=e.b,i=e.c,n=e.d,o=1/(t*n-s*i),r=n*o,c=s*o,a=i*o,l=t*o,h=this.worldX-e.worldX,u=this.worldY-e.worldY;this.ax=h*r-u*c,this.ay=u*l-h*a;let f,m,g,p;if(this.inherit==xe.OnlyTranslation)f=this.a,m=this.b,g=this.c,p=this.d;else{switch(this.inherit){case xe.NoRotationOrReflection:{let C=Math.abs(t*n-s*i)/(t*t+i*i),v=t/this.skeleton.scaleX;s=-(i/this.skeleton.scaleY)*C*this.skeleton.scaleX,n=v*C*this.skeleton.scaleY,o=1/(t*n-s*i),r=n*o,c=s*o;break}case xe.NoScale:case xe.NoScaleOrReflection:let x=V.cosDeg(this.rotation),y=V.sinDeg(this.rotation);t=(t*x+s*y)/this.skeleton.scaleX,i=(i*x+n*y)/this.skeleton.scaleY;let b=Math.sqrt(t*t+i*i);b>1e-5&&(b=1/b),t*=b,i*=b,b=Math.sqrt(t*t+i*i),this.inherit==xe.NoScale&&o<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(b=-b);let w=V.PI/2+Math.atan2(i,t);s=Math.cos(w)*b,n=Math.sin(w)*b,o=1/(t*n-s*i),r=n*o,c=s*o,a=i*o,l=t*o}f=r*this.a-c*this.c,m=r*this.b-c*this.d,g=l*this.c-a*this.a,p=l*this.d-a*this.b}if(this.ashearX=0,this.ascaleX=Math.sqrt(f*f+g*g),this.ascaleX>1e-4){let x=f*p-m*g;this.ascaleY=x/this.ascaleX,this.ashearY=-Math.atan2(f*m+g*p,x)*V.radDeg,this.arotation=Math.atan2(g,f)*V.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(m*m+p*p),this.ashearY=0,this.arotation=90-Math.atan2(p,m)*V.radDeg}getWorldRotationX(){return Math.atan2(this.c,this.a)*V.radDeg}getWorldRotationY(){return Math.atan2(this.d,this.b)*V.radDeg}getWorldScaleX(){return Math.sqrt(this.a*this.a+this.c*this.c)}getWorldScaleY(){return Math.sqrt(this.b*this.b+this.d*this.d)}worldToLocal(e){let t=1/(this.a*this.d-this.b*this.c),s=e.x-this.worldX,i=e.y-this.worldY;return e.x=s*this.d*t-i*this.b*t,e.y=i*this.a*t-s*this.c*t,e}localToWorld(e){let t=e.x,s=e.y;return e.x=t*this.a+s*this.b+this.worldX,e.y=t*this.c+s*this.d+this.worldY,e}worldToParent(e){if(e==null)throw new Error("world cannot be null.");return this.parent==null?e:this.parent.worldToLocal(e)}parentToWorld(e){if(e==null)throw new Error("world cannot be null.");return this.parent==null?e:this.parent.localToWorld(e)}worldToLocalRotation(e){let t=V.sinDeg(e),s=V.cosDeg(e);return Math.atan2(this.a*t-this.c*s,this.d*s-this.b*t)*V.radDeg+this.rotation-this.shearX}localToWorldRotation(e){e-=this.rotation-this.shearX;let t=V.sinDeg(e),s=V.cosDeg(e);return Math.atan2(s*this.c+t*this.d,s*this.a+t*this.b)*V.radDeg}rotateWorld(e){e*=V.degRad;const t=Math.sin(e),s=Math.cos(e),i=this.a,n=this.b;this.a=s*i-t*this.c,this.b=s*n-t*this.d,this.c=t*i+s*this.c,this.d=t*n+s*this.d}}class Ht{constructor(e,t,s){d(this,"name");d(this,"order");d(this,"skinRequired");this.name=e,this.order=t,this.skinRequired=s}}class Wi{constructor(e,t="",s=new ui){d(this,"pathPrefix","");d(this,"textureLoader");d(this,"downloader");d(this,"assets",{});d(this,"errors",{});d(this,"toLoad",0);d(this,"loaded",0);this.textureLoader=e,this.pathPrefix=t,this.downloader=s}start(e){return this.toLoad++,this.pathPrefix+e}success(e,t,s){this.toLoad--,this.loaded++,this.assets[t]=s,e&&e(t,s)}error(e,t,s){this.toLoad--,this.loaded++,this.errors[t]=s,e&&e(t,s)}loadAll(){return new Promise((t,s)=>{let i=()=>{if(this.isLoadingComplete()){this.hasErrors()?s(this.errors):t(this);return}requestAnimationFrame(i)};requestAnimationFrame(i)})}setRawDataURI(e,t){this.downloader.rawDataUris[this.pathPrefix+e]=t}loadBinary(e,t=()=>{},s=()=>{}){e=this.start(e),this.downloader.downloadBinary(e,i=>{this.success(t,e,i)},(i,n)=>{this.error(s,e,`Couldn't load binary ${e}: status ${i}, ${n}`)})}loadText(e,t=()=>{},s=()=>{}){e=this.start(e),this.downloader.downloadText(e,i=>{this.success(t,e,i)},(i,n)=>{this.error(s,e,`Couldn't load text ${e}: status ${i}, ${n}`)})}loadJson(e,t=()=>{},s=()=>{}){e=this.start(e),this.downloader.downloadJson(e,i=>{this.success(t,e,i)},(i,n)=>{this.error(s,e,`Couldn't load JSON ${e}: status ${i}, ${n}`)})}loadTexture(e,t=()=>{},s=()=>{}){if(e=this.start(e),!!!(typeof window<"u"&&typeof navigator<"u"&&window.document))fetch(e,{mode:"cors"}).then(o=>o.ok?o.blob():(this.error(s,e,`Couldn't load image: ${e}`),null)).then(o=>o?createImageBitmap(o,{premultiplyAlpha:"none",colorSpaceConversion:"none"}):null).then(o=>{o&&this.success(t,e,this.textureLoader(o))});else{let o=new Image;o.crossOrigin="anonymous",o.onload=()=>{this.success(t,e,this.textureLoader(o))},o.onerror=()=>{this.error(s,e,`Couldn't load image: ${e}`)},this.downloader.rawDataUris[e]&&(e=this.downloader.rawDataUris[e]),o.src=e}}loadTextureAtlas(e,t=()=>{},s=()=>{},i){let n=e.lastIndexOf("/"),o=n>=0?e.substring(0,n+1):"";e=this.start(e),this.downloader.downloadText(e,r=>{try{let c=new Ni(r),a=c.pages.length,l=!1;for(let h of c.pages)this.loadTexture(i?i[h.name]:o+h.name,(u,f)=>{l||(h.setTexture(f),--a==0&&this.success(t,e,c))},(u,f)=>{l||this.error(s,e,`Couldn't load texture atlas ${e} page image: ${u}`),l=!0})}catch(c){this.error(s,e,`Couldn't parse texture atlas ${e}: ${c.message}`)}},(r,c)=>{this.error(s,e,`Couldn't load texture atlas ${e}: status ${r}, ${c}`)})}get(e){return this.assets[this.pathPrefix+e]}require(e){e=this.pathPrefix+e;let t=this.assets[e];if(t)return t;let s=this.errors[e];throw Error("Asset not found: "+e+(s?`
`+s:""))}remove(e){e=this.pathPrefix+e;let t=this.assets[e];return t.dispose&&t.dispose(),delete this.assets[e],t}removeAll(){for(let e in this.assets){let t=this.assets[e];t.dispose&&t.dispose()}this.assets={}}isLoadingComplete(){return this.toLoad==0}getToLoad(){return this.toLoad}getLoaded(){return this.loaded}dispose(){this.removeAll()}hasErrors(){return Object.keys(this.errors).length>0}getErrors(){return this.errors}}class ui{constructor(){d(this,"callbacks",{});d(this,"rawDataUris",{})}dataUriToString(e){if(!e.startsWith("data:"))throw new Error("Not a data URI.");let t=e.indexOf("base64,");return t!=-1?(t+=7,atob(e.substr(t))):e.substr(e.indexOf(",")+1)}base64ToUint8Array(e){for(var t=window.atob(e),s=t.length,i=new Uint8Array(s),n=0;n<s;n++)i[n]=t.charCodeAt(n);return i}dataUriToUint8Array(e){if(!e.startsWith("data:"))throw new Error("Not a data URI.");let t=e.indexOf("base64,");if(t==-1)throw new Error("Not a binary data URI.");return t+=7,this.base64ToUint8Array(e.substr(t))}downloadText(e,t,s){if(this.start(e,t,s))return;if(this.rawDataUris[e]){try{let o=this.rawDataUris[e];this.finish(e,200,this.dataUriToString(o))}catch(o){this.finish(e,400,JSON.stringify(o))}return}let i=new XMLHttpRequest;i.overrideMimeType("text/html"),i.open("GET",e,!0);let n=()=>{this.finish(e,i.status,i.responseText)};i.onload=n,i.onerror=n,i.send()}downloadJson(e,t,s){this.downloadText(e,i=>{t(JSON.parse(i))},s)}downloadBinary(e,t,s){if(this.start(e,t,s))return;if(this.rawDataUris[e]){try{let o=this.rawDataUris[e];this.finish(e,200,this.dataUriToUint8Array(o))}catch(o){this.finish(e,400,JSON.stringify(o))}return}let i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer";let n=()=>{this.finish(e,i.status,i.response)};i.onload=()=>{i.status==200||i.status==0?this.finish(e,200,new Uint8Array(i.response)):n()},i.onerror=n,i.send()}start(e,t,s){let i=this.callbacks[e];try{if(i)return!0;this.callbacks[e]=i=[]}finally{i.push(t,s)}}finish(e,t,s){let i=this.callbacks[e];delete this.callbacks[e];let n=t==200||t==0?[s]:[t,s];for(let o=n.length-1,r=i.length;o<r;o+=2)i[o].apply(null,n)}}class mi{constructor(e,t){d(this,"data");d(this,"intValue",0);d(this,"floatValue",0);d(this,"stringValue",null);d(this,"time",0);d(this,"volume",0);d(this,"balance",0);if(!t)throw new Error("data cannot be null.");this.time=e,this.data=t}}class gi{constructor(e){d(this,"name");d(this,"intValue",0);d(this,"floatValue",0);d(this,"stringValue",null);d(this,"audioPath",null);d(this,"volume",0);d(this,"balance",0);this.name=e}}class qi{constructor(e,t){d(this,"data");d(this,"bones");d(this,"target");d(this,"bendDirection",0);d(this,"compress",!1);d(this,"stretch",!1);d(this,"mix",1);d(this,"softness",0);d(this,"active",!1);if(!e)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=e,this.bones=new Array;for(let i=0;i<e.bones.length;i++){let n=t.findBone(e.bones[i].name);if(!n)throw new Error(`Couldn't find bone ${e.bones[i].name}`);this.bones.push(n)}let s=t.findBone(e.target.name);if(!s)throw new Error(`Couldn't find bone ${e.target.name}`);this.target=s,this.mix=e.mix,this.softness=e.softness,this.bendDirection=e.bendDirection,this.compress=e.compress,this.stretch=e.stretch}isActive(){return this.active}setToSetupPose(){const e=this.data;this.mix=e.mix,this.softness=e.softness,this.bendDirection=e.bendDirection,this.compress=e.compress,this.stretch=e.stretch}update(e){if(this.mix==0)return;let t=this.target,s=this.bones;switch(s.length){case 1:this.apply1(s[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(s[0],s[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix);break}}apply1(e,t,s,i,n,o,r){let c=e.parent;if(!c)throw new Error("IK bone must have parent.");let a=c.a,l=c.b,h=c.c,u=c.d,f=-e.ashearX-e.arotation,m=0,g=0;switch(e.inherit){case xe.OnlyTranslation:m=(t-e.worldX)*V.signum(e.skeleton.scaleX),g=(s-e.worldY)*V.signum(e.skeleton.scaleY);break;case xe.NoRotationOrReflection:let y=Math.abs(a*u-l*h)/Math.max(1e-4,a*a+h*h),b=a/e.skeleton.scaleX,w=h/e.skeleton.scaleY;l=-w*y*e.skeleton.scaleX,u=b*y*e.skeleton.scaleY,f+=Math.atan2(w,b)*V.radDeg;default:let C=t-c.worldX,v=s-c.worldY,A=a*u-l*h;Math.abs(A)<=1e-4?(m=0,g=0):(m=(C*u-v*l)/A-e.ax,g=(v*a-C*h)/A-e.ay)}f+=Math.atan2(g,m)*V.radDeg,e.ascaleX<0&&(f+=180),f>180?f-=360:f<-180&&(f+=360);let p=e.ascaleX,x=e.ascaleY;if(i||n){switch(e.inherit){case xe.NoScale:case xe.NoScaleOrReflection:m=t-e.worldX,g=s-e.worldY}const y=e.data.length*p;if(y>1e-4){const b=m*m+g*g;if(i&&b<y*y||n&&b>y*y){const w=(Math.sqrt(b)/y-1)*r+1;p*=w,o&&(x*=w)}}}e.updateWorldTransformWith(e.ax,e.ay,e.arotation+f*r,p,x,e.ashearX,e.ashearY)}apply2(e,t,s,i,n,o,r,c,a){if(e.inherit!=xe.Normal||t.inherit!=xe.Normal)return;let l=e.ax,h=e.ay,u=e.ascaleX,f=e.ascaleY,m=u,g=f,p=t.ascaleX,x=0,y=0,b=0;u<0?(u=-u,x=180,b=-1):(x=0,b=1),f<0&&(f=-f,b=-b),p<0?(p=-p,y=180):y=0;let w=t.ax,C=0,v=0,A=0,I=e.a,E=e.b,F=e.c,Y=e.d,L=Math.abs(u-f)<=1e-4;!L||o?(C=0,v=I*w+e.worldX,A=F*w+e.worldY):(C=t.ay,v=I*w+E*C+e.worldX,A=F*w+Y*C+e.worldY);let B=e.parent;if(!B)throw new Error("IK parent must itself have a parent.");I=B.a,E=B.b,F=B.c,Y=B.d;let P=I*Y-E*F,R=v-B.worldX,M=A-B.worldY;P=Math.abs(P)<=1e-4?0:1/P;let D=(R*Y-M*E)*P-l,re=(M*I-R*F)*P-h,ie=Math.sqrt(D*D+re*re),fe=t.data.length*p,ge,me;if(ie<1e-4){this.apply1(e,s,i,!1,o,!1,a),t.updateWorldTransformWith(w,C,0,t.ascaleX,t.ascaleY,t.ashearX,t.ashearY);return}R=s-B.worldX,M=i-B.worldY;let le=(R*Y-M*E)*P-l,ne=(M*I-R*F)*P-h,ue=le*le+ne*ne;if(c!=0){c*=u*(p+1)*.5;let ve=Math.sqrt(ue),Le=ve-ie-fe*u+c;if(Le>0){let Xe=Math.min(1,Le/(c*2))-1;Xe=(Le-c*(1-Xe*Xe))/ve,le-=Xe*le,ne-=Xe*ne,ue=le*le+ne*ne}}e:if(L){fe*=u;let ve=(ue-ie*ie-fe*fe)/(2*ie*fe);ve<-1?(ve=-1,me=Math.PI*n):ve>1?(ve=1,me=0,o&&(I=(Math.sqrt(ue)/(ie+fe)-1)*a+1,m*=I,r&&(g*=I))):me=Math.acos(ve)*n,I=ie+fe*ve,E=fe*Math.sin(me),ge=Math.atan2(ne*I-le*E,le*I+ne*E)}else{I=u*fe,E=f*fe;let ve=I*I,Le=E*E,Xe=Math.atan2(ne,le);F=Le*ie*ie+ve*ue-ve*Le;let Qe=-2*Le*ie,lt=Le-ve;if(Y=Qe*Qe-4*lt*F,Y>=0){let ot=Math.sqrt(Y);Qe<0&&(ot=-ot),ot=-(Qe+ot)*.5;let ps=ot/lt,xs=F/ot,ht=Math.abs(ps)<Math.abs(xs)?ps:xs;if(ht*ht<=ue){M=Math.sqrt(ue-ht*ht)*n,ge=Xe-Math.atan2(M,ht),me=Math.atan2(M/f,(ht-ie)/u);break e}}let vt=V.PI,Tt=ie-I,Zt=Tt*Tt,us=0,ms=0,Mt=ie+I,Jt=Mt*Mt,gs=0;F=-I*ie/(ve-Le),F>=-1&&F<=1&&(F=Math.acos(F),R=I*Math.cos(F)+ie,M=E*Math.sin(F),Y=R*R+M*M,Y<Zt&&(vt=F,Zt=Y,Tt=R,us=M),Y>Jt&&(ms=F,Jt=Y,Mt=R,gs=M)),ue<=(Zt+Jt)*.5?(ge=Xe-Math.atan2(us*n,Tt),me=vt*n):(ge=Xe-Math.atan2(gs*n,Mt),me=ms*n)}let Se=Math.atan2(C,w)*b,Pe=e.arotation;ge=(ge-Se)*V.radDeg+x-Pe,ge>180?ge-=360:ge<-180&&(ge+=360),e.updateWorldTransformWith(l,h,Pe+ge*a,m,g,0,0),Pe=t.arotation,me=((me+Se)*V.radDeg-t.ashearX)*b+y-Pe,me>180?me-=360:me<-180&&(me+=360),t.updateWorldTransformWith(w,C,Pe+me*a,t.ascaleX,t.ascaleY,t.ashearX,t.ashearY)}}class pi extends Ht{constructor(t){super(t,0,!1);d(this,"bones",new Array);d(this,"_target",null);d(this,"bendDirection",0);d(this,"compress",!1);d(this,"stretch",!1);d(this,"uniform",!1);d(this,"mix",0);d(this,"softness",0)}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class xi extends Ht{constructor(t){super(t,0,!1);d(this,"bones",new Array);d(this,"_target",null);d(this,"positionMode",Ge.Fixed);d(this,"spacingMode",ye.Fixed);d(this,"rotateMode",rt.Chain);d(this,"offsetRotation",0);d(this,"position",0);d(this,"spacing",0);d(this,"mixRotate",0);d(this,"mixX",0);d(this,"mixY",0)}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}}var Ge;(function(S){S[S.Fixed=0]="Fixed",S[S.Percent=1]="Percent"})(Ge||(Ge={}));var ye;(function(S){S[S.Length=0]="Length",S[S.Fixed=1]="Fixed",S[S.Percent=2]="Percent",S[S.Proportional=3]="Proportional"})(ye||(ye={}));var rt;(function(S){S[S.Tangent=0]="Tangent",S[S.Chain=1]="Chain",S[S.ChainScale=2]="ChainScale"})(rt||(rt={}));const Ye=class Ye{constructor(e,t){d(this,"data");d(this,"bones");d(this,"target");d(this,"position",0);d(this,"spacing",0);d(this,"mixRotate",0);d(this,"mixX",0);d(this,"mixY",0);d(this,"spaces",new Array);d(this,"positions",new Array);d(this,"world",new Array);d(this,"curves",new Array);d(this,"lengths",new Array);d(this,"segments",new Array);d(this,"active",!1);if(!e)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=e,this.bones=new Array;for(let i=0,n=e.bones.length;i<n;i++){let o=t.findBone(e.bones[i].name);if(!o)throw new Error(`Couldn't find bone ${e.bones[i].name}.`);this.bones.push(o)}let s=t.findSlot(e.target.name);if(!s)throw new Error(`Couldn't find target bone ${e.target.name}`);this.target=s,this.position=e.position,this.spacing=e.spacing,this.mixRotate=e.mixRotate,this.mixX=e.mixX,this.mixY=e.mixY}isActive(){return this.active}setToSetupPose(){const e=this.data;this.position=e.position,this.spacing=e.spacing,this.mixRotate=e.mixRotate,this.mixX=e.mixX,this.mixY=e.mixY}update(e){let t=this.target.getAttachment();if(!(t instanceof nt))return;let s=this.mixRotate,i=this.mixX,n=this.mixY;if(s==0&&i==0&&n==0)return;let o=this.data,r=o.rotateMode==rt.Tangent,c=o.rotateMode==rt.ChainScale,a=this.bones,l=a.length,h=r?l:l+1,u=O.setArraySize(this.spaces,h),f=c?this.lengths=O.setArraySize(this.lengths,l):[],m=this.spacing;switch(o.spacingMode){case ye.Percent:if(c)for(let v=0,A=h-1;v<A;v++){let I=a[v],E=I.data.length,F=E*I.a,Y=E*I.c;f[v]=Math.sqrt(F*F+Y*Y)}O.arrayFill(u,1,h,m);break;case ye.Proportional:let w=0;for(let v=0,A=h-1;v<A;){let I=a[v],E=I.data.length;if(E<Ye.epsilon)c&&(f[v]=0),u[++v]=m;else{let F=E*I.a,Y=E*I.c,L=Math.sqrt(F*F+Y*Y);c&&(f[v]=L),u[++v]=L,w+=L}}if(w>0){w=h/w*m;for(let v=1;v<h;v++)u[v]*=w}break;default:let C=o.spacingMode==ye.Length;for(let v=0,A=h-1;v<A;){let I=a[v],E=I.data.length;if(E<Ye.epsilon)c&&(f[v]=0),u[++v]=m;else{let F=E*I.a,Y=E*I.c,L=Math.sqrt(F*F+Y*Y);c&&(f[v]=L),u[++v]=(C?E+m:m)*L/E}}}let g=this.computeWorldPositions(t,h,r),p=g[0],x=g[1],y=o.offsetRotation,b=!1;if(y==0)b=o.rotateMode==rt.Chain;else{b=!1;let w=this.target.bone;y*=w.a*w.d-w.b*w.c>0?V.degRad:-.01745329277777778}for(let w=0,C=3;w<l;w++,C+=3){let v=a[w];v.worldX+=(p-v.worldX)*i,v.worldY+=(x-v.worldY)*n;let A=g[C],I=g[C+1],E=A-p,F=I-x;if(c){let Y=f[w];if(Y!=0){let L=(Math.sqrt(E*E+F*F)/Y-1)*s+1;v.a*=L,v.c*=L}}if(p=A,x=I,s>0){let Y=v.a,L=v.b,B=v.c,P=v.d,R=0,M=0,D=0;if(r?R=g[C-1]:u[w+1]==0?R=g[C+2]:R=Math.atan2(F,E),R-=Math.atan2(B,Y),b){M=Math.cos(R),D=Math.sin(R);let re=v.data.length;p+=(re*(M*Y-D*B)-E)*s,x+=(re*(D*Y+M*B)-F)*s}else R+=y;R>V.PI?R-=V.PI2:R<-3.1415927&&(R+=V.PI2),R*=s,M=Math.cos(R),D=Math.sin(R),v.a=M*Y-D*B,v.b=M*L-D*P,v.c=D*Y+M*B,v.d=D*L+M*P}v.updateAppliedTransform()}}computeWorldPositions(e,t,s){let i=this.target,n=this.position,o=this.spaces,r=O.setArraySize(this.positions,t*3+2),c=this.world,a=e.closed,l=e.worldVerticesLength,h=l/6,u=Ye.NONE;if(!e.constantSpeed){let re=e.lengths;h-=a?1:2;let ie=re[h];this.data.positionMode==Ge.Percent&&(n*=ie);let fe;switch(this.data.spacingMode){case ye.Percent:fe=ie;break;case ye.Proportional:fe=ie/t;break;default:fe=1}c=O.setArraySize(this.world,8);for(let ge=0,me=0,le=0;ge<t;ge++,me+=3){let ne=o[ge]*fe;n+=ne;let ue=n;if(a)ue%=ie,ue<0&&(ue+=ie),le=0;else if(ue<0){u!=Ye.BEFORE&&(u=Ye.BEFORE,e.computeWorldVertices(i,2,4,c,0,2)),this.addBeforePosition(ue,c,0,r,me);continue}else if(ue>ie){u!=Ye.AFTER&&(u=Ye.AFTER,e.computeWorldVertices(i,l-6,4,c,0,2)),this.addAfterPosition(ue-ie,c,0,r,me);continue}for(;;le++){let Se=re[le];if(!(ue>Se)){if(le==0)ue/=Se;else{let Pe=re[le-1];ue=(ue-Pe)/(Se-Pe)}break}}le!=u&&(u=le,a&&le==h?(e.computeWorldVertices(i,l-4,4,c,0,2),e.computeWorldVertices(i,0,4,c,4,2)):e.computeWorldVertices(i,le*6+2,8,c,0,2)),this.addCurvePosition(ue,c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],r,me,s||ge>0&&ne==0)}return r}a?(l+=2,c=O.setArraySize(this.world,l),e.computeWorldVertices(i,2,l-4,c,0,2),e.computeWorldVertices(i,0,2,c,l-4,2),c[l-2]=c[0],c[l-1]=c[1]):(h--,l-=4,c=O.setArraySize(this.world,l),e.computeWorldVertices(i,2,l,c,0,2));let f=O.setArraySize(this.curves,h),m=0,g=c[0],p=c[1],x=0,y=0,b=0,w=0,C=0,v=0,A=0,I=0,E=0,F=0,Y=0,L=0,B=0,P=0;for(let re=0,ie=2;re<h;re++,ie+=6)x=c[ie],y=c[ie+1],b=c[ie+2],w=c[ie+3],C=c[ie+4],v=c[ie+5],A=(g-x*2+b)*.1875,I=(p-y*2+w)*.1875,E=((x-b)*3-g+C)*.09375,F=((y-w)*3-p+v)*.09375,Y=A*2+E,L=I*2+F,B=(x-g)*.75+A+E*.16666667,P=(y-p)*.75+I+F*.16666667,m+=Math.sqrt(B*B+P*P),B+=Y,P+=L,Y+=E,L+=F,m+=Math.sqrt(B*B+P*P),B+=Y,P+=L,m+=Math.sqrt(B*B+P*P),B+=Y+E,P+=L+F,m+=Math.sqrt(B*B+P*P),f[re]=m,g=C,p=v;this.data.positionMode==Ge.Percent&&(n*=m);let R;switch(this.data.spacingMode){case ye.Percent:R=m;break;case ye.Proportional:R=m/t;break;default:R=1}let M=this.segments,D=0;for(let re=0,ie=0,fe=0,ge=0;re<t;re++,ie+=3){let me=o[re]*R;n+=me;let le=n;if(a)le%=m,le<0&&(le+=m),fe=0;else if(le<0){this.addBeforePosition(le,c,0,r,ie);continue}else if(le>m){this.addAfterPosition(le-m,c,l-4,r,ie);continue}for(;;fe++){let ne=f[fe];if(!(le>ne)){if(fe==0)le/=ne;else{let ue=f[fe-1];le=(le-ue)/(ne-ue)}break}}if(fe!=u){u=fe;let ne=fe*6;for(g=c[ne],p=c[ne+1],x=c[ne+2],y=c[ne+3],b=c[ne+4],w=c[ne+5],C=c[ne+6],v=c[ne+7],A=(g-x*2+b)*.03,I=(p-y*2+w)*.03,E=((x-b)*3-g+C)*.006,F=((y-w)*3-p+v)*.006,Y=A*2+E,L=I*2+F,B=(x-g)*.3+A+E*.16666667,P=(y-p)*.3+I+F*.16666667,D=Math.sqrt(B*B+P*P),M[0]=D,ne=1;ne<8;ne++)B+=Y,P+=L,Y+=E,L+=F,D+=Math.sqrt(B*B+P*P),M[ne]=D;B+=Y,P+=L,D+=Math.sqrt(B*B+P*P),M[8]=D,B+=Y+E,P+=L+F,D+=Math.sqrt(B*B+P*P),M[9]=D,ge=0}for(le*=D;;ge++){let ne=M[ge];if(!(le>ne)){if(ge==0)le/=ne;else{let ue=M[ge-1];le=ge+(le-ue)/(ne-ue)}break}}this.addCurvePosition(le*.1,g,p,x,y,b,w,C,v,r,ie,s||re>0&&me==0)}return r}addBeforePosition(e,t,s,i,n){let o=t[s],r=t[s+1],c=t[s+2]-o,a=t[s+3]-r,l=Math.atan2(a,c);i[n]=o+e*Math.cos(l),i[n+1]=r+e*Math.sin(l),i[n+2]=l}addAfterPosition(e,t,s,i,n){let o=t[s+2],r=t[s+3],c=o-t[s],a=r-t[s+1],l=Math.atan2(a,c);i[n]=o+e*Math.cos(l),i[n+1]=r+e*Math.sin(l),i[n+2]=l}addCurvePosition(e,t,s,i,n,o,r,c,a,l,h,u){if(e==0||isNaN(e)){l[h]=t,l[h+1]=s,l[h+2]=Math.atan2(n-s,i-t);return}let f=e*e,m=f*e,g=1-e,p=g*g,x=p*g,y=g*e,b=y*3,w=g*b,C=b*e,v=t*x+i*w+o*C+c*m,A=s*x+n*w+r*C+a*m;l[h]=v,l[h+1]=A,u&&(e<.001?l[h+2]=Math.atan2(n-s,i-t):l[h+2]=Math.atan2(A-(s*p+n*y*2+r*f),v-(t*p+i*y*2+o*f)))}};d(Ye,"NONE",-1),d(Ye,"BEFORE",-2),d(Ye,"AFTER",-3),d(Ye,"epsilon",1e-5);let is=Ye;class Gi{constructor(e,t){d(this,"data");d(this,"_bone",null);d(this,"inertia",0);d(this,"strength",0);d(this,"damping",0);d(this,"massInverse",0);d(this,"wind",0);d(this,"gravity",0);d(this,"mix",0);d(this,"_reset",!0);d(this,"ux",0);d(this,"uy",0);d(this,"cx",0);d(this,"cy",0);d(this,"tx",0);d(this,"ty",0);d(this,"xOffset",0);d(this,"xVelocity",0);d(this,"yOffset",0);d(this,"yVelocity",0);d(this,"rotateOffset",0);d(this,"rotateVelocity",0);d(this,"scaleOffset",0);d(this,"scaleVelocity",0);d(this,"active",!1);d(this,"skeleton");d(this,"remaining",0);d(this,"lastTime",0);this.data=e,this.skeleton=t,this.bone=t.bones[e.bone.index],this.inertia=e.inertia,this.strength=e.strength,this.damping=e.damping,this.massInverse=e.massInverse,this.wind=e.wind,this.gravity=e.gravity,this.mix=e.mix}set bone(e){this._bone=e}get bone(){if(this._bone)return this._bone;throw new Error("Bone not set.")}reset(){this.remaining=0,this.lastTime=this.skeleton.time,this._reset=!0,this.xOffset=0,this.xVelocity=0,this.yOffset=0,this.yVelocity=0,this.rotateOffset=0,this.rotateVelocity=0,this.scaleOffset=0,this.scaleVelocity=0}setToSetupPose(){const e=this.data;this.inertia=e.inertia,this.strength=e.strength,this.damping=e.damping,this.massInverse=e.massInverse,this.wind=e.wind,this.gravity=e.gravity,this.mix=e.mix}isActive(){return this.active}update(e){const t=this.mix;if(t==0)return;const s=this.data.x>0,i=this.data.y>0,n=this.data.rotate>0||this.data.shearX>0,o=this.data.scaleX>0,r=this.bone,c=r.data.length;switch(e){case Oe.none:return;case Oe.reset:this.reset();case Oe.update:const a=Math.max(this.skeleton.time-this.lastTime,0);this.remaining+=a,this.lastTime=this.skeleton.time;const l=r.worldX,h=r.worldY;if(this._reset)this._reset=!1,this.ux=l,this.uy=h;else{let u=this.remaining,f=this.inertia,m=this.data.limit*a,g=this.data.step,p=this.skeleton.data.referenceScale,x=-1;if(s||i){if(s){const y=(this.ux-l)*f;this.xOffset+=y>m?m:y<-m?-m:y,this.ux=l}if(i){const y=(this.uy-h)*f;this.yOffset+=y>m?m:y<-m?-m:y,this.uy=h}if(u>=g){x=Math.pow(this.damping,60*g);const y=this.massInverse*g,b=this.strength,w=this.wind*p,C=this.gravity*p;do s&&(this.xVelocity+=(w-this.xOffset*b)*y,this.xOffset+=this.xVelocity*g,this.xVelocity*=x),i&&(this.yVelocity-=(C+this.yOffset*b)*y,this.yOffset+=this.yVelocity*g,this.yVelocity*=x),u-=g;while(u>=g)}s&&(r.worldX+=this.xOffset*t*this.data.x),i&&(r.worldY+=this.yOffset*t*this.data.y)}if(n||o){let y=Math.atan2(r.c,r.a),b=0,w=0,C=0,v=this.cx-r.worldX,A=this.cy-r.worldY;if(v>m?v=m:v<-m&&(v=-m),A>m?A=m:A<-m&&(A=-m),n){C=(this.data.rotate+this.data.shearX)*t;let I=Math.atan2(A+this.ty,v+this.tx)-y-this.rotateOffset*C;this.rotateOffset+=(I-Math.ceil(I*V.invPI2-.5)*V.PI2)*f,I=this.rotateOffset*C+y,b=Math.cos(I),w=Math.sin(I),o&&(I=c*r.getWorldScaleX(),I>0&&(this.scaleOffset+=(v*b+A*w)*f/I))}else{b=Math.cos(y),w=Math.sin(y);const I=c*r.getWorldScaleX();I>0&&(this.scaleOffset+=(v*b+A*w)*f/I)}if(u=this.remaining,u>=g){x==-1&&(x=Math.pow(this.damping,60*g));const I=this.massInverse*g,E=this.strength,F=this.wind,Y=this.gravity,L=c/p;for(;;)if(u-=g,o&&(this.scaleVelocity+=(F*b-Y*w-this.scaleOffset*E)*I,this.scaleOffset+=this.scaleVelocity*g,this.scaleVelocity*=x),n){if(this.rotateVelocity-=((F*w+Y*b)*L+this.rotateOffset*E)*I,this.rotateOffset+=this.rotateVelocity*g,this.rotateVelocity*=x,u<g)break;const B=this.rotateOffset*C+y;b=Math.cos(B),w=Math.sin(B)}else if(u<g)break}}this.remaining=u}this.cx=r.worldX,this.cy=r.worldY;break;case Oe.pose:s&&(r.worldX+=this.xOffset*t*this.data.x),i&&(r.worldY+=this.yOffset*t*this.data.y)}if(n){let a=this.rotateOffset*t,l=0,h=0,u=0;if(this.data.shearX>0){let f=0;this.data.rotate>0&&(f=a*this.data.rotate,l=Math.sin(f),h=Math.cos(f),u=r.b,r.b=h*u-l*r.d,r.d=l*u+h*r.d),f+=a*this.data.shearX,l=Math.sin(f),h=Math.cos(f),u=r.a,r.a=h*u-l*r.c,r.c=l*u+h*r.c}else a*=this.data.rotate,l=Math.sin(a),h=Math.cos(a),u=r.a,r.a=h*u-l*r.c,r.c=l*u+h*r.c,u=r.b,r.b=h*u-l*r.d,r.d=l*u+h*r.d}if(o){const a=1+this.scaleOffset*t*this.data.scaleX;r.a*=a,r.c*=a}e!=Oe.pose&&(this.tx=c*r.a,this.ty=c*r.c),r.updateAppliedTransform()}translate(e,t){this.ux-=e,this.uy-=t,this.cx-=e,this.cy-=t}rotate(e,t,s){const i=s*V.degRad,n=Math.cos(i),o=Math.sin(i),r=this.cx-e,c=this.cy-t;this.translate(r*n-c*o-r,r*o+c*n-c)}}class Hi{constructor(e,t){d(this,"data");d(this,"bone");d(this,"color");d(this,"darkColor",null);d(this,"attachment",null);d(this,"attachmentState",0);d(this,"sequenceIndex",-1);d(this,"deform",new Array);if(!e)throw new Error("data cannot be null.");if(!t)throw new Error("bone cannot be null.");this.data=e,this.bone=t,this.color=new N,this.darkColor=e.darkColor?new N:null,this.setToSetupPose()}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(e){this.attachment!=e&&((!(e instanceof De)||!(this.attachment instanceof De)||e.timelineAttachment!=this.attachment.timelineAttachment)&&(this.deform.length=0),this.attachment=e,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class ji{constructor(e,t){d(this,"data");d(this,"bones");d(this,"target");d(this,"mixRotate",0);d(this,"mixX",0);d(this,"mixY",0);d(this,"mixScaleX",0);d(this,"mixScaleY",0);d(this,"mixShearY",0);d(this,"temp",new qe);d(this,"active",!1);if(!e)throw new Error("data cannot be null.");if(!t)throw new Error("skeleton cannot be null.");this.data=e,this.bones=new Array;for(let i=0;i<e.bones.length;i++){let n=t.findBone(e.bones[i].name);if(!n)throw new Error(`Couldn't find bone ${e.bones[i].name}.`);this.bones.push(n)}let s=t.findBone(e.target.name);if(!s)throw new Error(`Couldn't find target bone ${e.target.name}.`);this.target=s,this.mixRotate=e.mixRotate,this.mixX=e.mixX,this.mixY=e.mixY,this.mixScaleX=e.mixScaleX,this.mixScaleY=e.mixScaleY,this.mixShearY=e.mixShearY}isActive(){return this.active}setToSetupPose(){const e=this.data;this.mixRotate=e.mixRotate,this.mixX=e.mixX,this.mixY=e.mixY,this.mixScaleX=e.mixScaleX,this.mixScaleY=e.mixScaleY,this.mixShearY=e.mixShearY}update(e){this.mixRotate==0&&this.mixX==0&&this.mixY==0&&this.mixScaleX==0&&this.mixScaleY==0&&this.mixShearY==0||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){let e=this.mixRotate,t=this.mixX,s=this.mixY,i=this.mixScaleX,n=this.mixScaleY,o=this.mixShearY,r=t!=0||s!=0,c=this.target,a=c.a,l=c.b,h=c.c,u=c.d,f=a*u-l*h>0?V.degRad:-.01745329277777778,m=this.data.offsetRotation*f,g=this.data.offsetShearY*f,p=this.bones;for(let x=0,y=p.length;x<y;x++){let b=p[x];if(e!=0){let w=b.a,C=b.b,v=b.c,A=b.d,I=Math.atan2(h,a)-Math.atan2(v,w)+m;I>V.PI?I-=V.PI2:I<-3.1415927&&(I+=V.PI2),I*=e;let E=Math.cos(I),F=Math.sin(I);b.a=E*w-F*v,b.b=E*C-F*A,b.c=F*w+E*v,b.d=F*C+E*A}if(r){let w=this.temp;c.localToWorld(w.set(this.data.offsetX,this.data.offsetY)),b.worldX+=(w.x-b.worldX)*t,b.worldY+=(w.y-b.worldY)*s}if(i!=0){let w=Math.sqrt(b.a*b.a+b.c*b.c);w!=0&&(w=(w+(Math.sqrt(a*a+h*h)-w+this.data.offsetScaleX)*i)/w),b.a*=w,b.c*=w}if(n!=0){let w=Math.sqrt(b.b*b.b+b.d*b.d);w!=0&&(w=(w+(Math.sqrt(l*l+u*u)-w+this.data.offsetScaleY)*n)/w),b.b*=w,b.d*=w}if(o>0){let w=b.b,C=b.d,v=Math.atan2(C,w),A=Math.atan2(u,l)-Math.atan2(h,a)-(v-Math.atan2(b.c,b.a));A>V.PI?A-=V.PI2:A<-3.1415927&&(A+=V.PI2),A=v+(A+g)*o;let I=Math.sqrt(w*w+C*C);b.b=Math.cos(A)*I,b.d=Math.sin(A)*I}b.updateAppliedTransform()}}applyRelativeWorld(){let e=this.mixRotate,t=this.mixX,s=this.mixY,i=this.mixScaleX,n=this.mixScaleY,o=this.mixShearY,r=t!=0||s!=0,c=this.target,a=c.a,l=c.b,h=c.c,u=c.d,f=a*u-l*h>0?V.degRad:-.01745329277777778,m=this.data.offsetRotation*f,g=this.data.offsetShearY*f,p=this.bones;for(let x=0,y=p.length;x<y;x++){let b=p[x];if(e!=0){let w=b.a,C=b.b,v=b.c,A=b.d,I=Math.atan2(h,a)+m;I>V.PI?I-=V.PI2:I<-3.1415927&&(I+=V.PI2),I*=e;let E=Math.cos(I),F=Math.sin(I);b.a=E*w-F*v,b.b=E*C-F*A,b.c=F*w+E*v,b.d=F*C+E*A}if(r){let w=this.temp;c.localToWorld(w.set(this.data.offsetX,this.data.offsetY)),b.worldX+=w.x*t,b.worldY+=w.y*s}if(i!=0){let w=(Math.sqrt(a*a+h*h)-1+this.data.offsetScaleX)*i+1;b.a*=w,b.c*=w}if(n!=0){let w=(Math.sqrt(l*l+u*u)-1+this.data.offsetScaleY)*n+1;b.b*=w,b.d*=w}if(o>0){let w=Math.atan2(u,l)-Math.atan2(h,a);w>V.PI?w-=V.PI2:w<-3.1415927&&(w+=V.PI2);let C=b.b,v=b.d;w=Math.atan2(v,C)+(w-V.PI/2+g)*o;let A=Math.sqrt(C*C+v*v);b.b=Math.cos(w)*A,b.d=Math.sin(w)*A}b.updateAppliedTransform()}}applyAbsoluteLocal(){let e=this.mixRotate,t=this.mixX,s=this.mixY,i=this.mixScaleX,n=this.mixScaleY,o=this.mixShearY,r=this.target,c=this.bones;for(let a=0,l=c.length;a<l;a++){let h=c[a],u=h.arotation;e!=0&&(u+=(r.arotation-u+this.data.offsetRotation)*e);let f=h.ax,m=h.ay;f+=(r.ax-f+this.data.offsetX)*t,m+=(r.ay-m+this.data.offsetY)*s;let g=h.ascaleX,p=h.ascaleY;i!=0&&g!=0&&(g=(g+(r.ascaleX-g+this.data.offsetScaleX)*i)/g),n!=0&&p!=0&&(p=(p+(r.ascaleY-p+this.data.offsetScaleY)*n)/p);let x=h.ashearY;o!=0&&(x+=(r.ashearY-x+this.data.offsetShearY)*o),h.updateWorldTransformWith(f,m,u,g,p,h.ashearX,x)}}applyRelativeLocal(){let e=this.mixRotate,t=this.mixX,s=this.mixY,i=this.mixScaleX,n=this.mixScaleY,o=this.mixShearY,r=this.target,c=this.bones;for(let a=0,l=c.length;a<l;a++){let h=c[a],u=h.arotation+(r.arotation+this.data.offsetRotation)*e,f=h.ax+(r.ax+this.data.offsetX)*t,m=h.ay+(r.ay+this.data.offsetY)*s,g=h.ascaleX*((r.ascaleX-1+this.data.offsetScaleX)*i+1),p=h.ascaleY*((r.ascaleY-1+this.data.offsetScaleY)*n+1),x=h.ashearY+(r.ashearY+this.data.offsetShearY)*o;h.updateWorldTransformWith(f,m,u,g,p,h.ashearX,x)}}}const St=class St{constructor(e){d(this,"data");d(this,"bones");d(this,"slots");d(this,"drawOrder");d(this,"ikConstraints");d(this,"transformConstraints");d(this,"pathConstraints");d(this,"physicsConstraints");d(this,"_updateCache",new Array);d(this,"skin",null);d(this,"color");d(this,"scaleX",1);d(this,"_scaleY",1);d(this,"x",0);d(this,"y",0);d(this,"time",0);if(!e)throw new Error("data cannot be null.");this.data=e,this.bones=new Array;for(let t=0;t<e.bones.length;t++){let s=e.bones[t],i;if(!s.parent)i=new vs(s,this,null);else{let n=this.bones[s.parent.index];i=new vs(s,this,n),n.children.push(i)}this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(let t=0;t<e.slots.length;t++){let s=e.slots[t],i=this.bones[s.boneData.index],n=new Hi(s,i);this.slots.push(n),this.drawOrder.push(n)}this.ikConstraints=new Array;for(let t=0;t<e.ikConstraints.length;t++){let s=e.ikConstraints[t];this.ikConstraints.push(new qi(s,this))}this.transformConstraints=new Array;for(let t=0;t<e.transformConstraints.length;t++){let s=e.transformConstraints[t];this.transformConstraints.push(new ji(s,this))}this.pathConstraints=new Array;for(let t=0;t<e.pathConstraints.length;t++){let s=e.pathConstraints[t];this.pathConstraints.push(new is(s,this))}this.physicsConstraints=new Array;for(let t=0;t<e.physicsConstraints.length;t++){let s=e.physicsConstraints[t];this.physicsConstraints.push(new Gi(s,this))}this.color=new N(1,1,1,1),this.updateCache()}get scaleY(){return this._scaleY}set scaleY(e){this._scaleY=e}updateCache(){let e=this._updateCache;e.length=0;let t=this.bones;for(let u=0,f=t.length;u<f;u++){let m=t[u];m.sorted=m.data.skinRequired,m.active=!m.sorted}if(this.skin){let u=this.skin.bones;for(let f=0,m=this.skin.bones.length;f<m;f++){let g=this.bones[u[f].index];do g.sorted=!1,g.active=!0,g=g.parent;while(g)}}let s=this.ikConstraints,i=this.transformConstraints,n=this.pathConstraints,o=this.physicsConstraints,r=s.length,c=i.length,a=n.length,l=this.physicsConstraints.length,h=r+c+a+l;e:for(let u=0;u<h;u++){for(let f=0;f<r;f++){let m=s[f];if(m.data.order==u){this.sortIkConstraint(m);continue e}}for(let f=0;f<c;f++){let m=i[f];if(m.data.order==u){this.sortTransformConstraint(m);continue e}}for(let f=0;f<a;f++){let m=n[f];if(m.data.order==u){this.sortPathConstraint(m);continue e}}for(let f=0;f<l;f++){const m=o[f];if(m.data.order==u){this.sortPhysicsConstraint(m);continue e}}}for(let u=0,f=t.length;u<f;u++)this.sortBone(t[u])}sortIkConstraint(e){if(e.active=e.target.isActive()&&(!e.data.skinRequired||this.skin&&O.contains(this.skin.constraints,e.data,!0)),!e.active)return;let t=e.target;this.sortBone(t);let s=e.bones,i=s[0];if(this.sortBone(i),s.length==1)this._updateCache.push(e),this.sortReset(i.children);else{let n=s[s.length-1];this.sortBone(n),this._updateCache.push(e),this.sortReset(i.children),n.sorted=!0}}sortPathConstraint(e){if(e.active=e.target.bone.isActive()&&(!e.data.skinRequired||this.skin&&O.contains(this.skin.constraints,e.data,!0)),!e.active)return;let t=e.target,s=t.data.index,i=t.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,s,i),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,s,i);for(let c=0,a=this.data.skins.length;c<a;c++)this.sortPathConstraintAttachment(this.data.skins[c],s,i);let n=t.getAttachment();n instanceof nt&&this.sortPathConstraintAttachmentWith(n,i);let o=e.bones,r=o.length;for(let c=0;c<r;c++)this.sortBone(o[c]);this._updateCache.push(e);for(let c=0;c<r;c++)this.sortReset(o[c].children);for(let c=0;c<r;c++)o[c].sorted=!0}sortTransformConstraint(e){if(e.active=e.target.isActive()&&(!e.data.skinRequired||this.skin&&O.contains(this.skin.constraints,e.data,!0)),!e.active)return;this.sortBone(e.target);let t=e.bones,s=t.length;if(e.data.local)for(let i=0;i<s;i++){let n=t[i];this.sortBone(n.parent),this.sortBone(n)}else for(let i=0;i<s;i++)this.sortBone(t[i]);this._updateCache.push(e);for(let i=0;i<s;i++)this.sortReset(t[i].children);for(let i=0;i<s;i++)t[i].sorted=!0}sortPathConstraintAttachment(e,t,s){let i=e.attachments[t];if(i)for(let n in i)this.sortPathConstraintAttachmentWith(i[n],s)}sortPathConstraintAttachmentWith(e,t){if(!(e instanceof nt))return;let s=e.bones;if(!s)this.sortBone(t);else{let i=this.bones;for(let n=0,o=s.length;n<o;){let r=s[n++];for(r+=n;n<r;)this.sortBone(i[s[n++]])}}}sortPhysicsConstraint(e){const t=e.bone;e.active=t.active&&(!e.data.skinRequired||this.skin!=null&&O.contains(this.skin.constraints,e.data,!0)),e.active&&(this.sortBone(t),this._updateCache.push(e),this.sortReset(t.children),t.sorted=!0)}sortBone(e){if(!e||e.sorted)return;let t=e.parent;t&&this.sortBone(t),e.sorted=!0,this._updateCache.push(e)}sortReset(e){for(let t=0,s=e.length;t<s;t++){let i=e[t];i.active&&(i.sorted&&this.sortReset(i.children),i.sorted=!1)}}updateWorldTransform(e){if(!e)throw new Error("physics is undefined");let t=this.bones;for(let i=0,n=t.length;i<n;i++){let o=t[i];o.ax=o.x,o.ay=o.y,o.arotation=o.rotation,o.ascaleX=o.scaleX,o.ascaleY=o.scaleY,o.ashearX=o.shearX,o.ashearY=o.shearY}let s=this._updateCache;for(let i=0,n=s.length;i<n;i++)s[i].update(e)}updateWorldTransformWith(e,t){let s=this.getRootBone();if(!s)throw new Error("Root bone must not be null.");let i=t.a,n=t.b,o=t.c,r=t.d;s.worldX=i*this.x+n*this.y+t.worldX,s.worldY=o*this.x+r*this.y+t.worldY;const c=(s.rotation+s.shearX)*V.degRad,a=(s.rotation+90+s.shearY)*V.degRad,l=Math.cos(c)*s.scaleX,h=Math.cos(a)*s.scaleY,u=Math.sin(c)*s.scaleX,f=Math.sin(a)*s.scaleY;s.a=(i*l+n*u)*this.scaleX,s.b=(i*h+n*f)*this.scaleX,s.c=(o*l+r*u)*this.scaleY,s.d=(o*h+r*f)*this.scaleY;let m=this._updateCache;for(let g=0,p=m.length;g<p;g++){let x=m[g];x!=s&&x.update(e)}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){for(const e of this.bones)e.setToSetupPose();for(const e of this.ikConstraints)e.setToSetupPose();for(const e of this.transformConstraints)e.setToSetupPose();for(const e of this.pathConstraints)e.setToSetupPose();for(const e of this.physicsConstraints)e.setToSetupPose()}setSlotsToSetupPose(){let e=this.slots;O.arrayCopy(e,0,this.drawOrder,0,e.length);for(let t=0,s=e.length;t<s;t++)e[t].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(e){if(!e)throw new Error("boneName cannot be null.");let t=this.bones;for(let s=0,i=t.length;s<i;s++){let n=t[s];if(n.data.name==e)return n}return null}findSlot(e){if(!e)throw new Error("slotName cannot be null.");let t=this.slots;for(let s=0,i=t.length;s<i;s++){let n=t[s];if(n.data.name==e)return n}return null}setSkinByName(e){let t=this.data.findSkin(e);if(!t)throw new Error("Skin not found: "+e);this.setSkin(t)}setSkin(e){if(e!=this.skin){if(e)if(this.skin)e.attachAll(this,this.skin);else{let t=this.slots;for(let s=0,i=t.length;s<i;s++){let n=t[s],o=n.data.attachmentName;if(o){let r=e.getAttachment(s,o);r&&n.setAttachment(r)}}}this.skin=e,this.updateCache()}}getAttachmentByName(e,t){let s=this.data.findSlot(e);if(!s)throw new Error(`Can't find slot with name ${e}`);return this.getAttachment(s.index,t)}getAttachment(e,t){if(!t)throw new Error("attachmentName cannot be null.");if(this.skin){let s=this.skin.getAttachment(e,t);if(s)return s}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(e,t):null}setAttachment(e,t){if(!e)throw new Error("slotName cannot be null.");let s=this.slots;for(let i=0,n=s.length;i<n;i++){let o=s[i];if(o.data.name==e){let r=null;if(t&&(r=this.getAttachment(i,t),!r))throw new Error("Attachment not found: "+t+", for slot: "+e);o.setAttachment(r);return}}throw new Error("Slot not found: "+e)}findIkConstraint(e){if(!e)throw new Error("constraintName cannot be null.");return this.ikConstraints.find(t=>t.data.name==e)??null}findTransformConstraint(e){if(!e)throw new Error("constraintName cannot be null.");return this.transformConstraints.find(t=>t.data.name==e)??null}findPathConstraint(e){if(!e)throw new Error("constraintName cannot be null.");return this.pathConstraints.find(t=>t.data.name==e)??null}findPhysicsConstraint(e){if(e==null)throw new Error("constraintName cannot be null.");return this.physicsConstraints.find(t=>t.data.name==e)??null}getBoundsRect(){let e=new qe,t=new qe;return this.getBounds(e,t),{x:e.x,y:e.y,width:t.x,height:t.y}}getBounds(e,t,s=new Array(2),i=null){if(!e)throw new Error("offset cannot be null.");if(!t)throw new Error("size cannot be null.");let n=this.drawOrder,o=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY;for(let l=0,h=n.length;l<h;l++){let u=n[l];if(!u.bone.active)continue;let f=0,m=null,g=null,p=u.getAttachment();if(p instanceof xt)f=8,m=O.setArraySize(s,f,0),p.computeWorldVertices(u,m,0,2),g=St.quadTriangles;else if(p instanceof tt){let x=p;f=x.worldVerticesLength,m=O.setArraySize(s,f,0),x.computeWorldVertices(u,0,f,m,0,2),g=x.triangles}else if(p instanceof yt&&i!=null){i.clipStart(u,p);continue}if(m&&g){i!=null&&i.isClipping()&&(i.clipTriangles(m,f,g,g.length),m=i.clippedVertices,f=i.clippedVertices.length);for(let x=0,y=m.length;x<y;x+=2){let b=m[x],w=m[x+1];o=Math.min(o,b),r=Math.min(r,w),c=Math.max(c,b),a=Math.max(a,w)}}i!=null&&i.clipEndWithSlot(u)}i!=null&&i.clipEnd(),e.set(o,r),t.set(c-o,a-r)}update(e){this.time+=e}physicsTranslate(e,t){const s=this.physicsConstraints;for(let i=0,n=s.length;i<n;i++)s[i].translate(e,t)}physicsRotate(e,t,s){const i=this.physicsConstraints;for(let n=0,o=i.length;n<o;n++)i[n].rotate(e,t,s)}};d(St,"quadTriangles",[0,1,2,2,3,0]),d(St,"yDown",!1);let rs=St;var Oe;(function(S){S[S.none=0]="none",S[S.reset=1]="reset",S[S.update=2]="update",S[S.pose=3]="pose"})(Oe||(Oe={}));class wi extends Ht{constructor(t){super(t,0,!1);d(this,"_bone",null);d(this,"x",0);d(this,"y",0);d(this,"rotate",0);d(this,"scaleX",0);d(this,"shearX",0);d(this,"limit",0);d(this,"step",0);d(this,"inertia",0);d(this,"strength",0);d(this,"damping",0);d(this,"massInverse",0);d(this,"wind",0);d(this,"gravity",0);d(this,"mix",0);d(this,"inertiaGlobal",!1);d(this,"strengthGlobal",!1);d(this,"dampingGlobal",!1);d(this,"massGlobal",!1);d(this,"windGlobal",!1);d(this,"gravityGlobal",!1);d(this,"mixGlobal",!1)}set bone(t){this._bone=t}get bone(){if(this._bone)return this._bone;throw new Error("BoneData not set.")}}class bi{constructor(){d(this,"name",null);d(this,"bones",new Array);d(this,"slots",new Array);d(this,"skins",new Array);d(this,"defaultSkin",null);d(this,"events",new Array);d(this,"animations",new Array);d(this,"ikConstraints",new Array);d(this,"transformConstraints",new Array);d(this,"pathConstraints",new Array);d(this,"physicsConstraints",new Array);d(this,"x",0);d(this,"y",0);d(this,"width",0);d(this,"height",0);d(this,"referenceScale",100);d(this,"version",null);d(this,"hash",null);d(this,"fps",0);d(this,"imagesPath",null);d(this,"audioPath",null)}findBone(e){if(!e)throw new Error("boneName cannot be null.");let t=this.bones;for(let s=0,i=t.length;s<i;s++){let n=t[s];if(n.name==e)return n}return null}findSlot(e){if(!e)throw new Error("slotName cannot be null.");let t=this.slots;for(let s=0,i=t.length;s<i;s++){let n=t[s];if(n.name==e)return n}return null}findSkin(e){if(!e)throw new Error("skinName cannot be null.");let t=this.skins;for(let s=0,i=t.length;s<i;s++){let n=t[s];if(n.name==e)return n}return null}findEvent(e){if(!e)throw new Error("eventDataName cannot be null.");let t=this.events;for(let s=0,i=t.length;s<i;s++){let n=t[s];if(n.name==e)return n}return null}findAnimation(e){if(!e)throw new Error("animationName cannot be null.");let t=this.animations;for(let s=0,i=t.length;s<i;s++){let n=t[s];if(n.name==e)return n}return null}findIkConstraint(e){if(!e)throw new Error("constraintName cannot be null.");const t=this.ikConstraints;for(let s=0,i=t.length;s<i;s++){const n=t[s];if(n.name==e)return n}return null}findTransformConstraint(e){if(!e)throw new Error("constraintName cannot be null.");const t=this.transformConstraints;for(let s=0,i=t.length;s<i;s++){const n=t[s];if(n.name==e)return n}return null}findPathConstraint(e){if(!e)throw new Error("constraintName cannot be null.");const t=this.pathConstraints;for(let s=0,i=t.length;s<i;s++){const n=t[s];if(n.name==e)return n}return null}findPhysicsConstraint(e){if(!e)throw new Error("constraintName cannot be null.");const t=this.physicsConstraints;for(let s=0,i=t.length;s<i;s++){const n=t[s];if(n.name==e)return n}return null}}class Cs{constructor(e=0,t,s){d(this,"slotIndex");d(this,"name");d(this,"attachment");this.slotIndex=e,this.name=t,this.attachment=s}}class ns{constructor(e){d(this,"name");d(this,"attachments",new Array);d(this,"bones",Array());d(this,"constraints",new Array);d(this,"color",new N(.99607843,.61960787,.30980393,1));if(!e)throw new Error("name cannot be null.");this.name=e}setAttachment(e,t,s){if(!s)throw new Error("attachment cannot be null.");let i=this.attachments;e>=i.length&&(i.length=e+1),i[e]||(i[e]={}),i[e][t]=s}addSkin(e){for(let i=0;i<e.bones.length;i++){let n=e.bones[i],o=!1;for(let r=0;r<this.bones.length;r++)if(this.bones[r]==n){o=!0;break}o||this.bones.push(n)}for(let i=0;i<e.constraints.length;i++){let n=e.constraints[i],o=!1;for(let r=0;r<this.constraints.length;r++)if(this.constraints[r]==n){o=!0;break}o||this.constraints.push(n)}let t=e.getAttachments();for(let i=0;i<t.length;i++){var s=t[i];this.setAttachment(s.slotIndex,s.name,s.attachment)}}copySkin(e){for(let i=0;i<e.bones.length;i++){let n=e.bones[i],o=!1;for(let r=0;r<this.bones.length;r++)if(this.bones[r]==n){o=!0;break}o||this.bones.push(n)}for(let i=0;i<e.constraints.length;i++){let n=e.constraints[i],o=!1;for(let r=0;r<this.constraints.length;r++)if(this.constraints[r]==n){o=!0;break}o||this.constraints.push(n)}let t=e.getAttachments();for(let i=0;i<t.length;i++){var s=t[i];s.attachment&&(s.attachment instanceof tt?(s.attachment=s.attachment.newLinkedMesh(),this.setAttachment(s.slotIndex,s.name,s.attachment)):(s.attachment=s.attachment.copy(),this.setAttachment(s.slotIndex,s.name,s.attachment)))}}getAttachment(e,t){let s=this.attachments[e];return s?s[t]:null}removeAttachment(e,t){let s=this.attachments[e];s&&delete s[t]}getAttachments(){let e=new Array;for(var t=0;t<this.attachments.length;t++){let s=this.attachments[t];if(s)for(let i in s){let n=s[i];n&&e.push(new Cs(t,i,n))}}return e}getAttachmentsForSlot(e,t){let s=this.attachments[e];if(s)for(let i in s){let n=s[i];n&&t.push(new Cs(e,i,n))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(e,t){let s=0;for(let i=0;i<e.slots.length;i++){let n=e.slots[i],o=n.getAttachment();if(o&&s<t.attachments.length){let r=t.attachments[s];for(let c in r){let a=r[c];if(o==a){let l=this.getAttachment(s,c);l&&n.setAttachment(l);break}}}s++}}}class yi{constructor(e,t,s){d(this,"index",0);d(this,"name");d(this,"boneData");d(this,"color",new N(1,1,1,1));d(this,"darkColor",null);d(this,"attachmentName",null);d(this,"blendMode",kt.Normal);d(this,"visible",!0);d(this,"path",null);if(e<0)throw new Error("index must be >= 0.");if(!t)throw new Error("name cannot be null.");if(!s)throw new Error("boneData cannot be null.");this.index=e,this.name=t,this.boneData=s}}var kt;(function(S){S[S.Normal=0]="Normal",S[S.Additive=1]="Additive",S[S.Multiply=2]="Multiply",S[S.Screen=3]="Screen"})(kt||(kt={}));class vi extends Ht{constructor(t){super(t,0,!1);d(this,"bones",new Array);d(this,"_target",null);d(this,"mixRotate",0);d(this,"mixX",0);d(this,"mixY",0);d(this,"mixScaleX",0);d(this,"mixScaleY",0);d(this,"mixShearY",0);d(this,"offsetRotation",0);d(this,"offsetX",0);d(this,"offsetY",0);d(this,"offsetScaleX",0);d(this,"offsetScaleY",0);d(this,"offsetShearY",0);d(this,"relative",!1);d(this,"local",!1)}set target(t){this._target=t}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class Zi{constructor(e){d(this,"scale",1);d(this,"attachmentLoader");d(this,"linkedMeshes",new Array);this.attachmentLoader=e}readSkeletonData(e){let t=this.scale,s=new bi;s.name="";let i=new Ji(e),n=i.readInt32(),o=i.readInt32();s.hash=o==0&&n==0?null:o.toString(16)+n.toString(16),s.version=i.readString(),s.x=i.readFloat(),s.y=i.readFloat(),s.width=i.readFloat(),s.height=i.readFloat(),s.referenceScale=i.readFloat()*t;let r=i.readBoolean();r&&(s.fps=i.readFloat(),s.imagesPath=i.readString(),s.audioPath=i.readString());let c=0;c=i.readInt(!0);for(let l=0;l<c;l++){let h=i.readString();if(!h)throw new Error("String in string table must not be null.");i.strings.push(h)}c=i.readInt(!0);for(let l=0;l<c;l++){let h=i.readString();if(!h)throw new Error("Bone name must not be null.");let u=l==0?null:s.bones[i.readInt(!0)],f=new fi(l,h,u);f.rotation=i.readFloat(),f.x=i.readFloat()*t,f.y=i.readFloat()*t,f.scaleX=i.readFloat(),f.scaleY=i.readFloat(),f.shearX=i.readFloat(),f.shearY=i.readFloat(),f.length=i.readFloat()*t,f.inherit=i.readByte(),f.skinRequired=i.readBoolean(),r&&(N.rgba8888ToColor(f.color,i.readInt32()),f.icon=i.readString()??void 0,f.visible=i.readBoolean()),s.bones.push(f)}c=i.readInt(!0);for(let l=0;l<c;l++){let h=i.readString();if(!h)throw new Error("Slot name must not be null.");let u=null;if(r){const p=h.lastIndexOf("/");p!=-1&&(u=h.substring(0,p),h=h.substring(p+1))}let f=s.bones[i.readInt(!0)],m=new yi(l,h,f);N.rgba8888ToColor(m.color,i.readInt32());let g=i.readInt32();g!=-1&&N.rgb888ToColor(m.darkColor=new N,g),m.attachmentName=i.readStringRef(),m.blendMode=i.readInt(!0),r&&(m.visible=i.readBoolean(),m.path=u),s.slots.push(m)}c=i.readInt(!0);for(let l=0,h;l<c;l++){let u=i.readString();if(!u)throw new Error("IK constraint data name must not be null.");let f=new pi(u);f.order=i.readInt(!0),h=i.readInt(!0);for(let g=0;g<h;g++)f.bones.push(s.bones[i.readInt(!0)]);f.target=s.bones[i.readInt(!0)];let m=i.readByte();f.skinRequired=(m&1)!=0,f.bendDirection=(m&2)!=0?1:-1,f.compress=(m&4)!=0,f.stretch=(m&8)!=0,f.uniform=(m&16)!=0,(m&32)!=0&&(f.mix=(m&64)!=0?i.readFloat():1),(m&128)!=0&&(f.softness=i.readFloat()*t),s.ikConstraints.push(f)}c=i.readInt(!0);for(let l=0,h;l<c;l++){let u=i.readString();if(!u)throw new Error("Transform constraint data name must not be null.");let f=new vi(u);f.order=i.readInt(!0),h=i.readInt(!0);for(let g=0;g<h;g++)f.bones.push(s.bones[i.readInt(!0)]);f.target=s.bones[i.readInt(!0)];let m=i.readByte();f.skinRequired=(m&1)!=0,f.local=(m&2)!=0,f.relative=(m&4)!=0,(m&8)!=0&&(f.offsetRotation=i.readFloat()),(m&16)!=0&&(f.offsetX=i.readFloat()*t),(m&32)!=0&&(f.offsetY=i.readFloat()*t),(m&64)!=0&&(f.offsetScaleX=i.readFloat()),(m&128)!=0&&(f.offsetScaleY=i.readFloat()),m=i.readByte(),(m&1)!=0&&(f.offsetShearY=i.readFloat()),(m&2)!=0&&(f.mixRotate=i.readFloat()),(m&4)!=0&&(f.mixX=i.readFloat()),(m&8)!=0&&(f.mixY=i.readFloat()),(m&16)!=0&&(f.mixScaleX=i.readFloat()),(m&32)!=0&&(f.mixScaleY=i.readFloat()),(m&64)!=0&&(f.mixShearY=i.readFloat()),s.transformConstraints.push(f)}c=i.readInt(!0);for(let l=0,h;l<c;l++){let u=i.readString();if(!u)throw new Error("Path constraint data name must not be null.");let f=new xi(u);f.order=i.readInt(!0),f.skinRequired=i.readBoolean(),h=i.readInt(!0);for(let g=0;g<h;g++)f.bones.push(s.bones[i.readInt(!0)]);f.target=s.slots[i.readInt(!0)];const m=i.readByte();f.positionMode=m&1,f.spacingMode=m>>1&3,f.rotateMode=m>>3&3,(m&128)!=0&&(f.offsetRotation=i.readFloat()),f.position=i.readFloat(),f.positionMode==Ge.Fixed&&(f.position*=t),f.spacing=i.readFloat(),(f.spacingMode==ye.Length||f.spacingMode==ye.Fixed)&&(f.spacing*=t),f.mixRotate=i.readFloat(),f.mixX=i.readFloat(),f.mixY=i.readFloat(),s.pathConstraints.push(f)}c=i.readInt(!0);for(let l=0,h;l<c;l++){const u=i.readString();if(!u)throw new Error("Physics constraint data name must not be null.");const f=new wi(u);f.order=i.readInt(!0),f.bone=s.bones[i.readInt(!0)];let m=i.readByte();f.skinRequired=(m&1)!=0,(m&2)!=0&&(f.x=i.readFloat()),(m&4)!=0&&(f.y=i.readFloat()),(m&8)!=0&&(f.rotate=i.readFloat()),(m&16)!=0&&(f.scaleX=i.readFloat()),(m&32)!=0&&(f.shearX=i.readFloat()),f.limit=((m&64)!=0?i.readFloat():5e3)*t,f.step=1/i.readUnsignedByte(),f.inertia=i.readFloat(),f.strength=i.readFloat(),f.damping=i.readFloat(),f.massInverse=(m&128)!=0?i.readFloat():1,f.wind=i.readFloat(),f.gravity=i.readFloat(),m=i.readByte(),(m&1)!=0&&(f.inertiaGlobal=!0),(m&2)!=0&&(f.strengthGlobal=!0),(m&4)!=0&&(f.dampingGlobal=!0),(m&8)!=0&&(f.massGlobal=!0),(m&16)!=0&&(f.windGlobal=!0),(m&32)!=0&&(f.gravityGlobal=!0),(m&64)!=0&&(f.mixGlobal=!0),f.mix=(m&128)!=0?i.readFloat():1,s.physicsConstraints.push(f)}let a=this.readSkin(i,s,!0,r);a&&(s.defaultSkin=a,s.skins.push(a));{let l=s.skins.length;for(O.setArraySize(s.skins,c=l+i.readInt(!0));l<c;l++){let h=this.readSkin(i,s,!1,r);if(!h)throw new Error("readSkin() should not have returned null.");s.skins[l]=h}}c=this.linkedMeshes.length;for(let l=0;l<c;l++){let h=this.linkedMeshes[l];const u=s.skins[h.skinIndex];if(!h.parent)throw new Error("Linked mesh parent must not be null");let f=u.getAttachment(h.slotIndex,h.parent);if(!f)throw new Error(`Parent mesh not found: ${h.parent}`);h.mesh.timelineAttachment=h.inheritTimeline?f:h.mesh,h.mesh.setParentMesh(f),h.mesh.region!=null&&h.mesh.updateRegion()}this.linkedMeshes.length=0,c=i.readInt(!0);for(let l=0;l<c;l++){let h=i.readString();if(!h)throw new Error("Event data name must not be null");let u=new gi(h);u.intValue=i.readInt(!1),u.floatValue=i.readFloat(),u.stringValue=i.readString(),u.audioPath=i.readString(),u.audioPath&&(u.volume=i.readFloat(),u.balance=i.readFloat()),s.events.push(u)}c=i.readInt(!0);for(let l=0;l<c;l++){let h=i.readString();if(!h)throw new Error("Animatio name must not be null.");s.animations.push(this.readAnimation(i,h,s))}return s}readSkin(e,t,s,i){let n=null,o=0;if(s){if(o=e.readInt(!0),o==0)return null;n=new ns("default")}else{let r=e.readString();if(!r)throw new Error("Skin name must not be null.");n=new ns(r),i&&N.rgba8888ToColor(n.color,e.readInt32()),n.bones.length=e.readInt(!0);for(let c=0,a=n.bones.length;c<a;c++)n.bones[c]=t.bones[e.readInt(!0)];for(let c=0,a=e.readInt(!0);c<a;c++)n.constraints.push(t.ikConstraints[e.readInt(!0)]);for(let c=0,a=e.readInt(!0);c<a;c++)n.constraints.push(t.transformConstraints[e.readInt(!0)]);for(let c=0,a=e.readInt(!0);c<a;c++)n.constraints.push(t.pathConstraints[e.readInt(!0)]);for(let c=0,a=e.readInt(!0);c<a;c++)n.constraints.push(t.physicsConstraints[e.readInt(!0)]);o=e.readInt(!0)}for(let r=0;r<o;r++){let c=e.readInt(!0);for(let a=0,l=e.readInt(!0);a<l;a++){let h=e.readStringRef();if(!h)throw new Error("Attachment name must not be null");let u=this.readAttachment(e,t,n,c,h,i);u&&n.setAttachment(c,h,u)}}return n}readAttachment(e,t,s,i,n,o){let r=this.scale,c=e.readByte();const a=(c&8)!=0?e.readStringRef():n;if(!a)throw new Error("Attachment name must not be null");switch(c&7){case Je.Region:{let l=(c&16)!=0?e.readStringRef():null;const h=(c&32)!=0?e.readInt32():4294967295,u=(c&64)!=0?this.readSequence(e):null;let f=(c&128)!=0?e.readFloat():0,m=e.readFloat(),g=e.readFloat(),p=e.readFloat(),x=e.readFloat(),y=e.readFloat(),b=e.readFloat();l||(l=a);let w=this.attachmentLoader.newRegionAttachment(s,a,l,u);return w?(w.path=l,w.x=m*r,w.y=g*r,w.scaleX=p,w.scaleY=x,w.rotation=f,w.width=y*r,w.height=b*r,N.rgba8888ToColor(w.color,h),w.sequence=u,u==null&&w.updateRegion(),w):null}case Je.BoundingBox:{let l=this.readVertices(e,(c&16)!=0),h=o?e.readInt32():0,u=this.attachmentLoader.newBoundingBoxAttachment(s,a);return u?(u.worldVerticesLength=l.length,u.vertices=l.vertices,u.bones=l.bones,o&&N.rgba8888ToColor(u.color,h),u):null}case Je.Mesh:{let l=(c&16)!=0?e.readStringRef():a;const h=(c&32)!=0?e.readInt32():4294967295,u=(c&64)!=0?this.readSequence(e):null,f=e.readInt(!0),m=this.readVertices(e,(c&128)!=0),g=this.readFloatArray(e,m.length,1),p=this.readShortArray(e,(m.length-f-2)*3);let x=[],y=0,b=0;o&&(x=this.readShortArray(e,e.readInt(!0)),y=e.readFloat(),b=e.readFloat()),l||(l=a);let w=this.attachmentLoader.newMeshAttachment(s,a,l,u);return w?(w.path=l,N.rgba8888ToColor(w.color,h),w.bones=m.bones,w.vertices=m.vertices,w.worldVerticesLength=m.length,w.triangles=p,w.regionUVs=g,u==null&&w.updateRegion(),w.hullLength=f<<1,w.sequence=u,o&&(w.edges=x,w.width=y*r,w.height=b*r),w):null}case Je.LinkedMesh:{const l=(c&16)!=0?e.readStringRef():a;if(l==null)throw new Error("Path of linked mesh must not be null");const h=(c&32)!=0?e.readInt32():4294967295,u=(c&64)!=0?this.readSequence(e):null,f=(c&128)!=0,m=e.readInt(!0),g=e.readStringRef();let p=0,x=0;o&&(p=e.readFloat(),x=e.readFloat());let y=this.attachmentLoader.newMeshAttachment(s,a,l,u);return y?(y.path=l,N.rgba8888ToColor(y.color,h),y.sequence=u,o&&(y.width=p*r,y.height=x*r),this.linkedMeshes.push(new Ki(y,m,i,g,f)),y):null}case Je.Path:{const l=(c&16)!=0,h=(c&32)!=0,u=this.readVertices(e,(c&64)!=0),f=O.newArray(u.length/6,0);for(let p=0,x=f.length;p<x;p++)f[p]=e.readFloat()*r;const m=o?e.readInt32():0,g=this.attachmentLoader.newPathAttachment(s,a);return g?(g.closed=l,g.constantSpeed=h,g.worldVerticesLength=u.length,g.vertices=u.vertices,g.bones=u.bones,g.lengths=f,o&&N.rgba8888ToColor(g.color,m),g):null}case Je.Point:{const l=e.readFloat(),h=e.readFloat(),u=e.readFloat(),f=o?e.readInt32():0,m=this.attachmentLoader.newPointAttachment(s,a);return m?(m.x=h*r,m.y=u*r,m.rotation=l,o&&N.rgba8888ToColor(m.color,f),m):null}case Je.Clipping:{const l=e.readInt(!0),h=this.readVertices(e,(c&16)!=0);let u=o?e.readInt32():0,f=this.attachmentLoader.newClippingAttachment(s,a);return f?(f.endSlot=t.slots[l],f.worldVerticesLength=h.length,f.vertices=h.vertices,f.bones=h.bones,o&&N.rgba8888ToColor(f.color,u),f):null}}return null}readSequence(e){let t=new Xt(e.readInt(!0));return t.start=e.readInt(!0),t.digits=e.readInt(!0),t.setupIndex=e.readInt(!0),t}readVertices(e,t){const s=this.scale,i=e.readInt(!0),n=new Qi;if(n.length=i<<1,!t)return n.vertices=this.readFloatArray(e,n.length,s),n;let o=new Array,r=new Array;for(let c=0;c<i;c++){let a=e.readInt(!0);r.push(a);for(let l=0;l<a;l++)r.push(e.readInt(!0)),o.push(e.readFloat()*s),o.push(e.readFloat()*s),o.push(e.readFloat())}return n.vertices=O.toFloatArray(o),n.bones=r,n}readFloatArray(e,t,s){let i=new Array(t);if(s==1)for(let n=0;n<t;n++)i[n]=e.readFloat();else for(let n=0;n<t;n++)i[n]=e.readFloat()*s;return i}readShortArray(e,t){let s=new Array(t);for(let i=0;i<t;i++)s[i]=e.readInt(!0);return s}readAnimation(e,t,s){e.readInt(!0);let i=new Array,n=this.scale;for(let a=0,l=e.readInt(!0);a<l;a++){let h=e.readInt(!0);for(let u=0,f=e.readInt(!0);u<f;u++){let m=e.readByte(),g=e.readInt(!0),p=g-1;switch(m){case hr:{let x=new dt(g,h);for(let y=0;y<g;y++)x.setFrame(y,e.readFloat(),e.readStringRef());i.push(x);break}case cr:{let x=e.readInt(!0),y=new js(g,x,h),b=e.readFloat(),w=e.readUnsignedByte()/255,C=e.readUnsignedByte()/255,v=e.readUnsignedByte()/255,A=e.readUnsignedByte()/255;for(let I=0,E=0;y.setFrame(I,b,w,C,v,A),I!=p;I++){let F=e.readFloat(),Y=e.readUnsignedByte()/255,L=e.readUnsignedByte()/255,B=e.readUnsignedByte()/255,P=e.readUnsignedByte()/255;switch(e.readByte()){case ze:y.setStepped(I);break;case We:oe(e,y,E++,I,0,b,F,w,Y,1),oe(e,y,E++,I,1,b,F,C,L,1),oe(e,y,E++,I,2,b,F,v,B,1),oe(e,y,E++,I,3,b,F,A,P,1)}b=F,w=Y,C=L,v=B,A=P}i.push(y);break}case dr:{let x=e.readInt(!0),y=new Zs(g,x,h),b=e.readFloat(),w=e.readUnsignedByte()/255,C=e.readUnsignedByte()/255,v=e.readUnsignedByte()/255;for(let A=0,I=0;y.setFrame(A,b,w,C,v),A!=p;A++){let E=e.readFloat(),F=e.readUnsignedByte()/255,Y=e.readUnsignedByte()/255,L=e.readUnsignedByte()/255;switch(e.readByte()){case ze:y.setStepped(A);break;case We:oe(e,y,I++,A,0,b,E,w,F,1),oe(e,y,I++,A,1,b,E,C,Y,1),oe(e,y,I++,A,2,b,E,v,L,1)}b=E,w=F,C=Y,v=L}i.push(y);break}case fr:{let x=e.readInt(!0),y=new Ks(g,x,h),b=e.readFloat(),w=e.readUnsignedByte()/255,C=e.readUnsignedByte()/255,v=e.readUnsignedByte()/255,A=e.readUnsignedByte()/255,I=e.readUnsignedByte()/255,E=e.readUnsignedByte()/255,F=e.readUnsignedByte()/255;for(let Y=0,L=0;y.setFrame(Y,b,w,C,v,A,I,E,F),Y!=p;Y++){let B=e.readFloat(),P=e.readUnsignedByte()/255,R=e.readUnsignedByte()/255,M=e.readUnsignedByte()/255,D=e.readUnsignedByte()/255,re=e.readUnsignedByte()/255,ie=e.readUnsignedByte()/255,fe=e.readUnsignedByte()/255;switch(e.readByte()){case ze:y.setStepped(Y);break;case We:oe(e,y,L++,Y,0,b,B,w,P,1),oe(e,y,L++,Y,1,b,B,C,R,1),oe(e,y,L++,Y,2,b,B,v,M,1),oe(e,y,L++,Y,3,b,B,A,D,1),oe(e,y,L++,Y,4,b,B,I,re,1),oe(e,y,L++,Y,5,b,B,E,ie,1),oe(e,y,L++,Y,6,b,B,F,fe,1)}b=B,w=P,C=R,v=M,A=D,I=re,E=ie,F=fe}i.push(y);break}case ur:{let x=e.readInt(!0),y=new Qs(g,x,h),b=e.readFloat(),w=e.readUnsignedByte()/255,C=e.readUnsignedByte()/255,v=e.readUnsignedByte()/255,A=e.readUnsignedByte()/255,I=e.readUnsignedByte()/255,E=e.readUnsignedByte()/255;for(let F=0,Y=0;y.setFrame(F,b,w,C,v,A,I,E),F!=p;F++){let L=e.readFloat(),B=e.readUnsignedByte()/255,P=e.readUnsignedByte()/255,R=e.readUnsignedByte()/255,M=e.readUnsignedByte()/255,D=e.readUnsignedByte()/255,re=e.readUnsignedByte()/255;switch(e.readByte()){case ze:y.setStepped(F);break;case We:oe(e,y,Y++,F,0,b,L,w,B,1),oe(e,y,Y++,F,1,b,L,C,P,1),oe(e,y,Y++,F,2,b,L,v,R,1),oe(e,y,Y++,F,3,b,L,A,M,1),oe(e,y,Y++,F,4,b,L,I,D,1),oe(e,y,Y++,F,5,b,L,E,re,1)}b=L,w=B,C=P,v=R,A=M,I=D,E=re}i.push(y);break}case mr:{let x=new Js(g,e.readInt(!0),h),y=e.readFloat(),b=e.readUnsignedByte()/255;for(let w=0,C=0;x.setFrame(w,y,b),w!=p;w++){let v=e.readFloat(),A=e.readUnsignedByte()/255;switch(e.readByte()){case ze:x.setStepped(w);break;case We:oe(e,x,C++,w,0,y,v,b,A,1)}y=v,b=A}i.push(x)}}}}for(let a=0,l=e.readInt(!0);a<l;a++){let h=e.readInt(!0);for(let u=0,f=e.readInt(!0);u<f;u++){let m=e.readByte(),g=e.readInt(!0);if(m==or){let x=new Hs(g,h);for(let y=0;y<g;y++)x.setFrame(y,e.readFloat(),e.readByte());i.push(x);continue}let p=e.readInt(!0);switch(m){case _i:i.push(Ae(e,new Bt(g,p,h),1));break;case $i:i.push(_t(e,new Vs(g,p,h),n));break;case er:i.push(Ae(e,new Os(g,p,h),n));break;case tr:i.push(Ae(e,new Ns(g,p,h),n));break;case sr:i.push(_t(e,new Ds(g,p,h),1));break;case ir:i.push(Ae(e,new Us(g,p,h),1));break;case rr:i.push(Ae(e,new zs(g,p,h),1));break;case nr:i.push(_t(e,new Ws(g,p,h),1));break;case ar:i.push(Ae(e,new qs(g,p,h),1));break;case lr:i.push(Ae(e,new Gs(g,p,h),1))}}}for(let a=0,l=e.readInt(!0);a<l;a++){let h=e.readInt(!0),u=e.readInt(!0),f=u-1,m=new $s(u,e.readInt(!0),h),g=e.readByte(),p=e.readFloat(),x=(g&1)!=0?(g&2)!=0?e.readFloat():1:0,y=(g&4)!=0?e.readFloat()*n:0;for(let b=0,w=0;m.setFrame(b,p,x,y,(g&8)!=0?1:-1,(g&16)!=0,(g&32)!=0),b!=f;b++){g=e.readByte();const C=e.readFloat(),v=(g&1)!=0?(g&2)!=0?e.readFloat():1:0,A=(g&4)!=0?e.readFloat()*n:0;(g&64)!=0?m.setStepped(b):(g&128)!=0&&(oe(e,m,w++,b,0,p,C,x,v,1),oe(e,m,w++,b,1,p,C,y,A,n)),p=C,x=v,y=A}i.push(m)}for(let a=0,l=e.readInt(!0);a<l;a++){let h=e.readInt(!0),u=e.readInt(!0),f=u-1,m=new ei(u,e.readInt(!0),h),g=e.readFloat(),p=e.readFloat(),x=e.readFloat(),y=e.readFloat(),b=e.readFloat(),w=e.readFloat(),C=e.readFloat();for(let v=0,A=0;m.setFrame(v,g,p,x,y,b,w,C),v!=f;v++){let I=e.readFloat(),E=e.readFloat(),F=e.readFloat(),Y=e.readFloat(),L=e.readFloat(),B=e.readFloat(),P=e.readFloat();switch(e.readByte()){case ze:m.setStepped(v);break;case We:oe(e,m,A++,v,0,g,I,p,E,1),oe(e,m,A++,v,1,g,I,x,F,1),oe(e,m,A++,v,2,g,I,y,Y,1),oe(e,m,A++,v,3,g,I,b,L,1),oe(e,m,A++,v,4,g,I,w,B,1),oe(e,m,A++,v,5,g,I,C,P,1)}g=I,p=E,x=F,y=Y,b=L,w=B,C=P}i.push(m)}for(let a=0,l=e.readInt(!0);a<l;a++){let h=e.readInt(!0),u=s.pathConstraints[h];for(let f=0,m=e.readInt(!0);f<m;f++){const g=e.readByte(),p=e.readInt(!0),x=e.readInt(!0);switch(g){case xr:i.push(Ae(e,new ti(p,x,h),u.positionMode==Ge.Fixed?n:1));break;case wr:i.push(Ae(e,new si(p,x,h),u.spacingMode==ye.Length||u.spacingMode==ye.Fixed?n:1));break;case br:let y=new ii(p,x,h),b=e.readFloat(),w=e.readFloat(),C=e.readFloat(),v=e.readFloat();for(let A=0,I=0,E=y.getFrameCount()-1;y.setFrame(A,b,w,C,v),A!=E;A++){let F=e.readFloat(),Y=e.readFloat(),L=e.readFloat(),B=e.readFloat();switch(e.readByte()){case ze:y.setStepped(A);break;case We:oe(e,y,I++,A,0,b,F,w,Y,1),oe(e,y,I++,A,1,b,F,C,L,1),oe(e,y,I++,A,2,b,F,v,B,1)}b=F,w=Y,C=L,v=B}i.push(y)}}}for(let a=0,l=e.readInt(!0);a<l;a++){const h=e.readInt(!0)-1;for(let u=0,f=e.readInt(!0);u<f;u++){const m=e.readByte(),g=e.readInt(!0);if(m==Er){const x=new Pt(g,h);for(let y=0;y<g;y++)x.setFrame(y,e.readFloat());i.push(x);continue}const p=e.readInt(!0);switch(m){case yr:i.push(Ae(e,new ri(g,p,h),1));break;case vr:i.push(Ae(e,new ni(g,p,h),1));break;case Cr:i.push(Ae(e,new ai(g,p,h),1));break;case Sr:i.push(Ae(e,new li(g,p,h),1));break;case Ar:i.push(Ae(e,new oi(g,p,h),1));break;case Ir:i.push(Ae(e,new hi(g,p,h),1));break;case kr:i.push(Ae(e,new ci(g,p,h),1))}}}for(let a=0,l=e.readInt(!0);a<l;a++){let h=s.skins[e.readInt(!0)];for(let u=0,f=e.readInt(!0);u<f;u++){let m=e.readInt(!0);for(let g=0,p=e.readInt(!0);g<p;g++){let x=e.readStringRef();if(!x)throw new Error("attachmentName must not be null.");let y=h.getAttachment(m,x),b=e.readByte(),w=e.readInt(!0),C=w-1;switch(b){case gr:{let v=y,A=v.bones,I=v.vertices,E=A?I.length/3*2:I.length,F=e.readInt(!0),Y=new _s(w,F,m,v),L=e.readFloat();for(let B=0,P=0;;B++){let R,M=e.readInt(!0);if(M==0)R=A?O.newFloatArray(E):I;else{R=O.newFloatArray(E);let re=e.readInt(!0);if(M+=re,n==1)for(let ie=re;ie<M;ie++)R[ie]=e.readFloat();else for(let ie=re;ie<M;ie++)R[ie]=e.readFloat()*n;if(!A)for(let ie=0,fe=R.length;ie<fe;ie++)R[ie]+=I[ie]}if(Y.setFrame(B,L,R),B==C)break;let D=e.readFloat();switch(e.readByte()){case ze:Y.setStepped(B);break;case We:oe(e,Y,P++,B,0,L,D,0,1,1)}L=D}i.push(Y);break}case pr:{let v=new Vt(w,m,y);for(let A=0;A<w;A++){let I=e.readFloat(),E=e.readInt32();v.setFrame(A,I,Ps[E&15],E>>4,e.readFloat())}i.push(v);break}}}}}let o=e.readInt(!0);if(o>0){let a=new it(o),l=s.slots.length;for(let h=0;h<o;h++){let u=e.readFloat(),f=e.readInt(!0),m=O.newArray(l,0);for(let y=l-1;y>=0;y--)m[y]=-1;let g=O.newArray(l-f,0),p=0,x=0;for(let y=0;y<f;y++){let b=e.readInt(!0);for(;p!=b;)g[x++]=p++;m[p+e.readInt(!0)]=p++}for(;p<l;)g[x++]=p++;for(let y=l-1;y>=0;y--)m[y]==-1&&(m[y]=g[--x]);a.setFrame(h,u,m)}i.push(a)}let r=e.readInt(!0);if(r>0){let a=new It(r);for(let l=0;l<r;l++){let h=e.readFloat(),u=s.events[e.readInt(!0)],f=new mi(h,u);f.intValue=e.readInt(!1),f.floatValue=e.readFloat(),f.stringValue=e.readString(),f.stringValue==null&&(f.stringValue=u.stringValue),f.data.audioPath&&(f.volume=e.readFloat(),f.balance=e.readFloat()),a.setFrame(l,f)}i.push(a)}let c=0;for(let a=0,l=i.length;a<l;a++)c=Math.max(c,i[a].getDuration());return new cs(t,i,c)}}class Ji{constructor(e,t=new Array,s=0,i=new DataView(e.buffer)){d(this,"strings");d(this,"index");d(this,"buffer");this.strings=t,this.index=s,this.buffer=i}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){let e=this.buffer.getInt16(this.index);return this.index+=2,e}readInt32(){let e=this.buffer.getInt32(this.index);return this.index+=4,e}readInt(e){let t=this.readByte(),s=t&127;return(t&128)!=0&&(t=this.readByte(),s|=(t&127)<<7,(t&128)!=0&&(t=this.readByte(),s|=(t&127)<<14,(t&128)!=0&&(t=this.readByte(),s|=(t&127)<<21,(t&128)!=0&&(t=this.readByte(),s|=(t&127)<<28)))),e?s:s>>>1^-(s&1)}readStringRef(){let e=this.readInt(!0);return e==0?null:this.strings[e-1]}readString(){let e=this.readInt(!0);switch(e){case 0:return null;case 1:return""}e--;let t="";for(let s=0;s<e;){let i=this.readUnsignedByte();switch(i>>4){case 12:case 13:t+=String.fromCharCode((i&31)<<6|this.readByte()&63),s+=2;break;case 14:t+=String.fromCharCode((i&15)<<12|(this.readByte()&63)<<6|this.readByte()&63),s+=3;break;default:t+=String.fromCharCode(i),s++}}return t}readFloat(){let e=this.buffer.getFloat32(this.index);return this.index+=4,e}readBoolean(){return this.readByte()!=0}}let Ki=class{constructor(e,t,s,i,n){d(this,"parent");d(this,"skinIndex");d(this,"slotIndex");d(this,"mesh");d(this,"inheritTimeline");this.mesh=e,this.skinIndex=t,this.slotIndex=s,this.parent=i,this.inheritTimeline=n}};class Qi{constructor(e=null,t=null,s=0){d(this,"bones");d(this,"vertices");d(this,"length");this.bones=e,this.vertices=t,this.length=s}}var Je;(function(S){S[S.Region=0]="Region",S[S.BoundingBox=1]="BoundingBox",S[S.Mesh=2]="Mesh",S[S.LinkedMesh=3]="LinkedMesh",S[S.Path=4]="Path",S[S.Point=5]="Point",S[S.Clipping=6]="Clipping"})(Je||(Je={}));function Ae(S,e,t){let s=S.readFloat(),i=S.readFloat()*t;for(let n=0,o=0,r=e.getFrameCount()-1;e.setFrame(n,s,i),n!=r;n++){let c=S.readFloat(),a=S.readFloat()*t;switch(S.readByte()){case ze:e.setStepped(n);break;case We:oe(S,e,o++,n,0,s,c,i,a,t)}s=c,i=a}return e}function _t(S,e,t){let s=S.readFloat(),i=S.readFloat()*t,n=S.readFloat()*t;for(let o=0,r=0,c=e.getFrameCount()-1;e.setFrame(o,s,i,n),o!=c;o++){let a=S.readFloat(),l=S.readFloat()*t,h=S.readFloat()*t;switch(S.readByte()){case ze:e.setStepped(o);break;case We:oe(S,e,r++,o,0,s,a,i,l,t),oe(S,e,r++,o,1,s,a,n,h,t)}s=a,i=l,n=h}return e}function oe(S,e,t,s,i,n,o,r,c,a){e.setBezier(t,s,i,n,r,S.readFloat(),S.readFloat()*a,S.readFloat(),S.readFloat()*a,o,c)}const _i=0,$i=1,er=2,tr=3,sr=4,ir=5,rr=6,nr=7,ar=8,lr=9,or=10,hr=0,cr=1,dr=2,fr=3,ur=4,mr=5,gr=0,pr=1,xr=0,wr=1,br=2,yr=0,vr=1,Cr=2,Sr=4,Ar=5,Ir=6,kr=7,Er=8,ze=1,We=2;class Tr{constructor(){d(this,"minX",0);d(this,"minY",0);d(this,"maxX",0);d(this,"maxY",0);d(this,"boundingBoxes",new Array);d(this,"polygons",new Array);d(this,"polygonPool",new Lt(()=>O.newFloatArray(16)))}update(e,t){if(!e)throw new Error("skeleton cannot be null.");let s=this.boundingBoxes,i=this.polygons,n=this.polygonPool,o=e.slots,r=o.length;s.length=0,n.freeAll(i),i.length=0;for(let c=0;c<r;c++){let a=o[c];if(!a.bone.active)continue;let l=a.getAttachment();if(l instanceof Gt){let h=l;s.push(h);let u=n.obtain();u.length!=h.worldVerticesLength&&(u=O.newFloatArray(h.worldVerticesLength)),i.push(u),h.computeWorldVertices(a,0,h.worldVerticesLength,u,0,2)}}t?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,n=this.polygons;for(let o=0,r=n.length;o<r;o++){let c=n[o],a=c;for(let l=0,h=c.length;l<h;l+=2){let u=a[l],f=a[l+1];e=Math.min(e,u),t=Math.min(t,f),s=Math.max(s,u),i=Math.max(i,f)}}this.minX=e,this.minY=t,this.maxX=s,this.maxY=i}aabbContainsPoint(e,t){return e>=this.minX&&e<=this.maxX&&t>=this.minY&&t<=this.maxY}aabbIntersectsSegment(e,t,s,i){let n=this.minX,o=this.minY,r=this.maxX,c=this.maxY;if(e<=n&&s<=n||t<=o&&i<=o||e>=r&&s>=r||t>=c&&i>=c)return!1;let a=(i-t)/(s-e),l=a*(n-e)+t;if(l>o&&l<c||(l=a*(r-e)+t,l>o&&l<c))return!0;let h=(o-t)/a+e;return h>n&&h<r||(h=(c-t)/a+e,h>n&&h<r)}aabbIntersectsSkeleton(e){return this.minX<e.maxX&&this.maxX>e.minX&&this.minY<e.maxY&&this.maxY>e.minY}containsPoint(e,t){let s=this.polygons;for(let i=0,n=s.length;i<n;i++)if(this.containsPointPolygon(s[i],e,t))return this.boundingBoxes[i];return null}containsPointPolygon(e,t,s){let i=e,n=e.length,o=n-2,r=!1;for(let c=0;c<n;c+=2){let a=i[c+1],l=i[o+1];if(a<s&&l>=s||l<s&&a>=s){let h=i[c];h+(s-a)/(l-a)*(i[o]-h)<t&&(r=!r)}o=c}return r}intersectsSegment(e,t,s,i){let n=this.polygons;for(let o=0,r=n.length;o<r;o++)if(this.intersectsSegmentPolygon(n[o],e,t,s,i))return this.boundingBoxes[o];return null}intersectsSegmentPolygon(e,t,s,i,n){let o=e,r=e.length,c=t-i,a=s-n,l=t*n-s*i,h=o[r-2],u=o[r-1];for(let f=0;f<r;f+=2){let m=o[f],g=o[f+1],p=h*g-u*m,x=h-m,y=u-g,b=c*y-a*x,w=(l*x-c*p)/b;if((w>=h&&w<=m||w>=m&&w<=h)&&(w>=t&&w<=i||w>=i&&w<=t)){let C=(l*y-a*p)/b;if((C>=u&&C<=g||C>=g&&C<=u)&&(C>=s&&C<=n||C>=n&&C<=s))return!0}h=m,u=g}return!1}getPolygon(e){if(!e)throw new Error("boundingBox cannot be null.");let t=this.boundingBoxes.indexOf(e);return t==-1?null:this.polygons[t]}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}}class Re{constructor(){d(this,"convexPolygons",new Array);d(this,"convexPolygonsIndices",new Array);d(this,"indicesArray",new Array);d(this,"isConcaveArray",new Array);d(this,"triangles",new Array);d(this,"polygonPool",new Lt(()=>new Array));d(this,"polygonIndicesPool",new Lt(()=>new Array))}triangulate(e){let t=e,s=e.length>>1,i=this.indicesArray;i.length=0;for(let r=0;r<s;r++)i[r]=r;let n=this.isConcaveArray;n.length=0;for(let r=0,c=s;r<c;++r)n[r]=Re.isConcave(r,s,t,i);let o=this.triangles;for(o.length=0;s>3;){let r=s-1,c=0,a=1;for(;;){e:if(!n[c]){let u=i[r]<<1,f=i[c]<<1,m=i[a]<<1,g=t[u],p=t[u+1],x=t[f],y=t[f+1],b=t[m],w=t[m+1];for(let C=(a+1)%s;C!=r;C=(C+1)%s){if(!n[C])continue;let v=i[C]<<1,A=t[v],I=t[v+1];if(Re.positiveArea(b,w,g,p,A,I)&&Re.positiveArea(g,p,x,y,A,I)&&Re.positiveArea(x,y,b,w,A,I))break e}break}if(a==0){do{if(!n[c])break;c--}while(c>0);break}r=c,c=a,a=(a+1)%s}o.push(i[(s+c-1)%s]),o.push(i[c]),o.push(i[(c+1)%s]),i.splice(c,1),n.splice(c,1),s--;let l=(s+c-1)%s,h=c==s?0:c;n[l]=Re.isConcave(l,s,t,i),n[h]=Re.isConcave(h,s,t,i)}return s==3&&(o.push(i[2]),o.push(i[0]),o.push(i[1])),o}decompose(e,t){let s=e,i=this.convexPolygons;this.polygonPool.freeAll(i),i.length=0;let n=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(n),n.length=0;let o=this.polygonIndicesPool.obtain();o.length=0;let r=this.polygonPool.obtain();r.length=0;let c=-1,a=0;for(let l=0,h=t.length;l<h;l+=3){let u=t[l]<<1,f=t[l+1]<<1,m=t[l+2]<<1,g=s[u],p=s[u+1],x=s[f],y=s[f+1],b=s[m],w=s[m+1],C=!1;if(c==u){let v=r.length-4,A=Re.winding(r[v],r[v+1],r[v+2],r[v+3],b,w),I=Re.winding(b,w,r[0],r[1],r[2],r[3]);A==a&&I==a&&(r.push(b),r.push(w),o.push(m),C=!0)}C||(r.length>0?(i.push(r),n.push(o)):(this.polygonPool.free(r),this.polygonIndicesPool.free(o)),r=this.polygonPool.obtain(),r.length=0,r.push(g),r.push(p),r.push(x),r.push(y),r.push(b),r.push(w),o=this.polygonIndicesPool.obtain(),o.length=0,o.push(u),o.push(f),o.push(m),a=Re.winding(g,p,x,y,b,w),c=u)}r.length>0&&(i.push(r),n.push(o));for(let l=0,h=i.length;l<h;l++){if(o=n[l],o.length==0)continue;let u=o[0],f=o[o.length-1];r=i[l];let m=r.length-4,g=r[m],p=r[m+1],x=r[m+2],y=r[m+3],b=r[0],w=r[1],C=r[2],v=r[3],A=Re.winding(g,p,x,y,b,w);for(let I=0;I<h;I++){if(I==l)continue;let E=n[I];if(E.length!=3)continue;let F=E[0],Y=E[1],L=E[2],B=i[I],P=B[B.length-2],R=B[B.length-1];if(F!=u||Y!=f)continue;let M=Re.winding(g,p,x,y,P,R),D=Re.winding(P,R,b,w,C,v);M==A&&D==A&&(B.length=0,E.length=0,r.push(P),r.push(R),o.push(L),g=x,p=y,x=P,y=R,I=0)}}for(let l=i.length-1;l>=0;l--)r=i[l],r.length==0&&(i.splice(l,1),this.polygonPool.free(r),o=n[l],n.splice(l,1),this.polygonIndicesPool.free(o));return i}static isConcave(e,t,s,i){let n=i[(t+e-1)%t]<<1,o=i[e]<<1,r=i[(e+1)%t]<<1;return!this.positiveArea(s[n],s[n+1],s[o],s[o+1],s[r],s[r+1])}static positiveArea(e,t,s,i,n,o){return e*(o-i)+s*(t-o)+n*(i-t)>=0}static winding(e,t,s,i,n,o){let r=s-e,c=i-t;return n*c-o*r+r*t-e*c>=0?1:-1}}class Ot{constructor(){d(this,"triangulator",new Re);d(this,"clippingPolygon",new Array);d(this,"clipOutput",new Array);d(this,"clippedVertices",new Array);d(this,"clippedTriangles",new Array);d(this,"scratch",new Array);d(this,"clipAttachment",null);d(this,"clippingPolygons",null)}clipStart(e,t){if(this.clipAttachment)return 0;this.clipAttachment=t;let s=t.worldVerticesLength,i=O.setArraySize(this.clippingPolygon,s);t.computeWorldVertices(e,0,s,i,0,2);let n=this.clippingPolygon;Ot.makeClockwise(n);let o=this.clippingPolygons=this.triangulator.decompose(n,this.triangulator.triangulate(n));for(let r=0,c=o.length;r<c;r++){let a=o[r];Ot.makeClockwise(a),a.push(a[0]),a.push(a[1])}return o.length}clipEndWithSlot(e){this.clipAttachment&&this.clipAttachment.endSlot==e.data&&this.clipEnd()}clipEnd(){this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)}isClipping(){return this.clipAttachment!=null}clipTriangles(e,t,s,i,n,o,r,c){n&&o&&r&&typeof c=="boolean"?this.clipTrianglesRender(e,t,s,i,n,o,r,c):this.clipTrianglesNoRender(e,t,s,i)}clipTrianglesNoRender(e,t,s,i){let n=this.clipOutput,o=this.clippedVertices,r=this.clippedTriangles,c=this.clippingPolygons,a=c.length,l=2,h=0;o.length=0,r.length=0;e:for(let u=0;u<i;u+=3){let f=s[u]<<1,m=e[f],g=e[f+1];f=s[u+1]<<1;let p=e[f],x=e[f+1];f=s[u+2]<<1;let y=e[f],b=e[f+1];for(let w=0;w<a;w++){let C=o.length;if(this.clip(m,g,p,x,y,b,c[w],n)){let v=n.length;if(v==0)continue;let A=v>>1,I=this.clipOutput,E=O.setArraySize(o,C+A*l);for(let Y=0;Y<v;Y+=2){let L=I[Y],B=I[Y+1];E[C]=L,E[C+1]=B,C+=2}C=r.length;let F=O.setArraySize(r,C+3*(A-2));A--;for(let Y=1;Y<A;Y++)F[C]=h,F[C+1]=h+Y,F[C+2]=h+Y+1,C+=3;h+=A+1}else{let v=O.setArraySize(o,C+3*l);v[C]=m,v[C+1]=g,v[C+2]=p,v[C+3]=x,v[C+4]=y,v[C+5]=b,C=r.length;let A=O.setArraySize(r,C+3);A[C]=h,A[C+1]=h+1,A[C+2]=h+2,h+=3;continue e}}}}clipTrianglesRender(e,t,s,i,n,o,r,c){let a=this.clipOutput,l=this.clippedVertices,h=this.clippedTriangles,u=this.clippingPolygons,f=u.length,m=c?12:8,g=0;l.length=0,h.length=0;e:for(let p=0;p<i;p+=3){let x=s[p]<<1,y=e[x],b=e[x+1],w=n[x],C=n[x+1];x=s[p+1]<<1;let v=e[x],A=e[x+1],I=n[x],E=n[x+1];x=s[p+2]<<1;let F=e[x],Y=e[x+1],L=n[x],B=n[x+1];for(let P=0;P<f;P++){let R=l.length;if(this.clip(y,b,v,A,F,Y,u[P],a)){let M=a.length;if(M==0)continue;let D=A-Y,re=F-v,ie=y-F,fe=Y-b,ge=1/(D*ie+re*(b-Y)),me=M>>1,le=this.clipOutput,ne=O.setArraySize(l,R+me*m);for(let Se=0;Se<M;Se+=2){let Pe=le[Se],ve=le[Se+1];ne[R]=Pe,ne[R+1]=ve,ne[R+2]=o.r,ne[R+3]=o.g,ne[R+4]=o.b,ne[R+5]=o.a;let Le=Pe-F,Xe=ve-Y,Qe=(D*Le+re*Xe)*ge,lt=(fe*Le+ie*Xe)*ge,vt=1-Qe-lt;ne[R+6]=w*Qe+I*lt+L*vt,ne[R+7]=C*Qe+E*lt+B*vt,c&&(ne[R+8]=r.r,ne[R+9]=r.g,ne[R+10]=r.b,ne[R+11]=r.a),R+=m}R=h.length;let ue=O.setArraySize(h,R+3*(me-2));me--;for(let Se=1;Se<me;Se++)ue[R]=g,ue[R+1]=g+Se,ue[R+2]=g+Se+1,R+=3;g+=me+1}else{let M=O.setArraySize(l,R+3*m);M[R]=y,M[R+1]=b,M[R+2]=o.r,M[R+3]=o.g,M[R+4]=o.b,M[R+5]=o.a,c?(M[R+6]=w,M[R+7]=C,M[R+8]=r.r,M[R+9]=r.g,M[R+10]=r.b,M[R+11]=r.a,M[R+12]=v,M[R+13]=A,M[R+14]=o.r,M[R+15]=o.g,M[R+16]=o.b,M[R+17]=o.a,M[R+18]=I,M[R+19]=E,M[R+20]=r.r,M[R+21]=r.g,M[R+22]=r.b,M[R+23]=r.a,M[R+24]=F,M[R+25]=Y,M[R+26]=o.r,M[R+27]=o.g,M[R+28]=o.b,M[R+29]=o.a,M[R+30]=L,M[R+31]=B,M[R+32]=r.r,M[R+33]=r.g,M[R+34]=r.b,M[R+35]=r.a):(M[R+6]=w,M[R+7]=C,M[R+8]=v,M[R+9]=A,M[R+10]=o.r,M[R+11]=o.g,M[R+12]=o.b,M[R+13]=o.a,M[R+14]=I,M[R+15]=E,M[R+16]=F,M[R+17]=Y,M[R+18]=o.r,M[R+19]=o.g,M[R+20]=o.b,M[R+21]=o.a,M[R+22]=L,M[R+23]=B),R=h.length;let D=O.setArraySize(h,R+3);D[R]=g,D[R+1]=g+1,D[R+2]=g+2,g+=3;continue e}}}}clip(e,t,s,i,n,o,r,c){let a=c,l=!1,h;r.length%4>=2?(h=c,c=this.scratch):h=this.scratch,h.length=0,h.push(e),h.push(t),h.push(s),h.push(i),h.push(n),h.push(o),h.push(e),h.push(t),c.length=0;let u=r,f=r.length-4;for(let m=0;;m+=2){let g=u[m],p=u[m+1],x=u[m+2],y=u[m+3],b=g-x,w=p-y,C=h,v=h.length-2,A=c.length;for(let E=0;E<v;E+=2){let F=C[E],Y=C[E+1],L=C[E+2],B=C[E+3],P=b*(B-y)-w*(L-x)>0;if(b*(Y-y)-w*(F-x)>0){if(P){c.push(L),c.push(B);continue}let R=B-Y,M=L-F,D=R*(x-g)-M*(y-p);if(Math.abs(D)>1e-6){let re=(M*(p-Y)-R*(g-F))/D;c.push(g+(x-g)*re),c.push(p+(y-p)*re)}else c.push(g),c.push(p)}else if(P){let R=B-Y,M=L-F,D=R*(x-g)-M*(y-p);if(Math.abs(D)>1e-6){let re=(M*(p-Y)-R*(g-F))/D;c.push(g+(x-g)*re),c.push(p+(y-p)*re)}else c.push(g),c.push(p);c.push(L),c.push(B)}l=!0}if(A==c.length)return a.length=0,!0;if(c.push(c[0]),c.push(c[1]),m==f)break;let I=c;c=h,c.length=0,h=I}if(a!=c){a.length=0;for(let m=0,g=c.length-2;m<g;m++)a[m]=c[m]}else a.length=a.length-2;return l}static makeClockwise(e){let t=e,s=e.length,i=t[s-2]*t[1]-t[0]*t[s-1],n=0,o=0,r=0,c=0;for(let a=0,l=s-3;a<l;a+=2)n=t[a],o=t[a+1],r=t[a+2],c=t[a+3],i+=n*c-r*o;if(!(i<0))for(let a=0,l=s-2,h=s>>1;a<h;a+=2){let u=t[a],f=t[a+1],m=l-a;t[a]=t[m],t[a+1]=t[m+1],t[m]=u,t[m+1]=f}}}class Mr{constructor(e){d(this,"attachmentLoader");d(this,"scale",1);d(this,"linkedMeshes",new Array);this.attachmentLoader=e}readSkeletonData(e){let t=this.scale,s=new bi,i=typeof e=="string"?JSON.parse(e):e,n=i.skeleton;if(n&&(s.hash=n.hash,s.version=n.spine,s.x=n.x,s.y=n.y,s.width=n.width,s.height=n.height,s.referenceScale=T(n,"referenceScale",100)*t,s.fps=n.fps,s.imagesPath=n.images??null,s.audioPath=n.audio??null),i.bones)for(let o=0;o<i.bones.length;o++){let r=i.bones[o],c=null,a=T(r,"parent",null);a&&(c=s.findBone(a));let l=new fi(s.bones.length,r.name,c);l.length=T(r,"length",0)*t,l.x=T(r,"x",0)*t,l.y=T(r,"y",0)*t,l.rotation=T(r,"rotation",0),l.scaleX=T(r,"scaleX",1),l.scaleY=T(r,"scaleY",1),l.shearX=T(r,"shearX",0),l.shearY=T(r,"shearY",0),l.inherit=O.enumValue(xe,T(r,"inherit","Normal")),l.skinRequired=T(r,"skin",!1);let h=T(r,"color",null);h&&l.color.setFromString(h),s.bones.push(l)}if(i.slots)for(let o=0;o<i.slots.length;o++){let r=i.slots[o],c=null,a=r.name;const l=a.lastIndexOf("/");l!=-1&&(c=a.substring(0,l),a=a.substring(l+1));let h=s.findBone(r.bone);if(!h)throw new Error(`Couldn't find bone ${r.bone} for slot ${a}`);let u=new yi(s.slots.length,a,h),f=T(r,"color",null);f&&u.color.setFromString(f);let m=T(r,"dark",null);m&&(u.darkColor=N.fromString(m)),u.attachmentName=T(r,"attachment",null),u.blendMode=O.enumValue(kt,T(r,"blend","normal")),u.visible=T(r,"visible",!0),u.path=c,s.slots.push(u)}if(i.ik)for(let o=0;o<i.ik.length;o++){let r=i.ik[o],c=new pi(r.name);c.order=T(r,"order",0),c.skinRequired=T(r,"skin",!1);for(let l=0;l<r.bones.length;l++){let h=s.findBone(r.bones[l]);if(!h)throw new Error(`Couldn't find bone ${r.bones[l]} for IK constraint ${r.name}.`);c.bones.push(h)}let a=s.findBone(r.target);if(!a)throw new Error(`Couldn't find target bone ${r.target} for IK constraint ${r.name}.`);c.target=a,c.mix=T(r,"mix",1),c.softness=T(r,"softness",0)*t,c.bendDirection=T(r,"bendPositive",!0)?1:-1,c.compress=T(r,"compress",!1),c.stretch=T(r,"stretch",!1),c.uniform=T(r,"uniform",!1),s.ikConstraints.push(c)}if(i.transform)for(let o=0;o<i.transform.length;o++){let r=i.transform[o],c=new vi(r.name);c.order=T(r,"order",0),c.skinRequired=T(r,"skin",!1);for(let h=0;h<r.bones.length;h++){let u=r.bones[h],f=s.findBone(u);if(!f)throw new Error(`Couldn't find bone ${u} for transform constraint ${r.name}.`);c.bones.push(f)}let a=r.target,l=s.findBone(a);if(!l)throw new Error(`Couldn't find target bone ${a} for transform constraint ${r.name}.`);c.target=l,c.local=T(r,"local",!1),c.relative=T(r,"relative",!1),c.offsetRotation=T(r,"rotation",0),c.offsetX=T(r,"x",0)*t,c.offsetY=T(r,"y",0)*t,c.offsetScaleX=T(r,"scaleX",0),c.offsetScaleY=T(r,"scaleY",0),c.offsetShearY=T(r,"shearY",0),c.mixRotate=T(r,"mixRotate",1),c.mixX=T(r,"mixX",1),c.mixY=T(r,"mixY",c.mixX),c.mixScaleX=T(r,"mixScaleX",1),c.mixScaleY=T(r,"mixScaleY",c.mixScaleX),c.mixShearY=T(r,"mixShearY",1),s.transformConstraints.push(c)}if(i.path)for(let o=0;o<i.path.length;o++){let r=i.path[o],c=new xi(r.name);c.order=T(r,"order",0),c.skinRequired=T(r,"skin",!1);for(let h=0;h<r.bones.length;h++){let u=r.bones[h],f=s.findBone(u);if(!f)throw new Error(`Couldn't find bone ${u} for path constraint ${r.name}.`);c.bones.push(f)}let a=r.target,l=s.findSlot(a);if(!l)throw new Error(`Couldn't find target slot ${a} for path constraint ${r.name}.`);c.target=l,c.positionMode=O.enumValue(Ge,T(r,"positionMode","Percent")),c.spacingMode=O.enumValue(ye,T(r,"spacingMode","Length")),c.rotateMode=O.enumValue(rt,T(r,"rotateMode","Tangent")),c.offsetRotation=T(r,"rotation",0),c.position=T(r,"position",0),c.positionMode==Ge.Fixed&&(c.position*=t),c.spacing=T(r,"spacing",0),(c.spacingMode==ye.Length||c.spacingMode==ye.Fixed)&&(c.spacing*=t),c.mixRotate=T(r,"mixRotate",1),c.mixX=T(r,"mixX",1),c.mixY=T(r,"mixY",c.mixX),s.pathConstraints.push(c)}if(i.physics)for(let o=0;o<i.physics.length;o++){const r=i.physics[o],c=new wi(r.name);c.order=T(r,"order",0),c.skinRequired=T(r,"skin",!1);const a=r.bone,l=s.findBone(a);if(l==null)throw new Error("Physics bone not found: "+a);c.bone=l,c.x=T(r,"x",0),c.y=T(r,"y",0),c.rotate=T(r,"rotate",0),c.scaleX=T(r,"scaleX",0),c.shearX=T(r,"shearX",0),c.limit=T(r,"limit",5e3)*t,c.step=1/T(r,"fps",60),c.inertia=T(r,"inertia",1),c.strength=T(r,"strength",100),c.damping=T(r,"damping",1),c.massInverse=1/T(r,"mass",1),c.wind=T(r,"wind",0),c.gravity=T(r,"gravity",0),c.mix=T(r,"mix",1),c.inertiaGlobal=T(r,"inertiaGlobal",!1),c.strengthGlobal=T(r,"strengthGlobal",!1),c.dampingGlobal=T(r,"dampingGlobal",!1),c.massGlobal=T(r,"massGlobal",!1),c.windGlobal=T(r,"windGlobal",!1),c.gravityGlobal=T(r,"gravityGlobal",!1),c.mixGlobal=T(r,"mixGlobal",!1),s.physicsConstraints.push(c)}if(i.skins)for(let o=0;o<i.skins.length;o++){let r=i.skins[o],c=new ns(r.name);if(r.bones)for(let a=0;a<r.bones.length;a++){let l=r.bones[a],h=s.findBone(l);if(!h)throw new Error(`Couldn't find bone ${l} for skin ${r.name}.`);c.bones.push(h)}if(r.ik)for(let a=0;a<r.ik.length;a++){let l=r.ik[a],h=s.findIkConstraint(l);if(!h)throw new Error(`Couldn't find IK constraint ${l} for skin ${r.name}.`);c.constraints.push(h)}if(r.transform)for(let a=0;a<r.transform.length;a++){let l=r.transform[a],h=s.findTransformConstraint(l);if(!h)throw new Error(`Couldn't find transform constraint ${l} for skin ${r.name}.`);c.constraints.push(h)}if(r.path)for(let a=0;a<r.path.length;a++){let l=r.path[a],h=s.findPathConstraint(l);if(!h)throw new Error(`Couldn't find path constraint ${l} for skin ${r.name}.`);c.constraints.push(h)}if(r.physics)for(let a=0;a<r.physics.length;a++){let l=r.physics[a],h=s.findPhysicsConstraint(l);if(!h)throw new Error(`Couldn't find physics constraint ${l} for skin ${r.name}.`);c.constraints.push(h)}for(let a in r.attachments){let l=s.findSlot(a);if(!l)throw new Error(`Couldn't find slot ${a} for skin ${r.name}.`);let h=r.attachments[a];for(let u in h){let f=this.readAttachment(h[u],c,l.index,u,s);f&&c.setAttachment(l.index,u,f)}}s.skins.push(c),c.name=="default"&&(s.defaultSkin=c)}for(let o=0,r=this.linkedMeshes.length;o<r;o++){let c=this.linkedMeshes[o],a=c.skin?s.findSkin(c.skin):s.defaultSkin;if(!a)throw new Error(`Skin not found: ${c.skin}`);let l=a.getAttachment(c.slotIndex,c.parent);if(!l)throw new Error(`Parent mesh not found: ${c.parent}`);c.mesh.timelineAttachment=c.inheritTimeline?l:c.mesh,c.mesh.setParentMesh(l),c.mesh.region!=null&&c.mesh.updateRegion()}if(this.linkedMeshes.length=0,i.events)for(let o in i.events){let r=i.events[o],c=new gi(o);c.intValue=T(r,"int",0),c.floatValue=T(r,"float",0),c.stringValue=T(r,"string",""),c.audioPath=T(r,"audio",null),c.audioPath&&(c.volume=T(r,"volume",1),c.balance=T(r,"balance",0)),s.events.push(c)}if(i.animations)for(let o in i.animations){let r=i.animations[o];this.readAnimation(r,o,s)}return s}readAttachment(e,t,s,i,n){let o=this.scale;switch(i=T(e,"name",i),T(e,"type","region")){case"region":{let r=T(e,"path",i),c=this.readSequence(T(e,"sequence",null)),a=this.attachmentLoader.newRegionAttachment(t,i,r,c);if(!a)return null;a.path=r,a.x=T(e,"x",0)*o,a.y=T(e,"y",0)*o,a.scaleX=T(e,"scaleX",1),a.scaleY=T(e,"scaleY",1),a.rotation=T(e,"rotation",0),a.width=e.width*o,a.height=e.height*o,a.sequence=c;let l=T(e,"color",null);return l&&a.color.setFromString(l),a.region!=null&&a.updateRegion(),a}case"boundingbox":{let r=this.attachmentLoader.newBoundingBoxAttachment(t,i);if(!r)return null;this.readVertices(e,r,e.vertexCount<<1);let c=T(e,"color",null);return c&&r.color.setFromString(c),r}case"mesh":case"linkedmesh":{let r=T(e,"path",i),c=this.readSequence(T(e,"sequence",null)),a=this.attachmentLoader.newMeshAttachment(t,i,r,c);if(!a)return null;a.path=r;let l=T(e,"color",null);l&&a.color.setFromString(l),a.width=T(e,"width",0)*o,a.height=T(e,"height",0)*o,a.sequence=c;let h=T(e,"parent",null);if(h)return this.linkedMeshes.push(new Rr(a,T(e,"skin",null),s,h,T(e,"timelines",!0))),a;let u=e.uvs;return this.readVertices(e,a,u.length),a.triangles=e.triangles,a.regionUVs=u,a.region!=null&&a.updateRegion(),a.edges=T(e,"edges",null),a.hullLength=T(e,"hull",0)*2,a}case"path":{let r=this.attachmentLoader.newPathAttachment(t,i);if(!r)return null;r.closed=T(e,"closed",!1),r.constantSpeed=T(e,"constantSpeed",!0);let c=e.vertexCount;this.readVertices(e,r,c<<1);let a=O.newArray(c/3,0);for(let h=0;h<e.lengths.length;h++)a[h]=e.lengths[h]*o;r.lengths=a;let l=T(e,"color",null);return l&&r.color.setFromString(l),r}case"point":{let r=this.attachmentLoader.newPointAttachment(t,i);if(!r)return null;r.x=T(e,"x",0)*o,r.y=T(e,"y",0)*o,r.rotation=T(e,"rotation",0);let c=T(e,"color",null);return c&&r.color.setFromString(c),r}case"clipping":{let r=this.attachmentLoader.newClippingAttachment(t,i);if(!r)return null;let c=T(e,"end",null);c&&(r.endSlot=n.findSlot(c));let a=e.vertexCount;this.readVertices(e,r,a<<1);let l=T(e,"color",null);return l&&r.color.setFromString(l),r}}return null}readSequence(e){if(e==null)return null;let t=new Xt(T(e,"count",0));return t.start=T(e,"start",1),t.digits=T(e,"digits",0),t.setupIndex=T(e,"setup",0),t}readVertices(e,t,s){let i=this.scale;t.worldVerticesLength=s;let n=e.vertices;if(s==n.length){let c=O.toFloatArray(n);if(i!=1)for(let a=0,l=n.length;a<l;a++)c[a]*=i;t.vertices=c;return}let o=new Array,r=new Array;for(let c=0,a=n.length;c<a;){let l=n[c++];r.push(l);for(let h=c+l*4;c<h;c+=4)r.push(n[c]),o.push(n[c+1]*i),o.push(n[c+2]*i),o.push(n[c+3])}t.bones=r,t.vertices=O.toFloatArray(o)}readAnimation(e,t,s){let i=this.scale,n=new Array;if(e.slots)for(let r in e.slots){let c=e.slots[r],a=s.findSlot(r);if(!a)throw new Error("Slot not found: "+r);let l=a.index;for(let h in c){let u=c[h];if(!u)continue;let f=u.length;if(h=="attachment"){let m=new dt(f,l);for(let g=0;g<f;g++){let p=u[g];m.setFrame(g,T(p,"time",0),T(p,"name",null))}n.push(m)}else if(h=="rgba"){let m=new js(f,f<<2,l),g=u[0],p=T(g,"time",0),x=N.fromString(g.color);for(let y=0,b=0;;y++){m.setFrame(y,p,x.r,x.g,x.b,x.a);let w=u[y+1];if(!w){m.shrink(b);break}let C=T(w,"time",0),v=N.fromString(w.color),A=g.curve;A&&(b=de(A,m,b,y,0,p,C,x.r,v.r,1),b=de(A,m,b,y,1,p,C,x.g,v.g,1),b=de(A,m,b,y,2,p,C,x.b,v.b,1),b=de(A,m,b,y,3,p,C,x.a,v.a,1)),p=C,x=v,g=w}n.push(m)}else if(h=="rgb"){let m=new Zs(f,f*3,l),g=u[0],p=T(g,"time",0),x=N.fromString(g.color);for(let y=0,b=0;;y++){m.setFrame(y,p,x.r,x.g,x.b);let w=u[y+1];if(!w){m.shrink(b);break}let C=T(w,"time",0),v=N.fromString(w.color),A=g.curve;A&&(b=de(A,m,b,y,0,p,C,x.r,v.r,1),b=de(A,m,b,y,1,p,C,x.g,v.g,1),b=de(A,m,b,y,2,p,C,x.b,v.b,1)),p=C,x=v,g=w}n.push(m)}else if(h=="alpha")n.push(Ve(u,new Js(f,f,l),0,1));else if(h=="rgba2"){let m=new Ks(f,f*7,l),g=u[0],p=T(g,"time",0),x=N.fromString(g.light),y=N.fromString(g.dark);for(let b=0,w=0;;b++){m.setFrame(b,p,x.r,x.g,x.b,x.a,y.r,y.g,y.b);let C=u[b+1];if(!C){m.shrink(w);break}let v=T(C,"time",0),A=N.fromString(C.light),I=N.fromString(C.dark),E=g.curve;E&&(w=de(E,m,w,b,0,p,v,x.r,A.r,1),w=de(E,m,w,b,1,p,v,x.g,A.g,1),w=de(E,m,w,b,2,p,v,x.b,A.b,1),w=de(E,m,w,b,3,p,v,x.a,A.a,1),w=de(E,m,w,b,4,p,v,y.r,I.r,1),w=de(E,m,w,b,5,p,v,y.g,I.g,1),w=de(E,m,w,b,6,p,v,y.b,I.b,1)),p=v,x=A,y=I,g=C}n.push(m)}else if(h=="rgb2"){let m=new Qs(f,f*6,l),g=u[0],p=T(g,"time",0),x=N.fromString(g.light),y=N.fromString(g.dark);for(let b=0,w=0;;b++){m.setFrame(b,p,x.r,x.g,x.b,y.r,y.g,y.b);let C=u[b+1];if(!C){m.shrink(w);break}let v=T(C,"time",0),A=N.fromString(C.light),I=N.fromString(C.dark),E=g.curve;E&&(w=de(E,m,w,b,0,p,v,x.r,A.r,1),w=de(E,m,w,b,1,p,v,x.g,A.g,1),w=de(E,m,w,b,2,p,v,x.b,A.b,1),w=de(E,m,w,b,3,p,v,y.r,I.r,1),w=de(E,m,w,b,4,p,v,y.g,I.g,1),w=de(E,m,w,b,5,p,v,y.b,I.b,1)),p=v,x=A,y=I,g=C}n.push(m)}}}if(e.bones)for(let r in e.bones){let c=e.bones[r],a=s.findBone(r);if(!a)throw new Error("Bone not found: "+r);let l=a.index;for(let h in c){let u=c[h],f=u.length;if(f!=0){if(h==="rotate")n.push(Ve(u,new Bt(f,f,l),0,1));else if(h==="translate"){let m=new Vs(f,f<<1,l);n.push($t(u,m,"x","y",0,i))}else if(h==="translatex"){let m=new Os(f,f,l);n.push(Ve(u,m,0,i))}else if(h==="translatey"){let m=new Ns(f,f,l);n.push(Ve(u,m,0,i))}else if(h==="scale"){let m=new Ds(f,f<<1,l);n.push($t(u,m,"x","y",1,1))}else if(h==="scalex"){let m=new Us(f,f,l);n.push(Ve(u,m,1,1))}else if(h==="scaley"){let m=new zs(f,f,l);n.push(Ve(u,m,1,1))}else if(h==="shear"){let m=new Ws(f,f<<1,l);n.push($t(u,m,"x","y",0,1))}else if(h==="shearx"){let m=new qs(f,f,l);n.push(Ve(u,m,0,1))}else if(h==="sheary"){let m=new Gs(f,f,l);n.push(Ve(u,m,0,1))}else if(h==="inherit"){let m=new Hs(f,a.index);for(let g=0;g<u.length;g++){let p=u[g];m.setFrame(g,T(p,"time",0),O.enumValue(xe,T(p,"inherit","Normal")))}n.push(m)}}}}if(e.ik)for(let r in e.ik){let c=e.ik[r],a=c[0];if(!a)continue;let l=s.findIkConstraint(r);if(!l)throw new Error("IK Constraint not found: "+r);let h=s.ikConstraints.indexOf(l),u=new $s(c.length,c.length<<1,h),f=T(a,"time",0),m=T(a,"mix",1),g=T(a,"softness",0)*i;for(let p=0,x=0;;p++){u.setFrame(p,f,m,g,T(a,"bendPositive",!0)?1:-1,T(a,"compress",!1),T(a,"stretch",!1));let y=c[p+1];if(!y){u.shrink(x);break}let b=T(y,"time",0),w=T(y,"mix",1),C=T(y,"softness",0)*i,v=a.curve;v&&(x=de(v,u,x,p,0,f,b,m,w,1),x=de(v,u,x,p,1,f,b,g,C,i)),f=b,m=w,g=C,a=y}n.push(u)}if(e.transform)for(let r in e.transform){let c=e.transform[r],a=c[0];if(!a)continue;let l=s.findTransformConstraint(r);if(!l)throw new Error("Transform constraint not found: "+r);let h=s.transformConstraints.indexOf(l),u=new ei(c.length,c.length*6,h),f=T(a,"time",0),m=T(a,"mixRotate",1),g=T(a,"mixX",1),p=T(a,"mixY",g),x=T(a,"mixScaleX",1),y=T(a,"mixScaleY",x),b=T(a,"mixShearY",1);for(let w=0,C=0;;w++){u.setFrame(w,f,m,g,p,x,y,b);let v=c[w+1];if(!v){u.shrink(C);break}let A=T(v,"time",0),I=T(v,"mixRotate",1),E=T(v,"mixX",1),F=T(v,"mixY",E),Y=T(v,"mixScaleX",1),L=T(v,"mixScaleY",Y),B=T(v,"mixShearY",1),P=a.curve;P&&(C=de(P,u,C,w,0,f,A,m,I,1),C=de(P,u,C,w,1,f,A,g,E,1),C=de(P,u,C,w,2,f,A,p,F,1),C=de(P,u,C,w,3,f,A,x,Y,1),C=de(P,u,C,w,4,f,A,y,L,1),C=de(P,u,C,w,5,f,A,b,B,1)),f=A,m=I,g=E,p=F,x=Y,y=L,x=Y,a=v}n.push(u)}if(e.path)for(let r in e.path){let c=e.path[r],a=s.findPathConstraint(r);if(!a)throw new Error("Path constraint not found: "+r);let l=s.pathConstraints.indexOf(a);for(let h in c){let u=c[h],f=u[0];if(!f)continue;let m=u.length;if(h==="position"){let g=new ti(m,m,l);n.push(Ve(u,g,0,a.positionMode==Ge.Fixed?i:1))}else if(h==="spacing"){let g=new si(m,m,l);n.push(Ve(u,g,0,a.spacingMode==ye.Length||a.spacingMode==ye.Fixed?i:1))}else if(h==="mix"){let g=new ii(m,m*3,l),p=T(f,"time",0),x=T(f,"mixRotate",1),y=T(f,"mixX",1),b=T(f,"mixY",y);for(let w=0,C=0;;w++){g.setFrame(w,p,x,y,b);let v=u[w+1];if(!v){g.shrink(C);break}let A=T(v,"time",0),I=T(v,"mixRotate",1),E=T(v,"mixX",1),F=T(v,"mixY",E),Y=f.curve;Y&&(C=de(Y,g,C,w,0,p,A,x,I,1),C=de(Y,g,C,w,1,p,A,y,E,1),C=de(Y,g,C,w,2,p,A,b,F,1)),p=A,x=I,y=E,b=F,f=v}n.push(g)}}}if(e.physics)for(let r in e.physics){let c=e.physics[r],a=-1;if(r.length>0){let l=s.findPhysicsConstraint(r);if(!l)throw new Error("Physics constraint not found: "+r);a=s.physicsConstraints.indexOf(l)}for(let l in c){let h=c[l],u=h[0];if(!u)continue;let f=h.length;if(l=="reset"){const g=new Pt(h.size,a);for(let p=0;u!=null;u=h[p+1],p++)g.setFrame(p,T(u,"time",0));n.push(g);continue}let m;if(l=="inertia")m=new ri(f,f,a);else if(l=="strength")m=new ni(f,f,a);else if(l=="damping")m=new ai(f,f,a);else if(l=="mass")m=new li(f,f,a);else if(l=="wind")m=new oi(f,f,a);else if(l=="gravity")m=new hi(f,f,a);else if(l=="mix")m=new ci(f,f,a);else continue;n.push(Ve(h,m,0,1))}}if(e.attachments)for(let r in e.attachments){let c=e.attachments[r],a=s.findSkin(r);if(!a)throw new Error("Skin not found: "+r);for(let l in c){let h=c[l],u=s.findSlot(l);if(!u)throw new Error("Slot not found: "+l);let f=u.index;for(let m in h){let g=h[m],p=a.getAttachment(f,m);for(let x in g){let y=g[x],b=y[0];if(b){if(x=="deform"){let w=p.bones,C=p.vertices,v=w?C.length/3*2:C.length,A=new _s(y.length,y.length,f,p),I=T(b,"time",0);for(let E=0,F=0;;E++){let Y,L=T(b,"vertices",null);if(!L)Y=w?O.newFloatArray(v):C;else{Y=O.newFloatArray(v);let M=T(b,"offset",0);if(O.arrayCopy(L,0,Y,M,L.length),i!=1)for(let D=M,re=D+L.length;D<re;D++)Y[D]*=i;if(!w)for(let D=0;D<v;D++)Y[D]+=C[D]}A.setFrame(E,I,Y);let B=y[E+1];if(!B){A.shrink(F);break}let P=T(B,"time",0),R=b.curve;R&&(F=de(R,A,F,E,0,I,P,0,1,1)),I=P,b=B}n.push(A)}else if(x=="sequence"){let w=new Vt(y.length,f,p),C=0;for(let v=0;v<y.length;v++){let A=T(b,"delay",C),I=T(b,"time",0),E=Ce[T(b,"mode","hold")],F=T(b,"index",0);w.setFrame(v,I,E,F,A),C=A,b=y[v+1]}n.push(w)}}}}}}if(e.drawOrder){let r=new it(e.drawOrder.length),c=s.slots.length,a=0;for(let l=0;l<e.drawOrder.length;l++,a++){let h=e.drawOrder[l],u=null,f=T(h,"offsets",null);if(f){u=O.newArray(c,-1);let m=O.newArray(c-f.length,0),g=0,p=0;for(let x=0;x<f.length;x++){let y=f[x],b=s.findSlot(y.slot);if(!b)throw new Error("Slot not found: "+b);let w=b.index;for(;g!=w;)m[p++]=g++;u[g+y.offset]=g++}for(;g<c;)m[p++]=g++;for(let x=c-1;x>=0;x--)u[x]==-1&&(u[x]=m[--p])}r.setFrame(a,T(h,"time",0),u)}n.push(r)}if(e.events){let r=new It(e.events.length),c=0;for(let a=0;a<e.events.length;a++,c++){let l=e.events[a],h=s.findEvent(l.name);if(!h)throw new Error("Event not found: "+l.name);let u=new mi(O.toSinglePrecision(T(l,"time",0)),h);u.intValue=T(l,"int",h.intValue),u.floatValue=T(l,"float",h.floatValue),u.stringValue=T(l,"string",h.stringValue),u.data.audioPath&&(u.volume=T(l,"volume",1),u.balance=T(l,"balance",0)),r.setFrame(c,u)}n.push(r)}let o=0;for(let r=0,c=n.length;r<c;r++)o=Math.max(o,n[r].getDuration());s.animations.push(new cs(t,n,o))}}class Rr{constructor(e,t,s,i,n){d(this,"parent");d(this,"skin");d(this,"slotIndex");d(this,"mesh");d(this,"inheritTimeline");this.mesh=e,this.skin=t,this.slotIndex=s,this.parent=i,this.inheritTimeline=n}}function Ve(S,e,t,s){let i=S[0],n=T(i,"time",0),o=T(i,"value",t)*s,r=0;for(let c=0;;c++){e.setFrame(c,n,o);let a=S[c+1];if(!a)return e.shrink(r),e;let l=T(a,"time",0),h=T(a,"value",t)*s;i.curve&&(r=de(i.curve,e,r,c,0,n,l,o,h,s)),n=l,o=h,i=a}}function $t(S,e,t,s,i,n){let o=S[0],r=T(o,"time",0),c=T(o,t,i)*n,a=T(o,s,i)*n,l=0;for(let h=0;;h++){e.setFrame(h,r,c,a);let u=S[h+1];if(!u)return e.shrink(l),e;let f=T(u,"time",0),m=T(u,t,i)*n,g=T(u,s,i)*n,p=o.curve;p&&(l=de(p,e,l,h,0,r,f,c,m,n),l=de(p,e,l,h,1,r,f,a,g,n)),r=f,c=m,a=g,o=u}}function de(S,e,t,s,i,n,o,r,c,a){if(S=="stepped")return e.setStepped(s),t;let l=i<<2,h=S[l],u=S[l+1]*a,f=S[l+2],m=S[l+3]*a;return e.setBezier(t,s,i,n,r,h,u,f,m,o,c),t+1}function T(S,e,t){return S[e]!==void 0?S[e]:t}typeof Math.fround>"u"&&(Math.fround=function(S){return function(e){return S[0]=e,S[0]}}(new Float32Array(1)));class Te{constructor(e,t={alpha:"true"}){d(this,"canvas");d(this,"gl");d(this,"restorables",new Array);if(e instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext)this.gl=e,this.canvas=this.gl.canvas;else{let s=e;this.gl=s.getContext("webgl2",t)||s.getContext("webgl",t),this.canvas=s,s.addEventListener("webglcontextlost",i=>{i&&i.preventDefault()}),s.addEventListener("webglcontextrestored",i=>{for(let n=0,o=this.restorables.length;n<o;n++)this.restorables[n].restore()})}}addRestorable(e){this.restorables.push(e)}removeRestorable(e){let t=this.restorables.indexOf(e);t>-1&&this.restorables.splice(t,1)}}const At=class At extends Vi{constructor(t,s,i=!1){super(s);d(this,"context");d(this,"texture",null);d(this,"boundUnit",0);d(this,"useMipMaps",!1);this.context=t instanceof Te?t:new Te(t),this.useMipMaps=i,this.restore(),this.context.addRestorable(this)}setFilters(t,s){let i=this.context.gl;this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,At.validateMagFilter(s)),this.useMipMaps=At.usesMipMaps(t),this.useMipMaps&&i.generateMipmap(i.TEXTURE_2D)}static validateMagFilter(t){switch(t){case we.MipMapLinearLinear:case we.MipMapLinearNearest:case we.MipMapNearestLinear:case we.MipMapNearestNearest:return we.Linear;default:return t}}static usesMipMaps(t){switch(t){case we.MipMapLinearLinear:case we.MipMapLinearNearest:case we.MipMapNearestLinear:case we.MipMapNearestNearest:return!0;default:return!1}}setWraps(t,s){let i=this.context.gl;this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,s)}update(t){let s=this.context.gl;this.texture||(this.texture=this.context.gl.createTexture()),this.bind(),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,this._image),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,t?s.LINEAR_MIPMAP_LINEAR:s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),t&&s.generateMipmap(s.TEXTURE_2D)}restore(){this.texture=null,this.update(this.useMipMaps)}bind(t=0){let s=this.context.gl;this.boundUnit=t,s.activeTexture(s.TEXTURE0+t),s.bindTexture(s.TEXTURE_2D,this.texture)}unbind(){let t=this.context.gl;t.activeTexture(t.TEXTURE0+this.boundUnit),t.bindTexture(t.TEXTURE_2D,null)}dispose(){this.context.removeRestorable(this),this.context.gl.deleteTexture(this.texture)}};d(At,"DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL",!1);let Et=At;class Fr extends Wi{constructor(e,t="",s=new ui){super(i=>new Et(e,i),t,s)}}class et{constructor(e=0,t=0,s=0){d(this,"x",0);d(this,"y",0);d(this,"z",0);this.x=e,this.y=t,this.z=s}setFrom(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}set(e,t,s){return this.x=e,this.y=t,this.z=s,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}scale(e){return this.x*=e,this.y*=e,this.z*=e,this}normalize(){let e=this.length();return e==0?this:(e=1/e,this.x*=e,this.y*=e,this.z*=e,this)}cross(e){return this.set(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}multiply(e){let t=e.values;return this.set(this.x*t[U]+this.y*t[j]+this.z*t[Z]+t[z],this.x*t[J]+this.y*t[W]+this.z*t[K]+t[q],this.x*t[Q]+this.y*t[_]+this.z*t[G]+t[H])}project(e){let t=e.values,s=1/(this.x*t[ee]+this.y*t[te]+this.z*t[se]+t[$]);return this.set((this.x*t[U]+this.y*t[j]+this.z*t[Z]+t[z])*s,(this.x*t[J]+this.y*t[W]+this.z*t[K]+t[q])*s,(this.x*t[Q]+this.y*t[_]+this.z*t[G]+t[H])*s)}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}distance(e){let t=e.x-this.x,s=e.y-this.y,i=e.z-this.z;return Math.sqrt(t*t+s*s+i*i)}}const U=0,j=4,Z=8,z=12,J=1,W=5,K=9,q=13,Q=2,_=6,G=10,H=14,ee=3,te=7,se=11,$=15,Ie=class Ie{constructor(){d(this,"temp",new Float32Array(16));d(this,"values",new Float32Array(16));let e=this.values;e[U]=1,e[W]=1,e[G]=1,e[$]=1}set(e){return this.values.set(e),this}transpose(){let e=this.temp,t=this.values;return e[U]=t[U],e[j]=t[J],e[Z]=t[Q],e[z]=t[ee],e[J]=t[j],e[W]=t[W],e[K]=t[_],e[q]=t[te],e[Q]=t[Z],e[_]=t[K],e[G]=t[G],e[H]=t[se],e[ee]=t[z],e[te]=t[q],e[se]=t[H],e[$]=t[$],this.set(e)}identity(){let e=this.values;return e[U]=1,e[j]=0,e[Z]=0,e[z]=0,e[J]=0,e[W]=1,e[K]=0,e[q]=0,e[Q]=0,e[_]=0,e[G]=1,e[H]=0,e[ee]=0,e[te]=0,e[se]=0,e[$]=1,this}invert(){let e=this.values,t=this.temp,s=e[ee]*e[_]*e[K]*e[z]-e[Q]*e[te]*e[K]*e[z]-e[ee]*e[W]*e[G]*e[z]+e[J]*e[te]*e[G]*e[z]+e[Q]*e[W]*e[se]*e[z]-e[J]*e[_]*e[se]*e[z]-e[ee]*e[_]*e[Z]*e[q]+e[Q]*e[te]*e[Z]*e[q]+e[ee]*e[j]*e[G]*e[q]-e[U]*e[te]*e[G]*e[q]-e[Q]*e[j]*e[se]*e[q]+e[U]*e[_]*e[se]*e[q]+e[ee]*e[W]*e[Z]*e[H]-e[J]*e[te]*e[Z]*e[H]-e[ee]*e[j]*e[K]*e[H]+e[U]*e[te]*e[K]*e[H]+e[J]*e[j]*e[se]*e[H]-e[U]*e[W]*e[se]*e[H]-e[Q]*e[W]*e[Z]*e[$]+e[J]*e[_]*e[Z]*e[$]+e[Q]*e[j]*e[K]*e[$]-e[U]*e[_]*e[K]*e[$]-e[J]*e[j]*e[G]*e[$]+e[U]*e[W]*e[G]*e[$];if(s==0)throw new Error("non-invertible matrix");let i=1/s;return t[U]=e[K]*e[H]*e[te]-e[q]*e[G]*e[te]+e[q]*e[_]*e[se]-e[W]*e[H]*e[se]-e[K]*e[_]*e[$]+e[W]*e[G]*e[$],t[j]=e[z]*e[G]*e[te]-e[Z]*e[H]*e[te]-e[z]*e[_]*e[se]+e[j]*e[H]*e[se]+e[Z]*e[_]*e[$]-e[j]*e[G]*e[$],t[Z]=e[Z]*e[q]*e[te]-e[z]*e[K]*e[te]+e[z]*e[W]*e[se]-e[j]*e[q]*e[se]-e[Z]*e[W]*e[$]+e[j]*e[K]*e[$],t[z]=e[z]*e[K]*e[_]-e[Z]*e[q]*e[_]-e[z]*e[W]*e[G]+e[j]*e[q]*e[G]+e[Z]*e[W]*e[H]-e[j]*e[K]*e[H],t[J]=e[q]*e[G]*e[ee]-e[K]*e[H]*e[ee]-e[q]*e[Q]*e[se]+e[J]*e[H]*e[se]+e[K]*e[Q]*e[$]-e[J]*e[G]*e[$],t[W]=e[Z]*e[H]*e[ee]-e[z]*e[G]*e[ee]+e[z]*e[Q]*e[se]-e[U]*e[H]*e[se]-e[Z]*e[Q]*e[$]+e[U]*e[G]*e[$],t[K]=e[z]*e[K]*e[ee]-e[Z]*e[q]*e[ee]-e[z]*e[J]*e[se]+e[U]*e[q]*e[se]+e[Z]*e[J]*e[$]-e[U]*e[K]*e[$],t[q]=e[Z]*e[q]*e[Q]-e[z]*e[K]*e[Q]+e[z]*e[J]*e[G]-e[U]*e[q]*e[G]-e[Z]*e[J]*e[H]+e[U]*e[K]*e[H],t[Q]=e[W]*e[H]*e[ee]-e[q]*e[_]*e[ee]+e[q]*e[Q]*e[te]-e[J]*e[H]*e[te]-e[W]*e[Q]*e[$]+e[J]*e[_]*e[$],t[_]=e[z]*e[_]*e[ee]-e[j]*e[H]*e[ee]-e[z]*e[Q]*e[te]+e[U]*e[H]*e[te]+e[j]*e[Q]*e[$]-e[U]*e[_]*e[$],t[G]=e[j]*e[q]*e[ee]-e[z]*e[W]*e[ee]+e[z]*e[J]*e[te]-e[U]*e[q]*e[te]-e[j]*e[J]*e[$]+e[U]*e[W]*e[$],t[H]=e[z]*e[W]*e[Q]-e[j]*e[q]*e[Q]-e[z]*e[J]*e[_]+e[U]*e[q]*e[_]+e[j]*e[J]*e[H]-e[U]*e[W]*e[H],t[ee]=e[K]*e[_]*e[ee]-e[W]*e[G]*e[ee]-e[K]*e[Q]*e[te]+e[J]*e[G]*e[te]+e[W]*e[Q]*e[se]-e[J]*e[_]*e[se],t[te]=e[j]*e[G]*e[ee]-e[Z]*e[_]*e[ee]+e[Z]*e[Q]*e[te]-e[U]*e[G]*e[te]-e[j]*e[Q]*e[se]+e[U]*e[_]*e[se],t[se]=e[Z]*e[W]*e[ee]-e[j]*e[K]*e[ee]-e[Z]*e[J]*e[te]+e[U]*e[K]*e[te]+e[j]*e[J]*e[se]-e[U]*e[W]*e[se],t[$]=e[j]*e[K]*e[Q]-e[Z]*e[W]*e[Q]+e[Z]*e[J]*e[_]-e[U]*e[K]*e[_]-e[j]*e[J]*e[G]+e[U]*e[W]*e[G],e[U]=t[U]*i,e[j]=t[j]*i,e[Z]=t[Z]*i,e[z]=t[z]*i,e[J]=t[J]*i,e[W]=t[W]*i,e[K]=t[K]*i,e[q]=t[q]*i,e[Q]=t[Q]*i,e[_]=t[_]*i,e[G]=t[G]*i,e[H]=t[H]*i,e[ee]=t[ee]*i,e[te]=t[te]*i,e[se]=t[se]*i,e[$]=t[$]*i,this}determinant(){let e=this.values;return e[ee]*e[_]*e[K]*e[z]-e[Q]*e[te]*e[K]*e[z]-e[ee]*e[W]*e[G]*e[z]+e[J]*e[te]*e[G]*e[z]+e[Q]*e[W]*e[se]*e[z]-e[J]*e[_]*e[se]*e[z]-e[ee]*e[_]*e[Z]*e[q]+e[Q]*e[te]*e[Z]*e[q]+e[ee]*e[j]*e[G]*e[q]-e[U]*e[te]*e[G]*e[q]-e[Q]*e[j]*e[se]*e[q]+e[U]*e[_]*e[se]*e[q]+e[ee]*e[W]*e[Z]*e[H]-e[J]*e[te]*e[Z]*e[H]-e[ee]*e[j]*e[K]*e[H]+e[U]*e[te]*e[K]*e[H]+e[J]*e[j]*e[se]*e[H]-e[U]*e[W]*e[se]*e[H]-e[Q]*e[W]*e[Z]*e[$]+e[J]*e[_]*e[Z]*e[$]+e[Q]*e[j]*e[K]*e[$]-e[U]*e[_]*e[K]*e[$]-e[J]*e[j]*e[G]*e[$]+e[U]*e[W]*e[G]*e[$]}translate(e,t,s){let i=this.values;return i[z]+=e,i[q]+=t,i[H]+=s,this}copy(){return new Ie().set(this.values)}projection(e,t,s,i){this.identity();let n=1/Math.tan(s*(Math.PI/180)/2),o=(t+e)/(e-t),r=2*t*e/(e-t),c=this.values;return c[U]=n/i,c[J]=0,c[Q]=0,c[ee]=0,c[j]=0,c[W]=n,c[_]=0,c[te]=0,c[Z]=0,c[K]=0,c[G]=o,c[se]=-1,c[z]=0,c[q]=0,c[H]=r,c[$]=0,this}ortho2d(e,t,s,i){return this.ortho(e,e+s,t,t+i,0,1)}ortho(e,t,s,i,n,o){this.identity();let r=2/(t-e),c=2/(i-s),a=-2/(o-n),l=-(t+e)/(t-e),h=-(i+s)/(i-s),u=-(o+n)/(o-n),f=this.values;return f[U]=r,f[J]=0,f[Q]=0,f[ee]=0,f[j]=0,f[W]=c,f[_]=0,f[te]=0,f[Z]=0,f[K]=0,f[G]=a,f[se]=0,f[z]=l,f[q]=h,f[H]=u,f[$]=1,this}multiply(e){let t=this.temp,s=this.values,i=e.values;return t[U]=s[U]*i[U]+s[j]*i[J]+s[Z]*i[Q]+s[z]*i[ee],t[j]=s[U]*i[j]+s[j]*i[W]+s[Z]*i[_]+s[z]*i[te],t[Z]=s[U]*i[Z]+s[j]*i[K]+s[Z]*i[G]+s[z]*i[se],t[z]=s[U]*i[z]+s[j]*i[q]+s[Z]*i[H]+s[z]*i[$],t[J]=s[J]*i[U]+s[W]*i[J]+s[K]*i[Q]+s[q]*i[ee],t[W]=s[J]*i[j]+s[W]*i[W]+s[K]*i[_]+s[q]*i[te],t[K]=s[J]*i[Z]+s[W]*i[K]+s[K]*i[G]+s[q]*i[se],t[q]=s[J]*i[z]+s[W]*i[q]+s[K]*i[H]+s[q]*i[$],t[Q]=s[Q]*i[U]+s[_]*i[J]+s[G]*i[Q]+s[H]*i[ee],t[_]=s[Q]*i[j]+s[_]*i[W]+s[G]*i[_]+s[H]*i[te],t[G]=s[Q]*i[Z]+s[_]*i[K]+s[G]*i[G]+s[H]*i[se],t[H]=s[Q]*i[z]+s[_]*i[q]+s[G]*i[H]+s[H]*i[$],t[ee]=s[ee]*i[U]+s[te]*i[J]+s[se]*i[Q]+s[$]*i[ee],t[te]=s[ee]*i[j]+s[te]*i[W]+s[se]*i[_]+s[$]*i[te],t[se]=s[ee]*i[Z]+s[te]*i[K]+s[se]*i[G]+s[$]*i[se],t[$]=s[ee]*i[z]+s[te]*i[q]+s[se]*i[H]+s[$]*i[$],this.set(this.temp)}multiplyLeft(e){let t=this.temp,s=this.values,i=e.values;return t[U]=i[U]*s[U]+i[j]*s[J]+i[Z]*s[Q]+i[z]*s[ee],t[j]=i[U]*s[j]+i[j]*s[W]+i[Z]*s[_]+i[z]*s[te],t[Z]=i[U]*s[Z]+i[j]*s[K]+i[Z]*s[G]+i[z]*s[se],t[z]=i[U]*s[z]+i[j]*s[q]+i[Z]*s[H]+i[z]*s[$],t[J]=i[J]*s[U]+i[W]*s[J]+i[K]*s[Q]+i[q]*s[ee],t[W]=i[J]*s[j]+i[W]*s[W]+i[K]*s[_]+i[q]*s[te],t[K]=i[J]*s[Z]+i[W]*s[K]+i[K]*s[G]+i[q]*s[se],t[q]=i[J]*s[z]+i[W]*s[q]+i[K]*s[H]+i[q]*s[$],t[Q]=i[Q]*s[U]+i[_]*s[J]+i[G]*s[Q]+i[H]*s[ee],t[_]=i[Q]*s[j]+i[_]*s[W]+i[G]*s[_]+i[H]*s[te],t[G]=i[Q]*s[Z]+i[_]*s[K]+i[G]*s[G]+i[H]*s[se],t[H]=i[Q]*s[z]+i[_]*s[q]+i[G]*s[H]+i[H]*s[$],t[ee]=i[ee]*s[U]+i[te]*s[J]+i[se]*s[Q]+i[$]*s[ee],t[te]=i[ee]*s[j]+i[te]*s[W]+i[se]*s[_]+i[$]*s[te],t[se]=i[ee]*s[Z]+i[te]*s[K]+i[se]*s[G]+i[$]*s[se],t[$]=i[ee]*s[z]+i[te]*s[q]+i[se]*s[H]+i[$]*s[$],this.set(this.temp)}lookAt(e,t,s){let i=Ie.xAxis,n=Ie.yAxis,o=Ie.zAxis;o.setFrom(t).normalize(),i.setFrom(t).normalize(),i.cross(s).normalize(),n.setFrom(i).cross(o).normalize(),this.identity();let r=this.values;return r[U]=i.x,r[j]=i.y,r[Z]=i.z,r[J]=n.x,r[W]=n.y,r[K]=n.z,r[Q]=-o.x,r[_]=-o.y,r[G]=-o.z,Ie.tmpMatrix.identity(),Ie.tmpMatrix.values[z]=-e.x,Ie.tmpMatrix.values[q]=-e.y,Ie.tmpMatrix.values[H]=-e.z,this.multiply(Ie.tmpMatrix),this}};d(Ie,"xAxis",new et),d(Ie,"yAxis",new et),d(Ie,"zAxis",new et),d(Ie,"tmpMatrix",new Ie);let ft=Ie;class Yr{constructor(e,t){d(this,"position",new et(0,0,0));d(this,"direction",new et(0,0,-1));d(this,"up",new et(0,1,0));d(this,"near",0);d(this,"far",100);d(this,"zoom",1);d(this,"viewportWidth",0);d(this,"viewportHeight",0);d(this,"projectionView",new ft);d(this,"inverseProjectionView",new ft);d(this,"projection",new ft);d(this,"view",new ft);this.viewportWidth=e,this.viewportHeight=t,this.update()}update(){let e=this.projection,t=this.view,s=this.projectionView,i=this.inverseProjectionView,n=this.zoom,o=this.viewportWidth,r=this.viewportHeight;e.ortho(n*(-o/2),n*(o/2),n*(-r/2),n*(r/2),this.near,this.far),t.lookAt(this.position,this.direction,this.up),s.set(e.values),s.multiply(t),i.set(s.values).invert()}screenToWorld(e,t,s){let i=e.x,n=s-e.y-1;return e.x=2*i/t-1,e.y=2*n/s-1,e.z=2*e.z-1,e.project(this.inverseProjectionView),e}worldToScreen(e,t,s){return e.project(this.projectionView),e.x=t*(e.x+1)/2,e.y=s*(e.y+1)/2,e.z=(e.z+1)/2,e}setViewport(e,t){this.viewportWidth=e,this.viewportHeight=t}}class Ci{constructor(e){d(this,"element");d(this,"mouseX",0);d(this,"mouseY",0);d(this,"buttonDown",!1);d(this,"touch0",null);d(this,"touch1",null);d(this,"initialPinchDistance",0);d(this,"listeners",new Array);d(this,"eventListeners",[]);this.element=e,this.setupCallbacks(e)}setupCallbacks(e){let t=r=>{if(r instanceof MouseEvent){let c=e.getBoundingClientRect();this.mouseX=r.clientX-c.left,this.mouseY=r.clientY-c.top,this.buttonDown=!0,this.listeners.map(a=>{a.down&&a.down(this.mouseX,this.mouseY)}),document.addEventListener("mousemove",s),document.addEventListener("mouseup",i)}},s=r=>{if(r instanceof MouseEvent){let c=e.getBoundingClientRect();this.mouseX=r.clientX-c.left,this.mouseY=r.clientY-c.top,this.listeners.map(a=>{this.buttonDown?a.dragged&&a.dragged(this.mouseX,this.mouseY):a.moved&&a.moved(this.mouseX,this.mouseY)})}},i=r=>{if(r instanceof MouseEvent){let c=e.getBoundingClientRect();this.mouseX=r.clientX-c.left,this.mouseY=r.clientY-c.top,this.buttonDown=!1,this.listeners.map(a=>{a.up&&a.up(this.mouseX,this.mouseY)}),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",i)}},n=r=>{r.preventDefault(),r.deltaY,r.deltaMode==WheelEvent.DOM_DELTA_LINE,r.deltaMode==WheelEvent.DOM_DELTA_PAGE,this.listeners.map(c=>{c.wheel&&c.wheel(r.deltaY)})};e.addEventListener("mousedown",t,!0),e.addEventListener("mousemove",s,!0),e.addEventListener("mouseup",i,!0),e.addEventListener("wheel",n,!0),e.addEventListener("touchstart",r=>{if(!this.touch0||!this.touch1){var c=r.changedTouches;let a=c.item(0);if(!a)return;let l=e.getBoundingClientRect(),h=a.clientX-l.left,u=a.clientY-l.top,f=new Lr(a.identifier,h,u);if(this.mouseX=h,this.mouseY=u,this.buttonDown=!0,!this.touch0)this.touch0=f,this.listeners.map(m=>{m.down&&m.down(f.x,f.y)});else if(!this.touch1){this.touch1=f;let m=this.touch1.x-this.touch0.x,g=this.touch1.x-this.touch0.x;this.initialPinchDistance=Math.sqrt(m*m+g*g),this.listeners.map(p=>{p.zoom&&p.zoom(this.initialPinchDistance,this.initialPinchDistance)})}}r.preventDefault()},!1),e.addEventListener("touchmove",r=>{if(this.touch0){var c=r.changedTouches;let h=e.getBoundingClientRect();for(var a=0;a<c.length;a++){var l=c[a];let u=l.clientX-h.left,f=l.clientY-h.top;this.touch0.identifier===l.identifier&&(this.touch0.x=this.mouseX=u,this.touch0.y=this.mouseY=f,this.listeners.map(m=>{m.dragged&&m.dragged(u,f)})),this.touch1&&this.touch1.identifier===l.identifier&&(this.touch1.x=this.mouseX=u,this.touch1.y=this.mouseY=f)}if(this.touch0&&this.touch1){let u=this.touch1.x-this.touch0.x,f=this.touch1.x-this.touch0.x,m=Math.sqrt(u*u+f*f);this.listeners.map(g=>{g.zoom&&g.zoom(this.initialPinchDistance,m)})}}r.preventDefault()},!1);let o=r=>{if(this.touch0){var c=r.changedTouches;let h=e.getBoundingClientRect();for(var a=0;a<c.length;a++){var l=c[a];let u=l.clientX-h.left,f=l.clientY-h.top;if(this.touch0.identifier===l.identifier)if(this.touch0=null,this.mouseX=u,this.mouseY=f,this.listeners.map(m=>{m.up&&m.up(u,f)}),this.touch1)this.touch0=this.touch1,this.touch1=null,this.mouseX=this.touch0.x,this.mouseX=this.touch0.x,this.buttonDown=!0,this.listeners.map(m=>{m.down&&m.down(this.touch0.x,this.touch0.y)});else{this.buttonDown=!1;break}this.touch1&&this.touch1.identifier&&(this.touch1=null)}}r.preventDefault()};e.addEventListener("touchend",o,!1),e.addEventListener("touchcancel",o)}addListener(e){this.listeners.push(e)}removeListener(e){let t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}}class Lr{constructor(e,t,s){d(this,"identifier");d(this,"x");d(this,"y");this.identifier=e,this.x=t,this.y=s}}const ce=class ce{constructor(e,t,s){d(this,"vertexShader");d(this,"fragmentShader");d(this,"context");d(this,"vs",null);d(this,"vsSource");d(this,"fs",null);d(this,"fsSource");d(this,"program",null);d(this,"tmp2x2",new Float32Array(2*2));d(this,"tmp3x3",new Float32Array(3*3));d(this,"tmp4x4",new Float32Array(4*4));this.vertexShader=t,this.fragmentShader=s,this.vsSource=t,this.fsSource=s,this.context=e instanceof Te?e:new Te(e),this.context.addRestorable(this),this.compile()}getProgram(){return this.program}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}getVertexShaderSource(){return this.vsSource}getFragmentSource(){return this.fsSource}compile(){let e=this.context.gl;try{if(this.vs=this.compileShader(e.VERTEX_SHADER,this.vertexShader),!this.vs)throw new Error("Couldn't compile vertex shader.");if(this.fs=this.compileShader(e.FRAGMENT_SHADER,this.fragmentShader),!this.fs)throw new Error("Couldn#t compile fragment shader.");this.program=this.compileProgram(this.vs,this.fs)}catch(t){throw this.dispose(),t}}compileShader(e,t){let s=this.context.gl,i=s.createShader(e);if(!i)throw new Error("Couldn't create shader.");if(s.shaderSource(i,t),s.compileShader(i),!s.getShaderParameter(i,s.COMPILE_STATUS)){let n="Couldn't compile shader: "+s.getShaderInfoLog(i);if(s.deleteShader(i),!s.isContextLost())throw new Error(n)}return i}compileProgram(e,t){let s=this.context.gl,i=s.createProgram();if(!i)throw new Error("Couldn't compile program.");if(s.attachShader(i,e),s.attachShader(i,t),s.linkProgram(i),!s.getProgramParameter(i,s.LINK_STATUS)){let n="Couldn't compile shader program: "+s.getProgramInfoLog(i);if(s.deleteProgram(i),!s.isContextLost())throw new Error(n)}return i}restore(){this.compile()}bind(){this.context.gl.useProgram(this.program)}unbind(){this.context.gl.useProgram(null)}setUniformi(e,t){this.context.gl.uniform1i(this.getUniformLocation(e),t)}setUniformf(e,t){this.context.gl.uniform1f(this.getUniformLocation(e),t)}setUniform2f(e,t,s){this.context.gl.uniform2f(this.getUniformLocation(e),t,s)}setUniform3f(e,t,s,i){this.context.gl.uniform3f(this.getUniformLocation(e),t,s,i)}setUniform4f(e,t,s,i,n){this.context.gl.uniform4f(this.getUniformLocation(e),t,s,i,n)}setUniform2x2f(e,t){let s=this.context.gl;this.tmp2x2.set(t),s.uniformMatrix2fv(this.getUniformLocation(e),!1,this.tmp2x2)}setUniform3x3f(e,t){let s=this.context.gl;this.tmp3x3.set(t),s.uniformMatrix3fv(this.getUniformLocation(e),!1,this.tmp3x3)}setUniform4x4f(e,t){let s=this.context.gl;this.tmp4x4.set(t),s.uniformMatrix4fv(this.getUniformLocation(e),!1,this.tmp4x4)}getUniformLocation(e){let t=this.context.gl;if(!this.program)throw new Error("Shader not compiled.");let s=t.getUniformLocation(this.program,e);if(!s&&!t.isContextLost())throw new Error(`Couldn't find location for uniform ${e}`);return s}getAttributeLocation(e){let t=this.context.gl;if(!this.program)throw new Error("Shader not compiled.");let s=t.getAttribLocation(this.program,e);if(s==-1&&!t.isContextLost())throw new Error(`Couldn't find location for attribute ${e}`);return s}dispose(){this.context.removeRestorable(this);let e=this.context.gl;this.vs&&(e.deleteShader(this.vs),this.vs=null),this.fs&&(e.deleteShader(this.fs),this.fs=null),this.program&&(e.deleteProgram(this.program),this.program=null)}static newColoredTextured(e){let t=`
attribute vec4 ${ce.POSITION};
attribute vec4 ${ce.COLOR};
attribute vec2 ${ce.TEXCOORDS};
uniform mat4 ${ce.MVP_MATRIX};
varying vec4 v_color;
varying vec2 v_texCoords;

void main () {
	v_color = ${ce.COLOR};
	v_texCoords = ${ce.TEXCOORDS};
	gl_Position = ${ce.MVP_MATRIX} * ${ce.POSITION};
}
`,s=`
#ifdef GL_ES
	#define LOWP lowp
	precision mediump float;
#else
	#define LOWP
#endif
varying LOWP vec4 v_color;
varying vec2 v_texCoords;
uniform sampler2D u_texture;

void main () {
	gl_FragColor = v_color * texture2D(u_texture, v_texCoords);
}
`;return new ce(e,t,s)}static newTwoColoredTextured(e){let t=`
attribute vec4 ${ce.POSITION};
attribute vec4 ${ce.COLOR};
attribute vec4 ${ce.COLOR2};
attribute vec2 ${ce.TEXCOORDS};
uniform mat4 ${ce.MVP_MATRIX};
varying vec4 v_light;
varying vec4 v_dark;
varying vec2 v_texCoords;

void main () {
	v_light = ${ce.COLOR};
	v_dark = ${ce.COLOR2};
	v_texCoords = ${ce.TEXCOORDS};
	gl_Position = ${ce.MVP_MATRIX} * ${ce.POSITION};
}
`,s=`
#ifdef GL_ES
	#define LOWP lowp
	precision mediump float;
#else
	#define LOWP
#endif
varying LOWP vec4 v_light;
varying LOWP vec4 v_dark;
varying vec2 v_texCoords;
uniform sampler2D u_texture;

void main () {
	vec4 texColor = texture2D(u_texture, v_texCoords);
	gl_FragColor.a = texColor.a * v_light.a;
	gl_FragColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;
}
`;return new ce(e,t,s)}static newColored(e){let t=`
attribute vec4 ${ce.POSITION};
attribute vec4 ${ce.COLOR};
uniform mat4 ${ce.MVP_MATRIX};
varying vec4 v_color;

void main () {
	v_color = ${ce.COLOR};
	gl_Position = ${ce.MVP_MATRIX} * ${ce.POSITION};
}
`,s=`
#ifdef GL_ES
	#define LOWP lowp
	precision mediump float;
#else
	#define LOWP
#endif
varying LOWP vec4 v_color;

void main () {
	gl_FragColor = v_color;
}
`;return new ce(e,t,s)}};d(ce,"MVP_MATRIX","u_projTrans"),d(ce,"POSITION","a_position"),d(ce,"COLOR","a_color"),d(ce,"COLOR2","a_color2"),d(ce,"TEXCOORDS","a_texCoords"),d(ce,"SAMPLER","u_texture");let Ne=ce;class Si{constructor(e,t,s,i){d(this,"attributes");d(this,"context");d(this,"vertices");d(this,"verticesBuffer",null);d(this,"verticesLength",0);d(this,"dirtyVertices",!1);d(this,"indices");d(this,"indicesBuffer",null);d(this,"indicesLength",0);d(this,"dirtyIndices",!1);d(this,"elementsPerVertex",0);this.attributes=t,this.context=e instanceof Te?e:new Te(e),this.elementsPerVertex=0;for(let n=0;n<t.length;n++)this.elementsPerVertex+=t[n].numElements;this.vertices=new Float32Array(s*this.elementsPerVertex),this.indices=new Uint16Array(i),this.context.addRestorable(this)}getAttributes(){return this.attributes}maxVertices(){return this.vertices.length/this.elementsPerVertex}numVertices(){return this.verticesLength/this.elementsPerVertex}setVerticesLength(e){this.dirtyVertices=!0,this.verticesLength=e}getVertices(){return this.vertices}maxIndices(){return this.indices.length}numIndices(){return this.indicesLength}setIndicesLength(e){this.dirtyIndices=!0,this.indicesLength=e}getIndices(){return this.indices}getVertexSizeInFloats(){let e=0;for(var t=0;t<this.attributes.length;t++){let s=this.attributes[t];e+=s.numElements}return e}setVertices(e){if(this.dirtyVertices=!0,e.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(e,0),this.verticesLength=e.length}setIndices(e){if(this.dirtyIndices=!0,e.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(e,0),this.indicesLength=e.length}draw(e,t){this.drawWithOffset(e,t,0,this.indicesLength>0?this.indicesLength:this.verticesLength/this.elementsPerVertex)}drawWithOffset(e,t,s,i){let n=this.context.gl;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(e),this.indicesLength>0?n.drawElements(t,i,n.UNSIGNED_SHORT,s*2):n.drawArrays(t,s,i),this.unbind(e)}bind(e){let t=this.context.gl;t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer);let s=0;for(let i=0;i<this.attributes.length;i++){let n=this.attributes[i],o=e.getAttributeLocation(n.name);t.enableVertexAttribArray(o),t.vertexAttribPointer(o,n.numElements,t.FLOAT,!1,this.elementsPerVertex*4,s*4),s+=n.numElements}this.indicesLength>0&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)}unbind(e){let t=this.context.gl;for(let s=0;s<this.attributes.length;s++){let i=this.attributes[s],n=e.getAttributeLocation(i.name);t.disableVertexAttribArray(n)}t.bindBuffer(t.ARRAY_BUFFER,null),this.indicesLength>0&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}update(){let e=this.context.gl;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,this.verticesBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),e.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=e.createBuffer()),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),e.DYNAMIC_DRAW),this.dirtyIndices=!1)}restore(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()}dispose(){this.context.removeRestorable(this);let e=this.context.gl;e.deleteBuffer(this.verticesBuffer),e.deleteBuffer(this.indicesBuffer)}}class jt{constructor(e,t,s){d(this,"name");d(this,"type");d(this,"numElements");this.name=e,this.type=t,this.numElements=s}}class as extends jt{constructor(){super(Ne.POSITION,wt.Float,2)}}class Ss extends jt{constructor(e=0){super(Ne.TEXCOORDS+(e==0?"":e),wt.Float,2)}}class ls extends jt{constructor(){super(Ne.COLOR,wt.Float,4)}}class Xr extends jt{constructor(){super(Ne.COLOR2,wt.Float,4)}}var wt;(function(S){S[S.Float=0]="Float"})(wt||(wt={}));const je=1,Br=769,As=770,Is=771,ks=774,Ke=class Ke{constructor(e,t=!0,s=10920){d(this,"context");d(this,"drawCalls",0);d(this,"isDrawing",!1);d(this,"mesh");d(this,"shader",null);d(this,"lastTexture",null);d(this,"verticesLength",0);d(this,"indicesLength",0);d(this,"srcColorBlend");d(this,"srcAlphaBlend");d(this,"dstBlend");d(this,"cullWasEnabled",!1);if(s>10920)throw new Error("Can't have more than 10920 triangles per batch: "+s);this.context=e instanceof Te?e:new Te(e);let i=t?[new as,new ls,new Ss,new Xr]:[new as,new ls,new Ss];this.mesh=new Si(e,i,s,s*3);let n=this.context.gl;this.srcColorBlend=n.SRC_ALPHA,this.srcAlphaBlend=n.ONE,this.dstBlend=n.ONE_MINUS_SRC_ALPHA}begin(e){if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0,this.shader=e,this.lastTexture=null,this.isDrawing=!0;let t=this.context.gl;t.enable(t.BLEND),t.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}setBlendMode(e,t){const s=Ke.blendModesGL[e],i=t?s.srcRgbPma:s.srcRgb,n=s.srcAlpha,o=s.dstRgb;if(this.srcColorBlend==i&&this.srcAlphaBlend==n&&this.dstBlend==o)return;this.srcColorBlend=i,this.srcAlphaBlend=n,this.dstBlend=o,this.isDrawing&&this.flush(),this.context.gl.blendFuncSeparate(i,o,n,o)}draw(e,t,s){e!=this.lastTexture?(this.flush(),this.lastTexture=e):(this.verticesLength+t.length>this.mesh.getVertices().length||this.indicesLength+s.length>this.mesh.getIndices().length)&&this.flush();let i=this.mesh.numVertices();this.mesh.getVertices().set(t,this.verticesLength),this.verticesLength+=t.length,this.mesh.setVerticesLength(this.verticesLength);let n=this.mesh.getIndices();for(let o=this.indicesLength,r=0;r<s.length;o++,r++)n[o]=s[r]+i;this.indicesLength+=s.length,this.mesh.setIndicesLength(this.indicesLength)}flush(){if(this.verticesLength!=0){if(!this.lastTexture)throw new Error("No texture set.");if(!this.shader)throw new Error("No shader set.");this.lastTexture.bind(),this.mesh.draw(this.shader,this.context.gl.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++,Ke.globalDrawCalls++}}end(){if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(this.verticesLength>0||this.indicesLength>0)&&this.flush(),this.shader=null,this.lastTexture=null,this.isDrawing=!1;let e=this.context.gl;e.disable(e.BLEND)}getDrawCalls(){return this.drawCalls}static getAndResetGlobalDrawCalls(){let e=Ke.globalDrawCalls;return Ke.globalDrawCalls=0,e}dispose(){this.mesh.dispose()}};d(Ke,"disableCulling",!1),d(Ke,"globalDrawCalls",0),d(Ke,"blendModesGL",[{srcRgb:As,srcRgbPma:je,dstRgb:Is,srcAlpha:je},{srcRgb:As,srcRgbPma:je,dstRgb:je,srcAlpha:je},{srcRgb:ks,srcRgbPma:ks,dstRgb:Is,srcAlpha:je},{srcRgb:je,srcRgbPma:je,dstRgb:Br,srcAlpha:je}]);let Nt=Ke;class Es{constructor(e,t=10920){d(this,"context");d(this,"isDrawing",!1);d(this,"mesh");d(this,"shapeType",ke.Filled);d(this,"color",new N(1,1,1,1));d(this,"shader",null);d(this,"vertexIndex",0);d(this,"tmp",new qe);d(this,"srcColorBlend");d(this,"srcAlphaBlend");d(this,"dstBlend");if(t>10920)throw new Error("Can't have more than 10920 triangles per batch: "+t);this.context=e instanceof Te?e:new Te(e),this.mesh=new Si(e,[new as,new ls],t,0);let s=this.context.gl;this.srcColorBlend=s.SRC_ALPHA,this.srcAlphaBlend=s.ONE,this.dstBlend=s.ONE_MINUS_SRC_ALPHA}begin(e){if(this.isDrawing)throw new Error("ShapeRenderer.begin() has already been called");this.shader=e,this.vertexIndex=0,this.isDrawing=!0;let t=this.context.gl;t.enable(t.BLEND),t.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}setBlendMode(e,t,s){this.srcColorBlend=e,this.srcAlphaBlend=t,this.dstBlend=s,this.isDrawing&&(this.flush(),this.context.gl.blendFuncSeparate(e,s,t,s))}setColor(e){this.color.setFromColor(e)}setColorWith(e,t,s,i){this.color.set(e,t,s,i)}point(e,t,s){this.check(ke.Point,1),s||(s=this.color),this.vertex(e,t,s)}line(e,t,s,i,n){this.check(ke.Line,2),this.mesh.getVertices(),this.vertexIndex,n||(n=this.color),this.vertex(e,t,n),this.vertex(s,i,n)}triangle(e,t,s,i,n,o,r,c,a,l){this.check(e?ke.Filled:ke.Line,3),this.mesh.getVertices(),this.vertexIndex,c||(c=this.color),a||(a=this.color),l||(l=this.color),e?(this.vertex(t,s,c),this.vertex(i,n,a),this.vertex(o,r,l)):(this.vertex(t,s,c),this.vertex(i,n,a),this.vertex(i,n,c),this.vertex(o,r,a),this.vertex(o,r,c),this.vertex(t,s,a))}quad(e,t,s,i,n,o,r,c,a,l,h,u,f){this.check(e?ke.Filled:ke.Line,3),this.mesh.getVertices(),this.vertexIndex,l||(l=this.color),h||(h=this.color),u||(u=this.color),f||(f=this.color),e?(this.vertex(t,s,l),this.vertex(i,n,h),this.vertex(o,r,u),this.vertex(o,r,u),this.vertex(c,a,f),this.vertex(t,s,l)):(this.vertex(t,s,l),this.vertex(i,n,h),this.vertex(i,n,h),this.vertex(o,r,u),this.vertex(o,r,u),this.vertex(c,a,f),this.vertex(c,a,f),this.vertex(t,s,l))}rect(e,t,s,i,n,o){this.quad(e,t,s,t+i,s,t+i,s+n,t,s+n,o,o,o,o)}rectLine(e,t,s,i,n,o,r){this.check(e?ke.Filled:ke.Line,8),r||(r=this.color);let c=this.tmp.set(n-s,t-i);c.normalize(),o*=.5;let a=c.x*o,l=c.y*o;e?(this.vertex(t+a,s+l,r),this.vertex(t-a,s-l,r),this.vertex(i+a,n+l,r),this.vertex(i-a,n-l,r),this.vertex(i+a,n+l,r),this.vertex(t-a,s-l,r)):(this.vertex(t+a,s+l,r),this.vertex(t-a,s-l,r),this.vertex(i+a,n+l,r),this.vertex(i-a,n-l,r),this.vertex(i+a,n+l,r),this.vertex(t+a,s+l,r),this.vertex(i-a,n-l,r),this.vertex(t-a,s-l,r))}x(e,t,s){this.line(e-s,t-s,e+s,t+s),this.line(e-s,t+s,e+s,t-s)}polygon(e,t,s,i){if(s<3)throw new Error("Polygon must contain at least 3 vertices");this.check(ke.Line,s*2),i||(i=this.color),this.mesh.getVertices(),this.vertexIndex,t<<=1,s<<=1;let n=e[t],o=e[t+1],r=t+s;for(let c=t,a=t+s-2;c<a;c+=2){let l=e[c],h=e[c+1],u=0,f=0;c+2>=r?(u=n,f=o):(u=e[c+2],f=e[c+3]),this.vertex(l,h,i),this.vertex(u,f,i)}}circle(e,t,s,i,n,o=0){if(o==0&&(o=Math.max(1,6*V.cbrt(i)|0)),o<=0)throw new Error("segments must be > 0.");n||(n=this.color);let r=2*V.PI/o,c=Math.cos(r),a=Math.sin(r),l=i,h=0;if(e){this.check(ke.Filled,o*3+3),o--;for(let u=0;u<o;u++){this.vertex(t,s,n),this.vertex(t+l,s+h,n);let f=l;l=c*l-a*h,h=a*f+c*h,this.vertex(t+l,s+h,n)}this.vertex(t,s,n),this.vertex(t+l,s+h,n)}else{this.check(ke.Line,o*2+2);for(let u=0;u<o;u++){this.vertex(t+l,s+h,n);let f=l;l=c*l-a*h,h=a*f+c*h,this.vertex(t+l,s+h,n)}this.vertex(t+l,s+h,n)}l=i,h=0,this.vertex(t+l,s+h,n)}curve(e,t,s,i,n,o,r,c,a,l){this.check(ke.Line,a*2+2),l||(l=this.color);let h=1/a,u=h*h,f=h*h*h,m=3*h,g=3*u,p=6*u,x=6*f,y=e-s*2+n,b=t-i*2+o,w=(s-n)*3-e+r,C=(i-o)*3-t+c,v=e,A=t,I=(s-e)*m+y*g+w*f,E=(i-t)*m+b*g+C*f,F=y*p+w*x,Y=b*p+C*x,L=w*x,B=C*x;for(;a-- >0;)this.vertex(v,A,l),v+=I,A+=E,I+=F,E+=Y,F+=L,Y+=B,this.vertex(v,A,l);this.vertex(v,A,l),this.vertex(r,c,l)}vertex(e,t,s){let i=this.vertexIndex,n=this.mesh.getVertices();n[i++]=e,n[i++]=t,n[i++]=s.r,n[i++]=s.g,n[i++]=s.b,n[i++]=s.a,this.vertexIndex=i}end(){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");this.flush();let e=this.context.gl;e.disable(e.BLEND),this.isDrawing=!1}flush(){if(this.vertexIndex!=0){if(!this.shader)throw new Error("No shader set.");this.mesh.setVerticesLength(this.vertexIndex),this.mesh.draw(this.shader,this.shapeType),this.vertexIndex=0}}check(e,t){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");if(this.shapeType==e)if(this.mesh.maxVertices()-this.mesh.numVertices()<t)this.flush();else return;else this.flush(),this.shapeType=e}dispose(){this.mesh.dispose()}}var ke;(function(S){S[S.Point=0]="Point",S[S.Line=1]="Line",S[S.Filled=4]="Filled"})(ke||(ke={}));const gt=class gt{constructor(e){d(this,"boneLineColor",new N(1,0,0,1));d(this,"boneOriginColor",new N(0,1,0,1));d(this,"attachmentLineColor",new N(0,0,1,.5));d(this,"triangleLineColor",new N(1,.64,0,.5));d(this,"pathColor",new N().setFromString("FF7F00"));d(this,"clipColor",new N(.8,0,0,2));d(this,"aabbColor",new N(0,1,0,.5));d(this,"drawBones",!0);d(this,"drawRegionAttachments",!0);d(this,"drawBoundingBoxes",!0);d(this,"drawMeshHull",!0);d(this,"drawMeshTriangles",!0);d(this,"drawPaths",!0);d(this,"drawSkeletonXY",!1);d(this,"drawClipping",!0);d(this,"premultipliedAlpha",!1);d(this,"scale",1);d(this,"boneWidth",2);d(this,"context");d(this,"bounds",new Tr);d(this,"temp",new Array);d(this,"vertices",O.newFloatArray(2*1024));this.context=e instanceof Te?e:new Te(e)}draw(e,t,s){let i=t.x,n=t.y,o=this.context.gl,r=this.premultipliedAlpha?o.ONE:o.SRC_ALPHA;e.setBlendMode(r,o.ONE,o.ONE_MINUS_SRC_ALPHA);let c=t.bones;if(this.drawBones){e.setColor(this.boneLineColor);for(let a=0,l=c.length;a<l;a++){let h=c[a];if(s&&s.indexOf(h.data.name)>-1||!h.parent)continue;let u=h.data.length*h.a+h.worldX,f=h.data.length*h.c+h.worldY;e.rectLine(!0,h.worldX,h.worldY,u,f,this.boneWidth*this.scale)}this.drawSkeletonXY&&e.x(i,n,4*this.scale)}if(this.drawRegionAttachments){e.setColor(this.attachmentLineColor);let a=t.slots;for(let l=0,h=a.length;l<h;l++){let u=a[l],f=u.getAttachment();if(f instanceof xt){let m=f,g=this.vertices;m.computeWorldVertices(u,g,0,2),e.line(g[0],g[1],g[2],g[3]),e.line(g[2],g[3],g[4],g[5]),e.line(g[4],g[5],g[6],g[7]),e.line(g[6],g[7],g[0],g[1])}}}if(this.drawMeshHull||this.drawMeshTriangles){let a=t.slots;for(let l=0,h=a.length;l<h;l++){let u=a[l];if(!u.bone.active)continue;let f=u.getAttachment();if(!(f instanceof tt))continue;let m=f,g=this.vertices;m.computeWorldVertices(u,0,m.worldVerticesLength,g,0,2);let p=m.triangles,x=m.hullLength;if(this.drawMeshTriangles){e.setColor(this.triangleLineColor);for(let y=0,b=p.length;y<b;y+=3){let w=p[y]*2,C=p[y+1]*2,v=p[y+2]*2;e.triangle(!1,g[w],g[w+1],g[C],g[C+1],g[v],g[v+1])}}if(this.drawMeshHull&&x>0){e.setColor(this.attachmentLineColor),x=(x>>1)*2;let y=g[x-2],b=g[x-1];for(let w=0,C=x;w<C;w+=2){let v=g[w],A=g[w+1];e.line(v,A,y,b),y=v,b=A}}}}if(this.drawBoundingBoxes){let a=this.bounds;a.update(t,!0),e.setColor(this.aabbColor),e.rect(!1,a.minX,a.minY,a.getWidth(),a.getHeight());let l=a.polygons,h=a.boundingBoxes;for(let u=0,f=l.length;u<f;u++){let m=l[u];e.setColor(h[u].color),e.polygon(m,0,m.length)}}if(this.drawPaths){let a=t.slots;for(let l=0,h=a.length;l<h;l++){let u=a[l];if(!u.bone.active)continue;let f=u.getAttachment();if(!(f instanceof nt))continue;let m=f,g=m.worldVerticesLength,p=this.temp=O.setArraySize(this.temp,g,0);m.computeWorldVertices(u,0,g,p,0,2);let x=this.pathColor,y=p[2],b=p[3],w=0,C=0;if(m.closed){e.setColor(x);let v=p[0],A=p[1],I=p[g-2],E=p[g-1];w=p[g-4],C=p[g-3],e.curve(y,b,v,A,I,E,w,C,32),e.setColor(gt.LIGHT_GRAY),e.line(y,b,v,A),e.line(w,C,I,E)}g-=4;for(let v=4;v<g;v+=6){let A=p[v],I=p[v+1],E=p[v+2],F=p[v+3];w=p[v+4],C=p[v+5],e.setColor(x),e.curve(y,b,A,I,E,F,w,C,32),e.setColor(gt.LIGHT_GRAY),e.line(y,b,A,I),e.line(w,C,E,F),y=w,b=C}}}if(this.drawBones){e.setColor(this.boneOriginColor);for(let a=0,l=c.length;a<l;a++){let h=c[a];s&&s.indexOf(h.data.name)>-1||e.circle(!0,h.worldX,h.worldY,3*this.scale,this.boneOriginColor,8)}}if(this.drawClipping){let a=t.slots;e.setColor(this.clipColor);for(let l=0,h=a.length;l<h;l++){let u=a[l];if(!u.bone.active)continue;let f=u.getAttachment();if(!(f instanceof yt))continue;let m=f,g=m.worldVerticesLength,p=this.temp=O.setArraySize(this.temp,g,0);m.computeWorldVertices(u,0,g,p,0,2);for(let x=0,y=p.length;x<y;x+=2){let b=p[x],w=p[x+1],C=p[(x+2)%p.length],v=p[(x+3)%p.length];e.line(b,w,C,v)}}}}dispose(){}};d(gt,"LIGHT_GRAY",new N(192/255,192/255,192/255,1)),d(gt,"GREEN",new N(0,1,0,1));let os=gt;class Pr{constructor(e,t,s){d(this,"vertices");d(this,"numVertices");d(this,"numFloats");this.vertices=e,this.numVertices=t,this.numFloats=s}}const qt=class qt{constructor(e,t=!0){d(this,"premultipliedAlpha",!1);d(this,"tempColor",new N);d(this,"tempColor2",new N);d(this,"vertices");d(this,"vertexSize",8);d(this,"twoColorTint",!1);d(this,"renderable",new Pr([],0,0));d(this,"clipper",new Ot);d(this,"temp",new qe);d(this,"temp2",new qe);d(this,"temp3",new N);d(this,"temp4",new N);this.twoColorTint=t,t&&(this.vertexSize+=4),this.vertices=O.newFloatArray(this.vertexSize*1024)}draw(e,t,s=-1,i=-1,n=null){let o=this.clipper,r=this.premultipliedAlpha,c=this.twoColorTint,a=null,l=this.renderable,h,u,f=t.drawOrder,m,g=t.color,p=c?12:8,x=!1;s==-1&&(x=!0);for(let y=0,b=f.length;y<b;y++){let w=o.isClipping()?2:p,C=f[y];if(!C.bone.active){o.clipEndWithSlot(C);continue}if(s>=0&&s==C.data.index&&(x=!0),!x){o.clipEndWithSlot(C);continue}i>=0&&i==C.data.index&&(x=!1);let v=C.getAttachment(),A;if(v instanceof xt){let I=v;l.vertices=this.vertices,l.numVertices=4,l.numFloats=w<<2,I.computeWorldVertices(C,l.vertices,0,w),u=qt.QUAD_TRIANGLES,h=I.uvs,A=I.region.texture,m=I.color}else if(v instanceof tt){let I=v;l.vertices=this.vertices,l.numVertices=I.worldVerticesLength>>1,l.numFloats=l.numVertices*w,l.numFloats>l.vertices.length&&(l.vertices=this.vertices=O.newFloatArray(l.numFloats)),I.computeWorldVertices(C,0,I.worldVerticesLength,l.vertices,0,w),u=I.triangles,A=I.region.texture,h=I.uvs,m=I.color}else if(v instanceof yt){let I=v;o.clipStart(C,I);continue}else{o.clipEndWithSlot(C);continue}if(A){let I=C.color,E=this.tempColor;E.r=g.r*I.r*m.r,E.g=g.g*I.g*m.g,E.b=g.b*I.b*m.b,E.a=g.a*I.a*m.a,r&&(E.r*=E.a,E.g*=E.a,E.b*=E.a);let F=this.tempColor2;C.darkColor?(r?(F.r=C.darkColor.r*E.a,F.g=C.darkColor.g*E.a,F.b=C.darkColor.b*E.a):F.setFromColor(C.darkColor),F.a=r?1:0):F.set(0,0,0,1);let Y=C.data.blendMode;if(Y!=a&&(a=Y,e.setBlendMode(a,r)),o.isClipping()){o.clipTriangles(l.vertices,l.numFloats,u,u.length,h,E,F,c);let L=new Float32Array(o.clippedVertices),B=o.clippedTriangles;n&&n(L,L.length,p),e.draw(A,L,B)}else{let L=l.vertices;if(c)for(let P=2,R=0,M=l.numFloats;P<M;P+=p,R+=2)L[P]=E.r,L[P+1]=E.g,L[P+2]=E.b,L[P+3]=E.a,L[P+4]=h[R],L[P+5]=h[R+1],L[P+6]=F.r,L[P+7]=F.g,L[P+8]=F.b,L[P+9]=F.a;else for(let P=2,R=0,M=l.numFloats;P<M;P+=p,R+=2)L[P]=E.r,L[P+1]=E.g,L[P+2]=E.b,L[P+3]=E.a,L[P+4]=h[R],L[P+5]=h[R+1];let B=l.vertices.subarray(0,l.numFloats);n&&n(l.vertices,l.numFloats,p),e.draw(A,B,u)}}o.clipEndWithSlot(C)}o.clipEnd()}getSkeletonClipping(){return this.clipper}};d(qt,"QUAD_TRIANGLES",[0,1,2,2,3,0]);let hs=qt;const k=[0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0],Rt=[0,1,2,2,3,0],Ft=new N(1,1,1,1);class Vr{constructor(e,t,s=!0){d(this,"context");d(this,"canvas");d(this,"camera");d(this,"batcher");d(this,"twoColorTint",!1);d(this,"batcherShader");d(this,"shapes");d(this,"shapesShader");d(this,"activeRenderer",null);d(this,"skeletonRenderer");d(this,"skeletonDebugRenderer");this.canvas=e,this.context=t instanceof Te?t:new Te(t),this.twoColorTint=s,this.camera=new Yr(e.width,e.height),this.batcherShader=s?Ne.newTwoColoredTextured(this.context):Ne.newColoredTextured(this.context),this.batcher=new Nt(this.context,s),this.shapesShader=Ne.newColored(this.context),this.shapes=new Es(this.context),this.skeletonRenderer=new hs(this.context,s),this.skeletonDebugRenderer=new os(this.context)}dispose(){this.batcher.dispose(),this.batcherShader.dispose(),this.shapes.dispose(),this.shapesShader.dispose(),this.skeletonDebugRenderer.dispose()}begin(){this.camera.update(),this.enableRenderer(this.batcher)}drawSkeleton(e,t=!1,s=-1,i=-1,n=null){this.enableRenderer(this.batcher),this.skeletonRenderer.premultipliedAlpha=t,this.skeletonRenderer.draw(this.batcher,e,s,i,n)}drawSkeletonDebug(e,t=!1,s){this.enableRenderer(this.shapes),this.skeletonDebugRenderer.premultipliedAlpha=t,this.skeletonDebugRenderer.draw(this.shapes,e,s)}drawTexture(e,t,s,i,n,o){this.enableRenderer(this.batcher),o||(o=Ft);var r=0;k[r++]=t,k[r++]=s,k[r++]=o.r,k[r++]=o.g,k[r++]=o.b,k[r++]=o.a,k[r++]=0,k[r++]=1,this.twoColorTint&&(k[r++]=0,k[r++]=0,k[r++]=0,k[r++]=0),k[r++]=t+i,k[r++]=s,k[r++]=o.r,k[r++]=o.g,k[r++]=o.b,k[r++]=o.a,k[r++]=1,k[r++]=1,this.twoColorTint&&(k[r++]=0,k[r++]=0,k[r++]=0,k[r++]=0),k[r++]=t+i,k[r++]=s+n,k[r++]=o.r,k[r++]=o.g,k[r++]=o.b,k[r++]=o.a,k[r++]=1,k[r++]=0,this.twoColorTint&&(k[r++]=0,k[r++]=0,k[r++]=0,k[r++]=0),k[r++]=t,k[r++]=s+n,k[r++]=o.r,k[r++]=o.g,k[r++]=o.b,k[r++]=o.a,k[r++]=0,k[r++]=0,this.twoColorTint&&(k[r++]=0,k[r++]=0,k[r++]=0,k[r]=0),this.batcher.draw(e,k,Rt)}drawTextureUV(e,t,s,i,n,o,r,c,a,l){this.enableRenderer(this.batcher),l||(l=Ft);var h=0;k[h++]=t,k[h++]=s,k[h++]=l.r,k[h++]=l.g,k[h++]=l.b,k[h++]=l.a,k[h++]=o,k[h++]=r,this.twoColorTint&&(k[h++]=0,k[h++]=0,k[h++]=0,k[h++]=0),k[h++]=t+i,k[h++]=s,k[h++]=l.r,k[h++]=l.g,k[h++]=l.b,k[h++]=l.a,k[h++]=c,k[h++]=r,this.twoColorTint&&(k[h++]=0,k[h++]=0,k[h++]=0,k[h++]=0),k[h++]=t+i,k[h++]=s+n,k[h++]=l.r,k[h++]=l.g,k[h++]=l.b,k[h++]=l.a,k[h++]=c,k[h++]=a,this.twoColorTint&&(k[h++]=0,k[h++]=0,k[h++]=0,k[h++]=0),k[h++]=t,k[h++]=s+n,k[h++]=l.r,k[h++]=l.g,k[h++]=l.b,k[h++]=l.a,k[h++]=o,k[h++]=a,this.twoColorTint&&(k[h++]=0,k[h++]=0,k[h++]=0,k[h]=0),this.batcher.draw(e,k,Rt)}drawTextureRotated(e,t,s,i,n,o,r,c,a){this.enableRenderer(this.batcher),a||(a=Ft);let l=t+o,h=s+r,u=-o,f=-r,m=i-o,g=n-r,p=u,x=f,y=u,b=g,w=m,C=g,v=m,A=f,I=0,E=0,F=0,Y=0,L=0,B=0,P=0,R=0;if(c!=0){let D=V.cosDeg(c),re=V.sinDeg(c);I=D*p-re*x,E=re*p+D*x,P=D*y-re*b,R=re*y+D*b,L=D*w-re*C,B=re*w+D*C,F=L+(I-P),Y=B+(E-R)}else I=p,E=x,P=y,R=b,L=w,B=C,F=v,Y=A;I+=l,E+=h,F+=l,Y+=h,L+=l,B+=h,P+=l,R+=h;var M=0;k[M++]=I,k[M++]=E,k[M++]=a.r,k[M++]=a.g,k[M++]=a.b,k[M++]=a.a,k[M++]=0,k[M++]=1,this.twoColorTint&&(k[M++]=0,k[M++]=0,k[M++]=0,k[M++]=0),k[M++]=F,k[M++]=Y,k[M++]=a.r,k[M++]=a.g,k[M++]=a.b,k[M++]=a.a,k[M++]=1,k[M++]=1,this.twoColorTint&&(k[M++]=0,k[M++]=0,k[M++]=0,k[M++]=0),k[M++]=L,k[M++]=B,k[M++]=a.r,k[M++]=a.g,k[M++]=a.b,k[M++]=a.a,k[M++]=1,k[M++]=0,this.twoColorTint&&(k[M++]=0,k[M++]=0,k[M++]=0,k[M++]=0),k[M++]=P,k[M++]=R,k[M++]=a.r,k[M++]=a.g,k[M++]=a.b,k[M++]=a.a,k[M++]=0,k[M++]=0,this.twoColorTint&&(k[M++]=0,k[M++]=0,k[M++]=0,k[M]=0),this.batcher.draw(e,k,Rt)}drawRegion(e,t,s,i,n,o){this.enableRenderer(this.batcher),o||(o=Ft);var r=0;k[r++]=t,k[r++]=s,k[r++]=o.r,k[r++]=o.g,k[r++]=o.b,k[r++]=o.a,k[r++]=e.u,k[r++]=e.v2,this.twoColorTint&&(k[r++]=0,k[r++]=0,k[r++]=0,k[r++]=0),k[r++]=t+i,k[r++]=s,k[r++]=o.r,k[r++]=o.g,k[r++]=o.b,k[r++]=o.a,k[r++]=e.u2,k[r++]=e.v2,this.twoColorTint&&(k[r++]=0,k[r++]=0,k[r++]=0,k[r++]=0),k[r++]=t+i,k[r++]=s+n,k[r++]=o.r,k[r++]=o.g,k[r++]=o.b,k[r++]=o.a,k[r++]=e.u2,k[r++]=e.v,this.twoColorTint&&(k[r++]=0,k[r++]=0,k[r++]=0,k[r++]=0),k[r++]=t,k[r++]=s+n,k[r++]=o.r,k[r++]=o.g,k[r++]=o.b,k[r++]=o.a,k[r++]=e.u,k[r++]=e.v,this.twoColorTint&&(k[r++]=0,k[r++]=0,k[r++]=0,k[r]=0),this.batcher.draw(e.page.texture,k,Rt)}line(e,t,s,i,n,o){this.enableRenderer(this.shapes),this.shapes.line(e,t,s,i,n)}triangle(e,t,s,i,n,o,r,c,a,l){this.enableRenderer(this.shapes),this.shapes.triangle(e,t,s,i,n,o,r,c,a,l)}quad(e,t,s,i,n,o,r,c,a,l,h,u,f){this.enableRenderer(this.shapes),this.shapes.quad(e,t,s,i,n,o,r,c,a,l,h,u,f)}rect(e,t,s,i,n,o){this.enableRenderer(this.shapes),this.shapes.rect(e,t,s,i,n,o)}rectLine(e,t,s,i,n,o,r){this.enableRenderer(this.shapes),this.shapes.rectLine(e,t,s,i,n,o,r)}polygon(e,t,s,i){this.enableRenderer(this.shapes),this.shapes.polygon(e,t,s,i)}circle(e,t,s,i,n,o=0){this.enableRenderer(this.shapes),this.shapes.circle(e,t,s,i,n,o)}curve(e,t,s,i,n,o,r,c,a,l){this.enableRenderer(this.shapes),this.shapes.curve(e,t,s,i,n,o,r,c,a,l)}end(){this.activeRenderer===this.batcher?this.batcher.end():this.activeRenderer===this.shapes&&this.shapes.end(),this.activeRenderer=null}resize(e){let t=this.canvas;var s=window.devicePixelRatio||1,i=Math.round(t.clientWidth*s),n=Math.round(t.clientHeight*s);if((t.width!=i||t.height!=n)&&(t.width=i,t.height=n),this.context.gl.viewport(0,0,t.width,t.height),e===bt.Expand)this.camera.setViewport(i,n);else if(e===bt.Fit){let o=t.width,r=t.height,c=this.camera.viewportWidth,a=this.camera.viewportHeight,l=a/c,h=r/o,u=l<h?c/o:a/r;this.camera.setViewport(o*u,r*u)}this.camera.update()}enableRenderer(e){this.activeRenderer!==e&&(this.end(),e instanceof Nt?(this.batcherShader.bind(),this.batcherShader.setUniform4x4f(Ne.MVP_MATRIX,this.camera.projectionView.values),this.batcherShader.setUniformi("u_texture",0),this.batcher.begin(this.batcherShader),this.activeRenderer=this.batcher):e instanceof Es?(this.shapesShader.bind(),this.shapesShader.setUniform4x4f(Ne.MVP_MATRIX,this.camera.projectionView.values),this.shapes.begin(this.shapesShader),this.activeRenderer=this.shapes):this.activeRenderer=this.skeletonDebugRenderer)}}var bt;(function(S){S[S.Stretch=0]="Stretch",S[S.Expand=1]="Expand",S[S.Fit=2]="Fit"})(bt||(bt={}));let Ct,ct,Ts=0;const Or=1,es=1,Ms=165,Rs=108,st=163;class Nr{constructor(e){d(this,"renderer");d(this,"logo",null);d(this,"spinner",null);d(this,"angle",0);d(this,"fadeOut",0);d(this,"fadeIn",0);d(this,"timeKeeper",new Xs);d(this,"backgroundColor",new N(.135,.135,.135,1));d(this,"tempColor",new N);if(this.renderer=e,this.timeKeeper.maxDelta=9,!ct){let t=navigator.userAgent.indexOf("Safari")>-1,s=()=>Ts++;ct=new Image,ct.src=Ur,t||(ct.crossOrigin="anonymous"),ct.onload=s,Ct=new Image,Ct.src=Dr,t||(Ct.crossOrigin="anonymous"),Ct.onload=s}}dispose(){var e,t;(e=this.logo)==null||e.dispose(),(t=this.spinner)==null||t.dispose()}draw(e=!1){if(Ts<2||e&&this.fadeOut>es)return;this.timeKeeper.update();let t=Math.abs(Math.sin(this.timeKeeper.totalTime+.25));this.angle-=this.timeKeeper.delta*200*(1+1.5*Math.pow(t,5));let s=this.tempColor,i=this.renderer,n=i.canvas,o=i.context.gl;if(i.resize(bt.Expand),i.camera.position.set(n.width/2,n.height/2,0),i.batcher.setBlendMode(kt.Normal,!0),e){if(this.fadeOut+=this.timeKeeper.delta*(this.timeKeeper.totalTime<1?2:1),this.fadeOut>es)return;s.setFromColor(this.backgroundColor),t=1-this.fadeOut/es,t=1-(t-1)*(t-1),s.a*=t,s.a>0&&(i.camera.zoom=1,i.begin(),i.quad(!0,0,0,n.width,0,n.width,n.height,0,n.height,s,s,s,s),i.end())}else this.fadeIn+=this.timeKeeper.delta,this.backgroundColor.a>0&&(o.clearColor(this.backgroundColor.r,this.backgroundColor.g,this.backgroundColor.b,this.backgroundColor.a),o.clear(o.COLOR_BUFFER_BIT)),t=1;t*=Math.min(this.fadeIn/Or,1),s.set(t,t,t,t),this.logo||(this.logo=new Et(i.context,ct),this.spinner=new Et(i.context,Ct)),i.camera.zoom=Math.max(1,st/n.height),i.begin(),i.drawTexture(this.logo,(n.width-Ms)/2,(n.height-Rs)/2,Ms,Rs,s),this.spinner&&i.drawTextureRotated(this.spinner,(n.width-st)/2,(n.height-st)/2,st,st,st/2,st/2,this.angle,s),i.end()}}let Dr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKMAAACjCAYAAADmbK6AAAALKElEQVR42u2de2iW5R/GPzuqcwfnnKfNmafl5tTNHWzqNi3DEMQykcAoJSsySkspjSIk0iD/07Kf4R+FnVBDUTshZGpWUEJaaiWFgZlUFmXmIe3HNXthyebeZ77P9H13ffBG8Y8H7ut7vff93N/7fu4vGGPiFZiez/Qtw9lytJajfzfw9z/j+efPOv7cV8W+lUNY2a8T/ayTCRsWFLJA5rtUO1LLkV5p9LJeJizQiHeqnlOtmVFtdTGrrZkJCxYXsTgaI6r9MY4/UpNItW4mFDaXsTlaM6qVZlBq3UwofFrJp0HMWJ9DvXUzobCznJ1BzFjWlTLrZkJh/TDWBzFjTgo51s2EgnKI0Rrx+FiOWzNzVaym91Syx5qZsGBWb2ZFa0ZN6dbMhAWTcpkUrRmXD2K5NTNhgVbH0Zpxbl/mWjMTFvRIo0e0ZpzcncnWzISKtvmiMWNRJ4qslwmVXRXsas2Ix8ZwzFqZsGFREYtaM+Oaa1ljrUzYkJ9G/ok6TlzKjJWZVFor0y7c1Zu7WjLiqiGsskamXdHopyT4vALmzS9k/t19uHtKHlOSIMn6xAtARjIZ1sFcUSZ0Y4La+G6M18hS2IlCn4a+WoC0JNL0d/dUupdnUj40g6EJ2VEdMnhrOG/p5f/jUXz8SgmvaGU6KpNRNsLVQV0OdXf24s63h/P2gWoOrBjMCr2GJFQnnxnIM3q5P1PPmaYv+4ev4/C6UtbpV2gzXCkgL5W8Bwt48OIc6ul6Tp+s4+SyASxLiI4+PYCn1bHzDZxvaQW6vZzto7MYnQIpNkf7kp5EuozYUroqEjcNKHHd0Tl9mBPN1pk+hFeieGBnBtog7UXjsj9pWg+m6duecw2cay1OC/uxMC47KmP9OIYfoz1YoC20J/rzRG4quTZK2EAyJGs20qwUbYw0aNRmUxtvfUW/uEtNzc1NB1/X8LVyd15hh82F43AvD+VlXcsSJEZa1CQ3ejleAO7oxR3RDP0XN91X4+NXYb8nkv7UNTwV7e0YTdu7I3g33t7tuaEbNwSZpps2fSyvs4M2Tjhot+jb0Xzbltj8r5j/xVt/6Z1Ob93U1ZYO691EhhzchcHeXosVjcNZysyezLw4xRZt05R+fTeuj8vOj+zKyG0j2aZcVVs6v+QalnjrMFZASQYl2nBoSyz06e3j/Xk8rgWYmMvEICu2pm1HOTuc7okV8FgRj0XukwzanhvCc/F+72TjoQjdObN1OFuDLmh0xP+WHtxiI10ukJlCprb4guiv1fP+avZrS1C7NAkliHZjDtZwMMgqbukAltpMlwuMy2FcEBPqvfLLar5Uqi0hBdEwryy+Mv5n6zkbjTBa+dlMlwvUZFETZKGiFM7tvbhdJ3gSVRO0wzIjnxmvl/J6a6JsGMYGrahtpssFeqbR841S3mhN80OjOaSDEdqd6SjaMKgzgzRK7q1ib3PT9sYyNo7JZoyNFNvRcVMZmy7WOvIuryv/Zvdmdt90+nY0bRp3AvROohFwdwW7dTG7RFlbwlqdrbOBYg005NAQmZU0HWt1rXMBH1Xw0dQ8pmqzoaPmdhun7bHZjNVe9qP9eFQfO1VkUmHjhAVUZ1GtnKFSbjrkrPfy4i4UW5t/6ZxM54J0CqxFe81KpGsQyE4h23oYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjLna+bdOy+IiFquIpGq16Pb79cNYv3IIK/X/ugx+Ui6TVKvYVU9Nc8gX8od8Ir/IN/KPfCQ/yVfyl/6/pfJvLChkQdD6wyqntquCXYuKWJSfRr6D0dEAxV3xlw/khyD+kd/ku/88cHo+09tS3LBpO1HHCVUqcIA6CqB4K+6X6x35L/JM2loXurlWmUmlA5XogOIcK8/If5HncrSWo7F6cKIWPjT/RXGOlWfkv8hzaWsN4uaaysE6WIkOKM6x8oz8F3kusXqo2vxC5jtYiQ4ozrH0TeS5qIZcrB7qkrwdA8U5Vp6R/yLPZV8V+2L14Cl5THGwEh1QnGPlGfkv8lyUlIzFQ1cNYVVHrcjZ0VCcFe9Y+Eb+izy3ceclUl43aFN52DXXssYpnY6a4qFS8ZcP2uIf+e7inRh6pdFrdTGrm8uiHx/L8T2V7NGWzvJBLJ/bl7mTuzO5qBNFDoiJID/IF/KHfCK/yDfyT3O7d/KbfNfS80hNIrU0g9L6HOq1x5iTQo6FNpeLfCQ/yVfyl3xmXYwxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY4wxxhhjjDHNk9z4JwJ0SqKTdQkbyEwhU393T6V7zzR6pieR3tE1ITeVXImhe6BXDGZFdRbVeank2TBhcaEMr0rwbixj49IBLL2/L/ffmMuNHfqO9tFZjJYBd1ewO3Lx+IcVfKhqna5nHZYR6XFPH+5R3eeI5t9fx/fvjeC9Jdew5OKZKqFR/RDVKL6vL/f9PJafmyvHsL+a/ff24V6NmjZQbGchVbY6UM2BluqHv1rCqzVZ1KQlkZboepCdQvacPsz5bjTfXao+yMEaDt7Wk9tSIMVGig3TejCtJSM2bSpkPjWPqd1S6Zao+lORSYWmgkOjORRNwZqd5ezMSiHLRooNr5XwWjS6/1XHX9vL2T67N7M1iyXa9JCrYjVrS1gbpJyw6hBfsmiNCYT0P9/A+Wj1/6qGr5YNYFlJBiWJogEzezLz/ZG8/9s4fgtSyuvNYbyp1IONFBtu7sHNv4/j9yAxUHWrdaWsG9+N8XHd+YxkMpSy+aySz841cC5oXbmHCnnI74yxAgZ3YbDeB4PEQCOpBpFNZWwa2ZWRcdnxLsl00crtRB0n2lLg8JNRfDKoM4NsolgBSmw/UMADba1+qpmqfyf6x1u/0a/og3I+aEunP6/i86osqmygcGarF4p54dex/Bo0LqfqOfVwIQ/HW5/RSkwV1oN2WLlHTc82TljAwM4M1O5LWwYKZTjibYXNS0N5KcjKTe10PadfLObFuJwK4ozp+UzXDBTUjL+M5ZcBnRkQV53dMIwNQTu6bSTbVEzbi5awuVByd2E/FgaN0Tc1fKOzBHHV2aAdVSdv6s5NNkp7cSH/++xAng2yyHx+CM/H21YhfdPp+0U1X0TbSZnXx8faG9Aop0MS0cToh1p+iLcpOkLj9t/JOk5eqoPHxnDsyf486an5yqCDK7XZ1O4oZ4dWyy3FSXHUAYq47uyYbMZoGmhpG3DlEFb6uNiVBhpyaHhnBO8oJmfqOROJjzIiP43hJ8UxITqqX56S2Hur2KsOnq3nrE6PPNKPRwrSKbAZrjTQNZmuE7oxYXMZmxWbw9dxWFu4W4ezVedOE6qzI7oyYkY+M7TPeWsPbk2UX1qioSN+E3OZqOR2cReKE+qQRFN0Pi7y73g/UawU1KzezJpXwLz5hczX1ueUPKYkNb6GJQZ+j7/aAfRZREsv+quGsMoamXZBW2Gt5eU0alorEzYsKmJRa/m4NdeyxlqZsCGa84DKnVorEzboC7podis69DfIJmwufHMc7famvvmxZiYsKOtKWbRm1OcW1syEBboSJFozLh/EcmtmwgIluaM14/phrLdmJixYXMTiaM24p5I91syEBTphFOR7Y2tmwgJNvUFOr+tov3UzoaAv44KYUatv62ZCoemdhtG0+hzqrZsJBR08DWLG0gxKrZu50qvpxos3U5NItW4mFPp1ot+lPlpq2lYXs9qamVBZUMiC1ox4pJYjvlfStAu6GmTLcLboMtPIV4/6im5fFfuUi9QIap2MiWP+D96R1vPmsD/fAAAAAElFTkSuQmCC",Ur="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKUAAABsCAYAAAALzHKmAAAQ7klEQVR42u3da4xdVRUA4D0zd2Y6nZY59DVtZ1puS9+lzC0YAi2UQ8AAQczFpPgA9VIeIQbirRqJ0cBUBVGjDr/QCKSNRSMmpuODxAdxqhgwxkhFjf6Sxh/+UUNVNGJCzR7uTvas7LXX2q9zzp3em6y0gTN3Zu75utZe5+yztxC9V+/Ve5X9En1Vjd7J6SFbLNF7naPw+l2jh7YHMBWssqMHtlsRdim4qsLtIawaPiHEQOLoNrA9iIkQDnRrVA1qD2LZ8ISoxYqKo13sQAtBWBayQWZUAXGRQM9JjCngDVY0UqJNDbQrMcaGmArdUKpIjbYiQLsCZCyIMQBy8QwnilR4Q5AuCpxFYvRFmBLbEiwKwpsSaWycVQGZBKMrwBjA9BhxDe57u2L2hOoKNCbOrgAZitEVYUxoKSMErQvSxYIzCkguRg5EF4AUhqUlhy/YUKSxcRaKsioYOQhD4I0yYxkR3PcJBcuFysmgsXAWBTMJyBCMIQh9kGGxXIXvexCQXbHGAMrBWTbM2CCpMSMLIxehC77lSJwXGth7M0FzoVJIXXDWQnGmhOkL0ic7YhhtWdGGkAuPAjUWGoF4faCmwBkbZmyUqUCyMqMLRA4+E6IsdTjidUHKBYrh9CnpRcH0ypKxsyOGEYNIIeTCOz91OIJ1QYoB5eAMyZo+MFNnyVTZ0YiRC9EGEMOyAgshxErHsL2XK1gOUgwohtM1a5YNM7Rsu4K0ZkcbRm4mpPBRwFZ5hg9eCqkrUB+csWGGogzNkqEgrdnRhpGLkINudaLgwvVB6oqzCjCTZElb2Y4B0gUjBtEG0ARnDRLjjoG9DwcshtQGlIPTljVjwUySLWNkyRCQVHa0ZUUTRAwgF91a33BEy0VKAcVwwqwZC2bqbOlUurllOxQkJzNyINoAYqjWhYYjWg5SCiiG05Q1U8FMjTIoS8YE6YORi1BHtJ4KIcQEEtTXUWAxpK44YVlPBdO1jCdFWTZIE8bVGEYMIRPcZGBw4HKQcoBiOE1ZMzbMgVQwU6JMAdKEEcuIJogUvg1YCCE2gsCO42DlIIVAKZwpYJaSLVNnSU6XjYHUmxhTmXaFaMO3EYkLqMC+FsLlIoVAKZzMrEnBhJeLfLNlKMrYWRIDCbOkFSSVHbHM6AKRC6/ODUewNqQ+OLlZkxpjUmV8MBbMUJSxyzY3Q1IgTRgxiBRCHdem0KDAUkBh9sRwwjEnAXMMgTnKhFlUtiwkS5rGka4g9SaGgxFmRC7AzTCEEBcyA36dDSsXqAtOLkysjGMwY5XxVChjZ0kuSCo7YlkRQsQQYtDEFsegsLoCxUp7Kpgps2UslFGzJGccSYHUmxhOZqwzEZqAbfUMCisHKIZzgsCpl3MTzMwTpi1bYp2477gyFKUxS7qWbdjY2EBS2dGE0QQRA7gNCyHEdhjE8RhUDlBT9tzgmjWZMFNlSy+Urk1OzCyJlW0XkK4YOQh1cDtcgwBrQmoDWkdgboBZE8mYsJSHlnFbJ+5bwmOPJ7lZkirbC8aRsMvmgtTHjBhGE0QbwJ2egUE1ITVlUC5OmDVdYNrKuN70xM6WoShjlW4464dbtiFIWK6x7GjESEHUUe0iYncnbMdQSE0Z1ITTNOb0hRmjjLtmS9dmJ2rp1jtuKktyyrb6YLEMCUHq2dGG0QQRQ7f72kzc+cJecerne8Wvv7JNPHPvenEkz8Sh3UtFc92QyGt9Yko/HgOLAIUZlItTz5ouMF3KuE+2jFLCQ1D6lm6fLMkBacuOJowYRBUXyfjuHjF3NhdnsfjvAfH6E9vFt9XxKgikEKgJZyyYalzOLeMu2bLbULI6bh+QGwmQ+rgRlumdGEQAao+K56bEL2woVUwOiev0r8OAUjiJrMmFCbvykGxZRAmPitK1dHM7bohyMsuyi/I8f0+e57fJYIKEZXpXo9E4mOf5XTKyLLvCBLETF8uY2SKepkC+dpX4T02Ivepr4HvZcOZ5fmee54fyPL+DmTUhzAs6n4n8bN5dr9f3YdkSg8nsxG0lPBVKVpNjG0/aGhzfLDmRZdnumZmZp8+c+cdZPV555fSr7Xb7s0jJ3i5Pcue4MxKkPPkvvXTqz/B92u32l0wYOzG1fkhcd/py8Rcbyq/vFM/KY1WA95h/3zzP71bfU6JsNpsfgj+P/FlbrdaDGExYyuXvLz8H+DudODH700ajcSM3W6Yu4alQ1spCOTd38jcKocTZbh9+9NixY99XJ8AEUkcpo9W64yH197m5k7+bnZ19QT+J09NHntQhwji/Jg58qi6++ofLxJ8gSFneVw2Ka4QQDfh1Ok4dZavVmtZ/nrm5k7/Vf55O1tRhboUw5+ZOvqyOl5+R/FyOHj32PYVU/tloNG5IXcKrhJIzngwp3fNjomazea/64BuNxts646f50lWv169utw9/DmtqdJQyZFaSJVuV6nq9fqMEof5/vV6/CYBqgJDlee+yAbF/+4i4ZWqZeNfaIfHWzn+Hx0KcEuU9+s8jv3ej0bhVlXOZydX/k0iRMeb8P0D5e6tj8zy/Xb9UJIc56h/yqVOnXul8lmuZ2bJslKmbHG7XrbpCmCXFRLvdfqQD6jTS3Jiy5I4OykM6ADV+1Eu1DmV6evopBORexzDi1L+X/HnGxsb2w3Hm9PSRJ9QxWPOTZdmlKht2hi+w6dkox5bqffI8fye3hDteGqKaHVsHXihKl0tB+h0cY+lute54AGRKDCW89LNTRynHb7ChUWVVjetOnJh9EYBUyPZeNCoOtsbFQwdXi4/esELcd+tq8cCHJ8UXp+viy9efLz7AgamjlKXc1AA1m83DoIRDlFubzeb96hhZLVTlgJ24gttutx+ONa50bHZKRenaeTs1OfpAfnr6yOOdE7EZdNwmlKocntXLNkA5JTGq47Ds+Lf94lWsyfnXleLfnIwJUN4DOnNYwuUxh2A3Ln9XULrfK8t3J27Tu3BVwiOjXJqoAy8UZej1yclGo3GTLN+gu3w+z/P3YaWbQqk3Ne12e4ZC+c8rxWsYytcPiP9RpZxCqWDKnxOiBNlyAUpOnGsoh4tA2Rm8X9xqtT6md5wyZmYe+0YRKL+1S/wYQ3n8zctBl5SBUv5djivfjMOPduIzcizeiYfr9foVvUwZG+XCuzibZKnSceZ5/v4QlKp8y7ElhnJlTeTP7BI/kllRYfzrfvHqFy4UX1vaL/aVlSmROzwbwdS29T2UcEwZF+V8ozM2lu1VY812u/15akypGh3TmFJesJbHHD167IdUxz3YJy5bNySuX1mbvy55CbMLtzU6tjGlsdFptVqfUMc0Go23F4wy1l2dSnbfvpMwVPe9WWVLDsrOJaF9MFu2Wq1PqmNkGce67xiXhTjdNwdlvV6/BgxfbPfBfVCetxi6b9/rlCup65QzM48dl2OjLMv26CibzeZ96sTIzEFdpwQXz9U1yrtVlpR/Zll2Fec65Y6l4pbbx8XHH9kknvzJlPjlHy8Tp29eKT5ou0aJoIT3w3dBlLDzVpfAJEZ1XOdaJZxnOSlvPMjPzxFljIvng914RwebsjYO7uhMyHu46sOfnf3Oz2TXDW6vvYxdFoIXz3Wc8J5zs9n8iOn2IrxTc2BM3Glqdp7dI553uaOjxrhwcob+MyuUpjs6WZZdon8OcigjPx8V+u+GTWFTSWEx3WYcdJ225jNDSE4q0GHCzlueHOyujn6bUWYgeb9ZZUaQPe+GzQ+Gc8+oOGhC+c1d4gfI16n3XDAhQ7+9qE9l01E2Go132GYKyXE1NiFDTcpoNpv3LOYJGWXNErJNW9sEp63p2RKiVPMn1bS1DgxsyhoGdGpmizj+xtXiDYnx7/vFmce3iWdW1cTVGEY4hQ2ZW0nNq8Qm/M6XbXm3S100lwGedFybuvNOibLI+ZS2ceU4eAxiEuvCkfmU8ycToDxETe6FgCBQHeqyAbFvfEhcO7BwDuXFCEbTZF840XeHK0jYcbs2OIGle0mVJ/mmnClEPQqxyTY5I8/zFhif7fSZee4bnrPOU4AssnRXHaVTCTd14dRDY3UbTIiSeFhsN/aMjgnqthFx880rxX3yATL5p3y4LPXzOaBkUyBjZMlYpbtQlIOBD475ZEusjMNSvkXe6VEoJVDkeZ2dzIfIFsRzU+JF2OyM9M9fTC/6SUYOyFQPjQ2nWiUjxnPfw5EeHqMWIqAeIFsAU847lJM2JM6xsewt1OIDLs99P7ZFHNdB/upS8XtPiD7PfLuCXJNolYyyFiNI/Zit65ItrOVafFbHcFohY7hPTN21Tjz4uc3iqfsnxKdX1MTl1OoYRFaMsToGB6Trw2JFP/OdZC2hJZ7ZkrMoAbbSGmelDJ91hFKuJeS7jlBMkJnrAqqJlgMUZS/dArPlGHNdSg5M3xXXtvquuEatvIYtDRhpxbUJuIgqsU5lGWtUploK0KuEU9mSW8YpmFQ556xNuYW7NiW13B+FkMiKHIy+C6eGgBxJvMR0oSv5hi6+z4HJyZoU0M2RVvDlrOQbcxVfX5AhZbuqy0v7ZstYMLHlAVlLTF9ALLbvu9Y5Zylpn/XOsd0ibIvxr2KCLHpp6SCUIdnSZSF+WzfOhem6GD+1KwR3Z4jNjrtDpNoZwmWd8yrupZN6Hx3fbMmFSe0Swdq2ZIPjxk1112Duo8OBGLrBkw/IoncdK2XHsdC9dHz204m50xh3tzFq1zFqtzHXrfCw7OgDsqyNnZLszVijsmXgrmNcmGtS78lIoMX2aJz03fKO2sDJddPQSCDPiQ1DfWBycY6XtXstc2PQKuxgG2McmXTPb9/9vmuJYXKyJrWjbeg+3xPM4O73nWqvbyw7xgZZSJbEUBa157cNJjdr2vb+5iA1YV3HxYscj30PDCEHIgcjtfm8K8hSsmRotkwFk5s1TTghUAopB6xrjHMBBkI0YYTZ0dZlxwLpkiWDULpmy5gwqayZgZNkA7oKQQCxctByYg0XIIEQQuRitGVHblMTA2ShKGPDpC6wu+DEgJqg2rDGDBtAF4Q6RAojp1xXGmSMbImVcR+YWNY04eQCtUG1ofUJ2/uvcETIgUhhdAE5GAlkKShjwHTNmhhODKgJqQ2sC14uOgyfD0IbRF+MlQaZAiZWyn2yJsTJATqGnHQO2Jhh+xlsACFCG0QbRtdyzQFZCZSxYPpmTS7Q5cjJHYNBYIkZpu99HoUQ/o4QIYSIZUZfjJ4ZMjZI32wZBDMU5yhy8pZTULl4XYP5fagMyEVoy4oupTpGduwnkloSlKEwY+AcQU4MhRTD6ovXBRwFzwWgCSEF0QVjJUGmgEllTS5OLlCIlIN1mS9mx/cZ5eLDALpCTI2RAhkTZQqYoTgpoCPECbaBHQ2ETL3PUl98ECAXYijG0OyYAmQoTG7W5ODkAF1CnVgm2JQx4okPA+gCMTbGskBGgRmaOblAh5GTORIrfKFx4VH4EIAxIXIxlg2SBbMvECY3e7oApbDaIgQu5/2HmeEKEINYiwSRi7EQkLFgumZOCuggctKGI4ULZN/vMeSLj0AYMytWEqMLzFg4fYDaoKaC6wvOFR4FkIPQFaILxrJAOsHsc/zlfYDWXE8qF22s8Pz5KHxcgEVALBtjJXBSSEOwFhk1Zgy4hitCT4hVw+gFs8/zwxqIBbUgyK7fcyA0PD9XX4iVxhiC0xdof6STWCsoBmKF7+cVCWFXQYyBMxRpf+STX1b0x45AhN0OMSrOGEirhrY/dfQAdjvS7oy+WCF6r1RIFxXWvlTRg1YVqFWBmxZbD99ig9pt0YPQw9rD1nstVri9V+/Ve3XrS/wfim4P5fIFxLoAAAAASUVORK5CYII=";class zr{constructor(e,t){d(this,"config");d(this,"parent");d(this,"dom");d(this,"canvas",null);d(this,"context",null);d(this,"sceneRenderer",null);d(this,"loadingScreen",null);d(this,"assetManager",null);d(this,"bg",new N);d(this,"bgFullscreen",new N);d(this,"playerControls",null);d(this,"timelineSlider",null);d(this,"playButton",null);d(this,"skinButton",null);d(this,"animationButton",null);d(this,"playTime",0);d(this,"selectedBones",[]);d(this,"cancelId",0);d(this,"popup",null);d(this,"error",!1);d(this,"skeleton",null);d(this,"animationState",null);d(this,"paused",!0);d(this,"speed",1);d(this,"time",new Xs);d(this,"stopRequestAnimationFrame",!1);d(this,"disposed",!1);d(this,"viewport",{});d(this,"currentViewport",{});d(this,"previousViewport",{});d(this,"viewportTransitionStart",0);d(this,"eventListeners",[]);this.config=t;let s=typeof e=="string"?document.getElementById(e):e;if(s==null)throw new Error("SpinePlayer parent not found: "+e);this.parent=s,t.showControls===void 0&&(t.showControls=!0);let i=t.showControls?`
<div class="spine-player-controls spine-player-popup-parent spine-player-controls-hidden">
<div class="spine-player-timeline"></div>
<div class="spine-player-buttons">
<button class="spine-player-button spine-player-button-icon-pause"></button>
<div class="spine-player-button-spacer"></div>
<button class="spine-player-button spine-player-button-icon-speed"></button>
<button class="spine-player-button spine-player-button-icon-animations"></button>
<button class="spine-player-button spine-player-button-icon-skins"></button>
<button class="spine-player-button spine-player-button-icon-settings"></button>
<button class="spine-player-button spine-player-button-icon-fullscreen"></button>
<img class="spine-player-button-icon-spine-logo" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20104%2031.16%22%3E%3Cpath%20d%3D%22M104%2012.68a1.31%201.31%200%200%201-.37%201%201.28%201.28%200%200%201-.85.31H91.57a10.51%2010.51%200%200%200%20.29%202.55%204.92%204.92%200%200%200%201%202%204.27%204.27%200%200%200%201.64%201.26%206.89%206.89%200%200%200%202.6.44%2010.66%2010.66%200%200%200%202.17-.2%2012.81%2012.81%200%200%200%201.64-.44q.69-.25%201.14-.44a1.87%201.87%200%200%201%20.68-.2.44.44%200%200%201%20.27.04.43.43%200%200%201%20.16.2%201.38%201.38%200%200%201%20.09.37%204.89%204.89%200%200%201%200%20.58%204.14%204.14%200%200%201%200%20.43v.32a.83.83%200%200%201-.09.26%201.1%201.1%200%200%201-.17.22%202.77%202.77%200%200%201-.61.34%208.94%208.94%200%200%201-1.32.46%2018.54%2018.54%200%200%201-1.88.41%2013.78%2013.78%200%200%201-2.28.18%2010.55%2010.55%200%200%201-3.68-.59%206.82%206.82%200%200%201-2.66-1.74%207.44%207.44%200%200%201-1.63-2.89%2013.48%2013.48%200%200%201-.55-4%2012.76%2012.76%200%200%201%20.57-3.94%208.35%208.35%200%200%201%201.64-3%207.15%207.15%200%200%201%202.58-1.87%208.47%208.47%200%200%201%203.39-.65%208.19%208.19%200%200%201%203.41.64%206.46%206.46%200%200%201%202.32%201.73%207%207%200%200%201%201.3%202.54%2011.17%2011.17%200%200%201%20.43%203.13zm-3.14-.93a5.69%205.69%200%200%200-1.09-3.86%204.17%204.17%200%200%200-3.42-1.4%204.52%204.52%200%200%200-2%20.44%204.41%204.41%200%200%200-1.47%201.15A5.29%205.29%200%200%200%2092%209.75a7%207%200%200%200-.36%202zM80.68%2021.94a.42.42%200%200%201-.08.26.59.59%200%200%201-.25.18%201.74%201.74%200%200%201-.47.11%206.31%206.31%200%200%201-.76%200%206.5%206.5%200%200%201-.78%200%201.74%201.74%200%200%201-.47-.11.59.59%200%200%201-.25-.18.42.42%200%200%201-.08-.26V12a9.8%209.8%200%200%200-.23-2.35%204.86%204.86%200%200%200-.66-1.53%202.88%202.88%200%200%200-1.13-1%203.57%203.57%200%200%200-1.6-.34%204%204%200%200%200-2.35.83A12.71%2012.71%200%200%200%2069.11%2010v11.9a.42.42%200%200%201-.08.26.59.59%200%200%201-.25.18%201.74%201.74%200%200%201-.47.11%206.51%206.51%200%200%201-.78%200%206.31%206.31%200%200%201-.76%200%201.88%201.88%200%200%201-.48-.11.52.52%200%200%201-.25-.18.46.46%200%200%201-.07-.26v-17a.53.53%200%200%201%20.03-.21.5.5%200%200%201%20.23-.19%201.28%201.28%200%200%201%20.44-.11%208.53%208.53%200%200%201%201.39%200%201.12%201.12%200%200%201%20.43.11.6.6%200%200%201%20.22.19.47.47%200%200%201%20.07.26V7.2a10.46%2010.46%200%200%201%202.87-2.36%206.17%206.17%200%200%201%202.88-.75%206.41%206.41%200%200%201%202.87.58%205.16%205.16%200%200%201%201.88%201.54%206.15%206.15%200%200%201%201%202.26%2013.46%2013.46%200%200%201%20.31%203.11z%22%20fill%3D%22%23fff%22%2F%3E%3Cpath%20d%3D%22M43.35%202.86c.09%202.6%201.89%204%205.48%204.61%203%20.48%205.79.24%206.69-2.37%201.75-5.09-2.4-3.82-6-4.39s-6.31-2.03-6.17%202.15zm1.08%2010.69c.33%201.94%202.14%203.06%204.91%203s4.84-1.16%205.13-3.25c.53-3.88-2.53-2.38-5.3-2.3s-5.4-1.26-4.74%202.55zM48%2022.44c.55%201.45%202.06%202.06%204.1%201.63s3.45-1.11%203.33-2.76c-.21-3.06-2.22-2.1-4.26-1.66S47%2019.6%2048%2022.44zm1.78%206.78c.16%201.22%201.22%202%202.88%201.93s2.92-.67%203.13-2c.4-2.43-1.46-1.53-3.12-1.51s-3.17-.82-2.89%201.58z%22%20fill%3D%22%23ff4000%22%2F%3E%3Cpath%20d%3D%22M35.28%2013.16a15.33%2015.33%200%200%201-.48%204%208.75%208.75%200%200%201-1.42%203%206.35%206.35%200%200%201-2.32%201.91%207.14%207.14%200%200%201-3.16.67%206.1%206.1%200%200%201-1.4-.15%205.34%205.34%200%200%201-1.26-.47%207.29%207.29%200%200%201-1.24-.81q-.61-.49-1.29-1.15v8.51a.47.47%200%200%201-.08.26.56.56%200%200%201-.25.19%201.74%201.74%200%200%201-.47.11%206.47%206.47%200%200%201-.78%200%206.26%206.26%200%200%201-.76%200%201.89%201.89%200%200%201-.48-.11.49.49%200%200%201-.25-.19.51.51%200%200%201-.07-.26V4.91a.57.57%200%200%201%20.06-.27.46.46%200%200%201%20.23-.18%201.47%201.47%200%200%201%20.44-.1%207.41%207.41%200%200%201%201.3%200%201.45%201.45%200%200%201%20.43.1.52.52%200%200%201%20.24.18.51.51%200%200%201%20.07.27V7.2a18.06%2018.06%200%200%201%201.49-1.38%209%209%200%200%201%201.45-1%206.82%206.82%200%200%201%201.49-.59%207.09%207.09%200%200%201%204.78.52%206%206%200%200%201%202.13%202%208.79%208.79%200%200%201%201.2%202.9%2015.72%2015.72%200%200%201%20.4%203.51zm-3.28.36a15.64%2015.64%200%200%200-.2-2.53%207.32%207.32%200%200%200-.69-2.17%204.06%204.06%200%200%200-1.3-1.51%203.49%203.49%200%200%200-2-.57%204.1%204.1%200%200%200-1.2.18%204.92%204.92%200%200%200-1.2.57%208.54%208.54%200%200%200-1.28%201A15.77%2015.77%200%200%200%2022.76%2010v6.77a13.53%2013.53%200%200%200%202.46%202.4%204.12%204.12%200%200%200%202.44.83%203.56%203.56%200%200%200%202-.57A4.28%204.28%200%200%200%2031%2018a7.58%207.58%200%200%200%20.77-2.12%2011.43%2011.43%200%200%200%20.23-2.36zM12%2017.3a5.39%205.39%200%200%201-.48%202.33%204.73%204.73%200%200%201-1.37%201.72%206.19%206.19%200%200%201-2.12%201.06%209.62%209.62%200%200%201-2.71.36%2010.38%2010.38%200%200%201-3.21-.5A7.63%207.63%200%200%201%201%2021.82a3.25%203.25%200%200%201-.66-.43%201.09%201.09%200%200%201-.3-.53%203.59%203.59%200%200%201-.04-.93%204.06%204.06%200%200%201%200-.61%202%202%200%200%201%20.09-.4.42.42%200%200%201%20.16-.22.43.43%200%200%201%20.24-.07%201.35%201.35%200%200%201%20.61.26q.41.26%201%20.56a9.22%209.22%200%200%200%201.41.55%206.25%206.25%200%200%200%201.87.26%205.62%205.62%200%200%200%201.44-.17%203.48%203.48%200%200%200%201.12-.5%202.23%202.23%200%200%200%20.73-.84%202.68%202.68%200%200%200%20.26-1.21%202%202%200%200%200-.37-1.21%203.55%203.55%200%200%200-1-.87%208.09%208.09%200%200%200-1.36-.66l-1.56-.61a16%2016%200%200%201-1.57-.73%206%206%200%200%201-1.37-1%204.52%204.52%200%200%201-1-1.4%204.69%204.69%200%200%201-.37-2%204.88%204.88%200%200%201%20.39-1.87%204.46%204.46%200%200%201%201.16-1.61%205.83%205.83%200%200%201%201.94-1.11A8.06%208.06%200%200%201%206.53%204a8.28%208.28%200%200%201%201.36.11%209.36%209.36%200%200%201%201.23.28%205.92%205.92%200%200%201%20.94.37%204.09%204.09%200%200%201%20.59.35%201%201%200%200%201%20.26.26.83.83%200%200%201%20.09.26%201.32%201.32%200%200%200%20.06.35%203.87%203.87%200%200%201%200%20.51%204.76%204.76%200%200%201%200%20.56%201.39%201.39%200%200%201-.09.39.5.5%200%200%201-.16.22.35.35%200%200%201-.21.07%201%201%200%200%201-.49-.21%207%207%200%200%200-.83-.44%209.26%209.26%200%200%200-1.2-.44%205.49%205.49%200%200%200-1.58-.16%204.93%204.93%200%200%200-1.4.18%202.69%202.69%200%200%200-1%20.51%202.16%202.16%200%200%200-.59.83%202.43%202.43%200%200%200-.2%201%202%202%200%200%200%20.38%201.24%203.6%203.6%200%200%200%201%20.88%208.25%208.25%200%200%200%201.38.68l1.58.62q.8.32%201.59.72a6%206%200%200%201%201.39%201%204.37%204.37%200%200%201%201%201.36%204.46%204.46%200%200%201%20.37%201.8z%22%20fill%3D%22%23fff%22%2F%3E%3C%2Fsvg%3E">
</div></div>`:"";this.parent.appendChild(this.dom=$e(`<div class="spine-player" style="position:relative;height:100%"><canvas class="spine-player-canvas" style="display:block;width:100%;height:100%"></canvas>${i}</div>`));try{this.validateConfig(t)}catch(n){this.showError(n.message,n)}this.initialize(),this.addEventListener(window,"resize",()=>this.drawFrame(!1)),requestAnimationFrame(()=>this.drawFrame())}dispose(){var s,i,n;(s=this.sceneRenderer)==null||s.dispose(),(i=this.loadingScreen)==null||i.dispose(),(n=this.assetManager)==null||n.dispose();for(var e=0;e<this.eventListeners.length;e++){var t=this.eventListeners[e];t.target.removeEventListener(t.event,t.func)}this.parent.removeChild(this.dom),this.disposed=!0}addEventListener(e,t,s){this.eventListeners.push({target:e,event:t,func:s}),e.addEventListener(t,s)}validateConfig(e){if(!e)throw new Error("A configuration object must be passed to to new SpinePlayer().");if(e.skelUrl&&(e.binaryUrl=e.skelUrl),!e.jsonUrl&&!e.binaryUrl)throw new Error("A URL must be specified for the skeleton JSON or binary file.");if(e.scale||(e.scale=1),!e.atlasUrl)throw new Error("A URL must be specified for the atlas file.");if(e.backgroundColor||(e.backgroundColor=e.alpha?"00000000":"000000"),e.fullScreenBackgroundColor||(e.fullScreenBackgroundColor=e.backgroundColor),e.backgroundImage&&!e.backgroundImage.url&&(e.backgroundImage=void 0),e.premultipliedAlpha===void 0&&(e.premultipliedAlpha=!0),e.preserveDrawingBuffer===void 0&&(e.preserveDrawingBuffer=!1),e.mipmaps===void 0&&(e.mipmaps=!0),e.debug||(e.debug={bones:!1,clipping:!1,bounds:!1,hulls:!1,meshes:!1,paths:!1,points:!1,regions:!1}),e.animations&&e.animation&&e.animations.indexOf(e.animation)<0)throw new Error("Animation '"+e.animation+"' is not in the config animation list: "+ts(e.animations));if(e.skins&&e.skin&&e.skins.indexOf(e.skin)<0)throw new Error("Default skin '"+e.skin+"' is not in the config skins list: "+ts(e.skins));e.viewport||(e.viewport={}),e.viewport.animations||(e.viewport.animations={}),e.viewport.debugRender===void 0&&(e.viewport.debugRender=!1),e.viewport.transitionTime===void 0&&(e.viewport.transitionTime=.25),e.controlBones||(e.controlBones=[]),e.showLoading===void 0&&(e.showLoading=!0),e.defaultMix===void 0&&(e.defaultMix=.25)}initialize(){let e=this.config,t=this.dom;if(!e.alpha){let s=e.backgroundColor;this.dom.style.backgroundColor=(s.charAt(0)=="#"?s:"#"+s).substr(0,7)}try{this.canvas=Ze(t,"spine-player-canvas"),this.context=new Te(this.canvas,{alpha:e.alpha,preserveDrawingBuffer:e.preserveDrawingBuffer}),this.sceneRenderer=new Vr(this.canvas,this.context,!0),e.showLoading&&(this.loadingScreen=new Nr(this.sceneRenderer))}catch(s){return this.showError(`Sorry, your browser does not support WebG, or you have disabled WebGL in your browser settings.
Please use the latest version of Firefox, Chrome, Edge, or Safari.`,s),null}if(this.assetManager=new Fr(this.context,"",e.downloader),e.rawDataURIs)for(let s in e.rawDataURIs)this.assetManager.setRawDataURI(s,e.rawDataURIs[s]);if(e.jsonUrl?this.assetManager.loadJson(e.jsonUrl):this.assetManager.loadBinary(e.binaryUrl),this.assetManager.loadTextureAtlas(e.atlasUrl),e.backgroundImage&&this.assetManager.loadTexture(e.backgroundImage.url),this.bg.setFromString(e.backgroundColor),this.bgFullscreen.setFromString(e.fullScreenBackgroundColor),e.showControls){this.playerControls=t.children[1];let s=this.playerControls.children,i=s[0],n=s[1].children;this.playButton=n[0];let o=n[2];this.animationButton=n[3],this.skinButton=n[4];let r=n[5],c=n[6],a=n[7];this.timelineSlider=new Fs,i.appendChild(this.timelineSlider.create()),this.timelineSlider.change=g=>{this.pause();let x=this.animationState.getCurrent(0).animation.duration*g;this.animationState.update(x-this.playTime),this.animationState.apply(this.skeleton),this.skeleton.update(x-this.playTime),this.skeleton.updateWorldTransform(Oe.update),this.playTime=x},this.playButton.onclick=()=>this.paused?this.play():this.pause(),o.onclick=()=>this.showSpeedDialog(o),this.animationButton.onclick=()=>this.showAnimationsDialog(this.animationButton),this.skinButton.onclick=()=>this.showSkinsDialog(this.skinButton),r.onclick=()=>this.showSettingsDialog(r);let l=this.canvas.clientWidth,h=this.canvas.clientHeight,u=this.canvas.style.width,f=this.canvas.style.height,m=!1;c.onclick=()=>{let g=()=>{m=!m,m||(this.canvas.style.width=l+"px",this.canvas.style.height=h+"px",this.drawFrame(!1),requestAnimationFrame(()=>{this.canvas.style.width=u,this.canvas.style.height=f}))},p=t;p.onfullscreenchange=g,p.onwebkitfullscreenchange=g;let x=document;x.fullscreenElement||x.webkitFullscreenElement||x.mozFullScreenElement||x.msFullscreenElement?x.exitFullscreen?x.exitFullscreen():x.mozCancelFullScreen?x.mozCancelFullScreen():x.webkitExitFullscreen?x.webkitExitFullscreen():x.msExitFullscreen&&x.msExitFullscreen():(l=this.canvas.clientWidth,h=this.canvas.clientHeight,u=this.canvas.style.width,f=this.canvas.style.height,p.requestFullscreen?p.requestFullscreen():p.webkitRequestFullScreen?p.webkitRequestFullScreen():p.mozRequestFullScreen?p.mozRequestFullScreen():p.msRequestFullscreen&&p.msRequestFullscreen())},a.onclick=()=>window.open("http://esotericsoftware.com")}return t}loadSkeleton(){if(this.error)return;this.assetManager.hasErrors()&&this.showError(`Error: Assets could not be loaded.
`+ts(this.assetManager.getErrors()));let e=this.config,t=this.assetManager.require(e.atlasUrl),s=this.context.gl,i=s.getExtension("EXT_texture_filter_anisotropic"),n=s.getParameter(s.VERSION).indexOf("WebGL 1.0")!=-1;for(let h of t.pages){let u=h.minFilter;var o=e.mipmaps,r=V.isPowerOfTwo(h.width)&&V.isPowerOfTwo(h.height);n&&!r&&(o=!1),o&&(i?(s.texParameterf(s.TEXTURE_2D,i.TEXTURE_MAX_ANISOTROPY_EXT,8),u=we.MipMapLinearLinear):u=we.Linear,h.texture.setFilters(u,we.Nearest)),u!=we.Nearest&&u!=we.Linear&&h.texture.update(!0)}let c;try{let h,u,f=new zi(t);if(e.jsonUrl){if(u=this.assetManager.remove(e.jsonUrl),!u)throw new Error("Empty JSON data.");if(e.jsonField&&(u=u[e.jsonField],!u))throw new Error("JSON field does not exist: "+e.jsonField);h=new Mr(f)}else u=this.assetManager.remove(e.binaryUrl),h=new Zi(f);h.scale=e.scale,c=h.readSkeletonData(u)}catch(h){this.showError(`Error: Could not load skeleton data.
${h.message}`,h);return}this.skeleton=new rs(c);let a=new Pi(c);a.defaultMix=e.defaultMix,this.animationState=new ss(a),e.controlBones.forEach(h=>{c.findBone(h)||this.showError(`Error: Control bone does not exist in skeleton: ${h}`)}),!e.skin&&c.skins.length&&(e.skin=c.skins[0].name),e.skins&&e.skin.length&&e.skins.forEach(h=>{this.skeleton.data.findSkin(h)||this.showError(`Error: Skin in config list does not exist in skeleton: ${h}`)}),e.skin&&(this.skeleton.data.findSkin(e.skin)||this.showError(`Error: Skin does not exist in skeleton: ${e.skin}`),this.skeleton.setSkinByName(e.skin),this.skeleton.setSlotsToSetupPose()),Object.getOwnPropertyNames(e.viewport.animations).forEach(h=>{c.findAnimation(h)||this.showError(`Error: Animation for which a viewport was specified does not exist in skeleton: ${h}`)}),e.animations&&e.animations.length&&(e.animations.forEach(h=>{this.skeleton.data.findAnimation(h)||this.showError(`Error: Animation in config list does not exist in skeleton: ${h}`)}),e.animation||(e.animation=e.animations[0])),e.animation&&!c.findAnimation(e.animation)&&this.showError(`Error: Animation does not exist in skeleton: ${e.animation}`),this.setupInput(),e.showControls&&((c.skins.length==1||e.skins&&e.skins.length==1)&&this.skinButton.classList.add("spine-player-hidden"),(c.animations.length==1||e.animations&&e.animations.length==1)&&this.animationButton.classList.add("spine-player-hidden")),e.success&&e.success(this);let l=this.animationState.getCurrent(0);l?this.currentViewport||(this.setViewport(l.animation),this.play()):e.animation?(l=this.setAnimation(e.animation),this.play()):(l=this.animationState.setEmptyAnimation(0),l.trackEnd=1e8,this.skeleton.updateWorldTransform(Oe.update),this.setViewport(l.animation),this.pause())}setupInput(){let e=this.config,t=e.controlBones;if(!t.length&&!e.showControls)return;let s=this.selectedBones=new Array(t.length),i=this.canvas,n=null,o=new qe,r=new et,c=new et,a=new qe,l=this.skeleton,h=this.sceneRenderer,u=function(f,m){c.set(f,i.clientHeight-m,0),o.x=o.y=0;let g=24,p=0,x=null;for(let y=0;y<t.length;y++){s[y]=null;let b=l.findBone(t[y]);if(!b)continue;let w=h.camera.worldToScreen(r.set(b.worldX,b.worldY,0),i.clientWidth,i.clientHeight).distance(c);w<g&&(g=w,x=b,p=y,o.x=r.x-c.x,o.y=r.y-c.y)}return x&&(s[p]=x),x};if(new Ci(i).addListener({down:(f,m)=>{n=u(f,m)},up:()=>{n?n=null:e.showControls&&(this.paused?this.play():this.pause())},dragged:(f,m)=>{n&&(f=V.clamp(f+o.x,0,i.clientWidth),m=V.clamp(m-o.y,0,i.clientHeight),h.camera.screenToWorld(r.set(f,m,0),i.clientWidth,i.clientHeight),n.parent?(n.parent.worldToLocal(a.set(r.x-l.x,r.y-l.y)),n.x=a.x,n.y=a.y):(n.x=r.x-l.x,n.y=r.y-l.y))},moved:(f,m)=>u(f,m)}),e.showControls){this.addEventListener(document,"mousemove",x=>{x instanceof MouseEvent&&p(x.clientX,x.clientY)}),this.addEventListener(document,"touchmove",x=>{if(x instanceof TouchEvent){let y=x.changedTouches;if(y.length){let b=y[0];p(b.clientX,b.clientY)}}});let f=(x,y,b)=>{let w=x-b.left,C=y-b.top;return w>=0&&w<=b.width&&C>=0&&C<=b.height},m=!0,g=!1,p=(x,y)=>{let b=Ze(this.dom,"spine-player-popup");m=f(x,y,this.playerControls.getBoundingClientRect()),g=f(x,y,i.getBoundingClientRect()),clearTimeout(this.cancelId),!b&&!m&&!g&&!this.paused?this.playerControls.classList.add("spine-player-controls-hidden"):this.playerControls.classList.remove("spine-player-controls-hidden"),!m&&!b&&!this.paused&&(this.cancelId=setTimeout(()=>{this.paused||this.playerControls.classList.add("spine-player-controls-hidden")},1e3))}}}play(){this.paused=!1;let e=this.config;e.showControls&&(this.cancelId=setTimeout(()=>{this.paused||this.playerControls.classList.add("spine-player-controls-hidden")},1e3),this.playButton.classList.remove("spine-player-button-icon-play"),this.playButton.classList.add("spine-player-button-icon-pause"),e.animation||(e.animations&&e.animations.length?e.animation=e.animations[0]:this.skeleton.data.animations.length&&(e.animation=this.skeleton.data.animations[0].name),e.animation&&this.setAnimation(e.animation)))}pause(){this.paused=!0,this.config.showControls&&(this.playerControls.classList.remove("spine-player-controls-hidden"),clearTimeout(this.cancelId),this.playButton.classList.remove("spine-player-button-icon-pause"),this.playButton.classList.add("spine-player-button-icon-play"))}setAnimation(e,t=!0){return e=this.setViewport(e),this.animationState.setAnimationWith(0,e,t)}addAnimation(e,t=!0,s=0){return e=this.setViewport(e),this.animationState.addAnimationWith(0,e,t,s)}setViewport(e){if(typeof e=="string"){let n=this.skeleton.data.findAnimation(e);if(!n)throw new Error("Animation not found: "+e);e=n}this.previousViewport=this.currentViewport;let t=this.config.viewport,s=this.currentViewport={padLeft:t.padLeft!==void 0?t.padLeft:"10%",padRight:t.padRight!==void 0?t.padRight:"10%",padTop:t.padTop!==void 0?t.padTop:"10%",padBottom:t.padBottom!==void 0?t.padBottom:"10%"};t.x!==void 0&&t.y!==void 0&&t.width&&t.height?(s.x=t.x,s.y=t.y,s.width=t.width,s.height=t.height):this.calculateAnimationViewport(e,s);let i=this.config.viewport.animations[e.name];return i&&(i.x!==void 0&&i.y!==void 0&&i.width&&i.height&&(s.x=i.x,s.y=i.y,s.width=i.width,s.height=i.height),i.padLeft!==void 0&&(s.padLeft=i.padLeft),i.padRight!==void 0&&(s.padRight=i.padRight),i.padTop!==void 0&&(s.padTop=i.padTop),i.padBottom!==void 0&&(s.padBottom=i.padBottom)),s.padLeft=this.percentageToWorldUnit(s.width,s.padLeft),s.padRight=this.percentageToWorldUnit(s.width,s.padRight),s.padBottom=this.percentageToWorldUnit(s.height,s.padBottom),s.padTop=this.percentageToWorldUnit(s.height,s.padTop),this.viewportTransitionStart=performance.now(),e}percentageToWorldUnit(e,t){return typeof t=="string"?e*parseFloat(t.substr(0,t.length-1))/100:t}calculateAnimationViewport(e,t){this.skeleton.setToSetupPose();let s=100,i=e.duration?e.duration/s:0,n=0,o=1e8,r=-1e8,c=1e8,a=-1e8,l=new qe,h=new qe;const u=new Array(2);for(let f=0;f<s;f++,n+=i)e.apply(this.skeleton,n,n,!1,[],1,X.setup,Ee.mixIn),this.skeleton.updateWorldTransform(Oe.update),this.skeleton.getBounds(l,h,u,this.sceneRenderer.skeletonRenderer.getSkeletonClipping()),!isNaN(l.x)&&!isNaN(l.y)&&!isNaN(h.x)&&!isNaN(h.y)?(o=Math.min(l.x,o),r=Math.max(l.x+h.x,r),c=Math.min(l.y,c),a=Math.max(l.y+h.y,a)):this.showError("Animation bounds are invalid: "+e.name);t.x=o,t.y=c,t.width=r-o,t.height=a-c}drawFrame(e=!0){try{if(this.error||this.disposed)return;e&&!this.stopRequestAnimationFrame&&requestAnimationFrame(()=>this.drawFrame());let t=document,i=t.fullscreenElement||t.webkitFullscreenElement||t.mozFullScreenElement||t.msFullscreenElement?this.bgFullscreen:this.bg;this.time.update();let n=this.time.delta,o=this.assetManager.isLoadingComplete();!this.skeleton&&o&&this.loadSkeleton();let r=this.skeleton,c=this.config;if(r){let a=this.sceneRenderer;a.resize(bt.Expand);let l=this.paused?0:n*this.speed;if(c.frame&&c.frame(this,l),!this.paused&&(r.update(l),this.animationState.update(l),this.animationState.apply(r),c.updateWorldTransform?c.updateWorldTransform(this,l):r.updateWorldTransform(Oe.update),c.showControls)){this.playTime+=l;let g=this.animationState.getCurrent(0);if(g){let p=g.animation.duration;for(;this.playTime>=p&&p!=0;)this.playTime-=p;this.playTime=Math.max(0,Math.min(this.playTime,p)),this.timelineSlider.setValue(this.playTime/p)}}let h=this.viewport;if(h.x=this.currentViewport.x-this.currentViewport.padLeft,h.y=this.currentViewport.y-this.currentViewport.padBottom,h.width=this.currentViewport.width+this.currentViewport.padLeft+this.currentViewport.padRight,h.height=this.currentViewport.height+this.currentViewport.padBottom+this.currentViewport.padTop,this.previousViewport){let g=(performance.now()-this.viewportTransitionStart)/1e3/c.viewport.transitionTime;if(g<1){let p=this.previousViewport.x-this.previousViewport.padLeft,x=this.previousViewport.y-this.previousViewport.padBottom,y=this.previousViewport.width+this.previousViewport.padLeft+this.previousViewport.padRight,b=this.previousViewport.height+this.previousViewport.padBottom+this.previousViewport.padTop;h.x=p+(h.x-p)*g,h.y=x+(h.y-x)*g,h.width=y+(h.width-y)*g,h.height=b+(h.height-b)*g}}a.camera.zoom=this.canvas.height/this.canvas.width>h.height/h.width?h.width/this.canvas.width:h.height/this.canvas.height,a.camera.position.x=h.x+h.width/2,a.camera.position.y=h.y+h.height/2;let u=this.context.gl;u.clearColor(i.r,i.g,i.b,i.a),u.clear(u.COLOR_BUFFER_BIT),c.update&&c.update(this,l),a.begin();let f=c.backgroundImage;if(f){let g=this.assetManager.require(f.url);f.x!==void 0&&f.y!==void 0&&f.width&&f.height?a.drawTexture(g,f.x,f.y,f.width,f.height):a.drawTexture(g,h.x,h.y,h.width,h.height)}a.drawSkeleton(r,c.premultipliedAlpha),Number(a.skeletonDebugRenderer.drawBones=c.debug.bones??!1)+Number(a.skeletonDebugRenderer.drawBoundingBoxes=c.debug.bounds??!1)+Number(a.skeletonDebugRenderer.drawClipping=c.debug.clipping??!1)+Number(a.skeletonDebugRenderer.drawMeshHull=c.debug.hulls??!1)+Number(a.skeletonDebugRenderer.drawPaths=c.debug.paths??!1)+Number(a.skeletonDebugRenderer.drawRegionAttachments=c.debug.regions??!1)+Number(a.skeletonDebugRenderer.drawMeshTriangles=c.debug.meshes??!1)>0&&a.drawSkeletonDebug(r,c.premultipliedAlpha);let m=c.controlBones;if(m.length){let g=this.selectedBones;u.lineWidth(2);for(let p=0;p<m.length;p++){let x=r.findBone(m[p]);if(!x)continue;let y=g[p]?qr:Hr,b=g[p]?Gr:jr;a.circle(!0,r.x+x.worldX,r.y+x.worldY,20,y),a.circle(!1,r.x+x.worldX,r.y+x.worldY,20,b)}}c.viewport.debugRender&&(u.lineWidth(1),a.rect(!1,this.currentViewport.x,this.currentViewport.y,this.currentViewport.width,this.currentViewport.height,N.GREEN),a.rect(!1,h.x,h.y,h.width,h.height,N.RED)),a.end(),c.draw&&c.draw(this,l)}c.showLoading&&(this.loadingScreen.backgroundColor.setFromColor(i),this.loadingScreen.draw(o)),o&&c.loading&&c.loading(this,n)}catch(t){this.showError(`Error: Unable to render skeleton.
${t.message}`,t)}}startRendering(){this.stopRequestAnimationFrame=!1,requestAnimationFrame(()=>this.drawFrame())}stopRendering(){this.stopRequestAnimationFrame=!0}hidePopup(e){return this.popup!=null&&this.popup.hide(e)}showSpeedDialog(e){let t="speed";if(this.hidePopup(t))return;let s=new Yt(t,e,this,this.playerControls,`
<div class="spine-player-popup-title">Speed</div>
<hr>
<div class="spine-player-row" style="align-items:center;padding:8px">
<div class="spine-player-column">
	<div class="spine-player-speed-slider" style="margin-bottom:4px"></div>
	<div class="spine-player-row" style="justify-content:space-between"><div>0.1x</div><div>1x</div><div>2x</div></div>
</div>
</div>`),i=new Fs(2,.1,!0);Ze(s.dom,"spine-player-speed-slider").appendChild(i.create()),i.setValue(this.speed/2),i.change=n=>this.speed=n*2,s.show()}showAnimationsDialog(e){let t="animations";if(this.hidePopup(t)||!this.skeleton||!this.skeleton.data.animations.length)return;let s=new Yt(t,e,this,this.playerControls,'<div class="spine-player-popup-title">Animations</div><hr><ul class="spine-player-list"></ul>'),i=Ze(s.dom,"spine-player-list");this.skeleton.data.animations.forEach(n=>{if(this.config.animations&&this.config.animations.indexOf(n.name)<0)return;let o=$e('<li class="spine-player-list-item selectable"><div class="selectable-circle"></div><div class="selectable-text"></div></li>');n.name==this.config.animation&&o.classList.add("selected"),Ze(o,"selectable-text").innerText=n.name,i.appendChild(o),o.onclick=()=>{Ys(i.children,"selected"),o.classList.add("selected"),this.config.animation=n.name,this.playTime=0,this.setAnimation(n.name),this.play()}}),s.show()}showSkinsDialog(e){let t="skins";if(this.hidePopup(t)||!this.skeleton||!this.skeleton.data.animations.length)return;let s=new Yt(t,e,this,this.playerControls,'<div class="spine-player-popup-title">Skins</div><hr><ul class="spine-player-list"></ul>'),i=Ze(s.dom,"spine-player-list");this.skeleton.data.skins.forEach(n=>{if(this.config.skins&&this.config.skins.indexOf(n.name)<0)return;let o=$e('<li class="spine-player-list-item selectable"><div class="selectable-circle"></div><div class="selectable-text"></div></li>');n.name==this.config.skin&&o.classList.add("selected"),Ze(o,"selectable-text").innerText=n.name,i.appendChild(o),o.onclick=()=>{Ys(i.children,"selected"),o.classList.add("selected"),this.config.skin=n.name,this.skeleton.setSkinByName(this.config.skin),this.skeleton.setSlotsToSetupPose()}}),s.show()}showSettingsDialog(e){let t="settings";if(this.hidePopup(t)||!this.skeleton||!this.skeleton.data.animations.length)return;let s=new Yt(t,e,this,this.playerControls,'<div class="spine-player-popup-title">Debug</div><hr><ul class="spine-player-list"></li>'),i=Ze(s.dom,"spine-player-list"),n=(o,r)=>{let c=$e('<li class="spine-player-list-item"></li>'),a=new Wr(o);c.appendChild(a.create());let l=this.config.debug;a.setEnabled(l[r]),a.change=h=>l[r]=h,i.appendChild(c)};n("Bones","bones"),n("Regions","regions"),n("Meshes","meshes"),n("Bounds","bounds"),n("Paths","paths"),n("Clipping","clipping"),n("Points","points"),n("Hulls","hulls"),s.show()}showError(e,t){if(this.error){if(t)throw t}else throw this.error=!0,this.dom.appendChild($e('<div class="spine-player-error" style="background:#000;color:#fff;position:absolute;top:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;overflow:auto;z-index:999">'+e.replace(`
`,"<br><br>")+"</div>")),this.config.error&&this.config.error(this,e),t||new Error(e)}}class Yt{constructor(e,t,s,i,n){d(this,"id");d(this,"button");d(this,"player");d(this,"dom");d(this,"className");d(this,"windowClickListener");this.id=e,this.button=t,this.player=s,this.dom=$e('<div class="spine-player-popup spine-player-hidden"></div>'),this.dom.innerHTML=n,i.appendChild(this.dom),this.className="spine-player-button-icon-"+e+"-selected"}dispose(){}hide(e){return this.dom.remove(),this.button.classList.remove(this.className),this.id==e?(this.player.popup=null,!0):!1}show(){this.player.popup=this,this.button.classList.add(this.className),this.dom.classList.remove("spine-player-hidden");let e=!1,t=()=>{e||requestAnimationFrame(t);let n=this.player.dom,o=Math.abs(n.getBoundingClientRect().bottom-n.getBoundingClientRect().bottom),r=Math.abs(n.getBoundingClientRect().right-n.getBoundingClientRect().right);this.dom.style.maxHeight=n.clientHeight-o-r+"px"};requestAnimationFrame(t);let s=!0,i=n=>{if(s||this.player.popup!=this){s=!1;return}this.dom.contains(n.target)||(this.dom.remove(),window.removeEventListener("click",i),this.button.classList.remove(this.className),this.player.popup=null,e=!0)};this.player.addEventListener(window,"click",i)}}class Wr{constructor(e){d(this,"text");d(this,"switch",null);d(this,"enabled",!1);d(this,"change",()=>{});this.text=e}create(){return this.switch=$e(`
<div class="spine-player-switch">
	<span class="spine-player-switch-text">${this.text}</span>
	<div class="spine-player-switch-knob-area">
		<div class="spine-player-switch-knob"></div>
	</div>
</div>`),this.switch.addEventListener("click",()=>{this.setEnabled(!this.enabled),this.change&&this.change(this.enabled)}),this.switch}setEnabled(e){var t,s;e?(t=this.switch)==null||t.classList.add("active"):(s=this.switch)==null||s.classList.remove("active"),this.enabled=e}isEnabled(){return this.enabled}}class Fs{constructor(e=0,t=.1,s=!1){d(this,"snaps");d(this,"snapPercentage");d(this,"big");d(this,"slider",null);d(this,"value",null);d(this,"knob",null);d(this,"change",()=>{});this.snaps=e,this.snapPercentage=t,this.big=s}create(){this.slider=$e(`
<div class="spine-player-slider ${this.big?"big":""}">
	<div class="spine-player-slider-value"></div>
	<!--<div class="spine-player-slider-knob"></div>-->
</div>`),this.value=Ze(this.slider,"spine-player-slider-value"),this.setValue(0);let e=!1;return new Ci(this.slider).addListener({down:(t,s)=>{var i;e=!0,(i=this.value)==null||i.classList.add("hovering")},up:(t,s)=>{var i;e=!1,this.change&&this.change(this.setValue(t/this.slider.clientWidth)),(i=this.value)==null||i.classList.remove("hovering")},moved:(t,s)=>{e&&this.change&&this.change(this.setValue(t/this.slider.clientWidth))},dragged:(t,s)=>{this.change&&this.change(this.setValue(t/this.slider.clientWidth))}}),this.slider}setValue(e){if(e=Math.max(0,Math.min(1,e)),this.snaps){let t=1/this.snaps,s=e%t;s<t*this.snapPercentage?e=e-s:s>t-t*this.snapPercentage&&(e=e-s+t),e=Math.max(0,Math.min(1,e))}return this.value.style.width=""+e*100+"%",e}}function Ze(S,e){return S.getElementsByClassName(e)[0]}function $e(S){let e=document.createElement("div");return e.innerHTML=S,e.children[0]}function Ys(S,e){for(let t=0;t<S.length;t++)S[t].classList.remove(e)}function ts(S){return JSON.stringify(S).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&#34;").replace(/'/g,"&#39;")}const qr=new N(.478,0,0,.25),Gr=new N(1,1,1,1),Hr=new N(.478,0,0,.5),jr=new N(1,0,0,.8),Zr=ki({__name:"arona_workpage",setup(S){const e={arona_workpage_3:{skelUrl:"/arona_workpage_nighttime/arona_workpage_nighttime.skel",atlasUrl:"/arona_workpage_nighttime/arona_workpage_nighttime.atlas"}},t=Ei(null),s={...e.arona_workpage_3,animation:"Idle_02",premultipliedAlpha:!1,preserveDrawingBuffer:!0,alpha:!0,viewport:{x:-1500,y:0,width:2900,height:1900},success(i){var n;i.speed=.8,i.setAnimation("Idle_01",!0),(n=i.animationState)==null||n.addAnimation(1,"Idle_11",!0,0),i.play()}};return Ti(()=>{t.value&&new zr(t.value,s)}),(i,n)=>(Ri(),Mi("div",{ref_key:"playerContainer",ref:t,class:"player-container"},null,512))}}),$r=Fi(Zr,[["__scopeId","data-v-193668c2"]]);export{$r as default};
